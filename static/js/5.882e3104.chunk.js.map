{"version":3,"sources":["src/components/Themed.tsx","src/constants/Colors.ts","src/hooks/useModalsContext.tsx","src/hooks/useResizeContext.tsx","src/components/CommonButton.tsx","src/lib/react-native-paper/Avatar.tsx","src/components/Avatar.tsx","src/components/CommonSection.tsx","src/components/ModalSection.tsx","src/hooks/lists/useMessengerChannelList.ts","src/hooks/useWebsocketContext.tsx","src/components/TextButton.tsx","src/navigation/index.tsx","src/hooks/lists/useMessengerMemberList.ts","src/modals/ChannelEditModal.tsx","src/components/HeaderRight.tsx","src/hooks/lists/useUserMembershipList.ts","src/components/TabView.tsx","src/components/CommonItem.tsx","src/hooks/lists/useMessengerContentList.ts","src/modals/GuestLogoutModal.tsx","src/components/CommonTextInput.tsx","src/components/MemberItem.tsx","src/modals/DateTimePickerModal.tsx","src/modals/MessageModal.tsx","src/modals/ProfileModal.tsx","src/components/Profile.tsx","src/hooks/useFirebaseContext.tsx","src/components/ContractFooter.tsx","src/screens/main/LoginScreen.tsx","src/components/LinkPreview.tsx","src/lib/react-native-webrtc/useWebsocketContext.tsx","src/lib/react-native-webrtc/webrtc/p2p.tsx","src/lib/react-native-webrtc/webrtc/index.ts","src/lib/react-native-webrtc/LocalCam.tsx","src/lib/react-native-webrtc/RemoteCam.tsx","src/screens/main/ChatScreen/VideoCallSection.tsx","src/components/FilePreview.tsx","src/screens/main/ChatScreen/TimerTags.tsx","src/hooks/lists/useTimerMessageContent.ts","src/screens/main/ChatScreen/index.tsx","src/screens/main/HomeScreen/ConfigSections.tsx","src/screens/main/HomeScreen/index.tsx","src/screens/main/InviteeScreen.tsx","src/screens/index.ts","src/hooks/useLocalSearch.ts","src/modals/InviteModal.tsx","src/hooks/lists/useExternalMembershipList.ts","src/components/RowField.tsx","src/components/TextField.tsx","src/navigation/LinkingConfiguration.ts","web/firebase-config.js","src/screens/NotFoundScreen.tsx","src/navigation/DrawerNavigator.tsx","src/modals/index.ts","src/navigation/RootNavigator.tsx"],"names":["useThemeColor","props","colorName","theme","useColorScheme","colorFromProps","Colors","Text","style","lightColor","darkColor","otherProps","_objectWithoutProperties","_excluded","color","light","dark","React","DefaultText","_extends","View","_excluded2","backgroundColor","DefaultView","text","background","tint","tabIconDefault","tabIconSelected","header","buttonColor","buttonBackgroundColor","buttonBorderColor","iconColor","borderColor","focus","ModalsContext","createContext","setModal","ModalsProvider","_ref","children","allModals","modals","_useState","useState","_useState2","_slicedToArray","setModals","windowType","useResizeContext","_useState3","_useState4","animationType","setAnimationType","useEffect","filter","v","visible","length","map","Component","createElement","Provider","value","newModals","m","_objectSpread","modal","index","Modal","key","transparent","useContext","getWindowType","window","height","width","ResizeContextContext","Dimensions","get","ResizeContextProvider","detectMobile","useMobileDetect","_useWindowDimensions","useWindowDimensions","setWindowType","isMobile","DefaultButton","hover","setHover","Pressable","onPress","onHoverIn","onHoverOut","disabled","paddingVertical","paddingHorizontal","selectable","fontSize","textStyle","title","_props","styles","StyleSheet","create","borderRadius","borderWidth","textAlign","fontWeight","normalizeHash","hash","min","max","Math","floor","str","initHash","i","charCodeAt","abs","stringToHSL","name","userId","Avatar","size","label","split","join","toUpperCase","avatarFromChannel","item","user","avatar","member_count","id","subowner","owner","CommonSection","outerContainer","outerContainerStyle","container","containerStyle","withSeparator","separator","undefined","titleView","titleStyle","subtitle","bodyView","bodyStyle","maxWidth","alignItems","marginHorizontal","marginVertical","flexDirection","marginBottom","flex","marginTop","padding","justifyContent","alignSelf","flexShrink","margin","BottomSheet","useMessengerChannelList","auth","queryClient","useQueryClient","lastJsonMessage","useWebsocketContext","data","useQuery","_auth$user","_regeneratorRuntime","async","_context","prev","next","awrap","getMessengerChannelList","t0","sent","abrupt","stop","Promise","setQueryData","_data","find","concat","_toConsumableArray","sort","a","b","_data2$message_set$","channel","last_message","content","message_set","created","useMessengerChannelSorted","channelList","_a$last_message","_b$last_message","useMessengerChannelMutation","useMutation","postChannel","onSuccess","invalidateQueries","update","putChannel","direct","postDirectChannel","mutateAsync","defaultContext","sendJsonMessage","WebSocketContext","WebSocketInternalProvider","path","Context","useBackground","token","setToken","AppState","currentState","isActive","setIsActive","_useWebSocket","useWebSocket","websockerURL","shouldReconnect","closeEvent","protocols","onOpen","e","console","log","onClose","AsyncStorage","getItem","then","onChange","nextState","addEventListener","removeEventListener","WebSocketProvider","_ref2","disable","Fragment","CommonButton","navigationRef","navigate","params","_navigationRef$curren","_navigationRef$curren2","current","Navigation","defaultColorScheme","useDefaultColorScheme","userColorScheme","colorScheme","NavigationContainer","ref","documentTitle","formatter","options","route","linking","process","versions","LinkingConfiguration","DarkTheme","DefaultTheme","RootNavigator","l","search","decoded","slice","s","replace","history","replaceState","pathname","location","ignoreWarnings","_console","_","clone","warn","message","Object","forEach","indexOf","useMessengerMemberList","channel_id","getMessengerMemberList","useMessengerMemberMutation","invite","postBulkMessengerMember","leave","deleteMessengerMember","ChannelEditModal","member_id","type","lang","useLangContext","useAuthContext","useModalsContext","channelMutation","messengerMemberMutation","setName","description","setDescription","back","_name","ModalSection","TextField","setValue","multiline","groupId","_auth$user2","newChannel","group","screen","field","_useAuthContext","dispatch","defaultButtonProps","username","endsWith","GuestLogoutModal","buttonProps","extra","k","TextButton","useUserMembershipList","getUserMembershipList","_React$useState","_React$useState2","setIndex","entries","tabs","onTab","icons","assign","apply","_defineProperty","icon","TabView","renderTabBar","TabBar","indicatorStyle","activeColor","inactiveColor","renderIcon","scene","onTabPress","findIndex","_ref4","_ref5","navigationState","routes","_ref6","_ref7","onIndexChange","renderScene","SceneMap","_ref8","_ref9","component","tabBarPosition","CommonItem","_React$useState3","_React$useState4","press","setPress","onPressIn","onPressOut","minHeight","borderBottomWidth","useMessengerContentList","_useInfiniteQuery","useInfiniteQuery","pageParam","getMessengerContentList","select","pages","getNextPageParam","lastPage","refetchOnReconnect","refetchOnWindowFocus","fetchNextPage","pageParams","page","len","newCurrent","useMessengerContentMutation","postMessage","_delete","deleteMessengerContent","d","variables","mutate","delete","contentHeight","setContentHeight","TextInput","editable","onChangeText","onContentSizeChange","nativeEvent","contentSize","onBlur","onEndEditing","member","marginRight","dayTypes","hours","Array","keys","toString","padStart","minutes","getDisableDays","date","startDate","startOf","add","endDate","endOf","today","dayjs","result","push","format","DateTimePickerModal","datetime","callback","_dayjs","restMinute","parseInt","defaultDayjs","_useLangContext","locale","setDate","dayType","setDayType","_useState5","_useState6","hour","setHour","_useState7","_useState8","minute","setMinute","_useState9","_useState10","disableDays","setDisableDays","Calendar","lazy","CommonPicker","TouchableOpacity","Ionicons","Suspense","fallback","disableAllTouchEventsForDisabledDays","onMonthChange","dateString","markedDates","reduce","p","c","selected","values","toISOString","MessageModal","contentMutation","Clipboard","setString","ProfileModal","userList","isSelf","Profile","_auth$user3","patchUser","finally","CommonTextInput","firebaseConfig","require","messagingSenderId","apiKeyEncrypted","FCM_API_KEY","app","firebase","initializeApp","apiKey","messaging","onMessage","payload","Notification","permission","JSON","parse","channel_name","body","alert","noti","requestToken","serviceWorkerRegistration","currentToken","_context2","requestPermission","navigator","serviceWorker","register","scope","getToken","vapidKey","FCM_PUBLIC_VAPID_KEY","catch","event","preventDefault","unregister","notiListener","enable","setEnable","_context4","getNotification","postNotification","_context3","putNotification","_noti","_noti2","_enable","_noti3","_context5","changeEnable","openURL","Platform","OS","url","href","Linking","Styles","footer_buttons","footer_button","AntDesign","paddingBottom","paddingRight","login_container","login_header","paddingTop","login_header_logo","resizeMode","login_header_text","login_header_text_bold","login_wrapper","borderTopRightRadius","borderTopLeftRadius","form","form_error","form_error_text","textAlignVertical","form_input","button","button_label","login_social","login_social_separator","login_social_separator_line","login_social_separator_text","login_social_buttons","login_social_button","login_social_icon","login_social_facebook","login_footer_text","guest_footer_text","login_footer_link","link","image","Image","source","uri","maxHeight","TURN_SERVER","peerConstraints","iceServers","urls","sessionConstraints","mandatory","OfferToReceiveAudio","OfferToReceiveVideo","VoiceActivityDetection","mediaConstraints","audio","video","framerate","onICEcandidate","pc","_message","rtcMessage","candidate","RTCIceCandidate","addIceCandidate","sendICEcandidate","sendMessage","receiver","target","optimizeSdp","offerDescription","arr","sdp","test","RTCSessionDescription","createOffer","pcRefCurrent","stream","addStream","t1","setLocalDescription","camStyle","cam","bottonContainer","position","bottom","buttonBar","_props$user","_useWebsocketContext","_useLocalCam","pcRef","useRef","sender","setSender","_stream","setStream","isPlay","useMemo","CustomRTCView","useCallback","memo","RTCView","videoProps","start","mode","newStream","mediaDevices","getUserMedia","getDisplayMedia","_ref3","error","getTracks","track","websocketOnMessage","response","peerConnection","_peerConnection","answerDescription","_peerConnection2","RTCPeerConnection","setRemoteDescription","useLocalCam","Button","setReceiver","_useRemoteCam","setUser","close","clearInterval","statsInterval","_pcRef$current","_pcRef$current2","_pcRef$current3","_pcRef$current4","streams","_peerConnection3","_answerDescription","_streams","iceConnectionState","activeStream","setInterval","stats","statsOutput","framePerSecond","getStats","report","kind","statName","framesPerSecond","Date","toTimeString","addTransceiver","direction","getRemoteStreams","createAnswer","localDescription","useRemoteCam","VideoView","scale","flexGrow","focusGuest","setFocusGuest","VideoCallContainer","setDisable","useIsMobile","videoMode","setVideoMode","guests","setGuests","_useRtcContext","useRtcContext","ceil","sqrt","toggleVideoMode","ThemedView","aspectRatio","borderLeftWidth","flexWrap","RemoteCam","LocalCam","RtcProvider","file","showBorder","FontAwesome","filename","pow","toFixed","humanFileSize","filesize","_timerFormat","now","year","month","day","timerToString","timer","TimerTag","end","ratio","diff","setExpand","isExpand","overflow","Hyperlink","linkDefault","wordBreak","linkStyle","timerMessages","getTimerMessageContentList","sorted","_sorted$","ms","Number","MAX_VALUE","timeout","setTimeout","clearTimeout","useTimerMessageContentList","setNow","expand","MessengerContentPageItem","_nextPage2","nextPage","_nextPage","nextContent","index2","isSystem","isFirst","ownerId","dayChanged","marginLeft","onLongPress","file_set","fileIndex","FilePreview","link_set","linkIndex","LinkPreview","ConfigSection","setLocale","configTheme","useConfigColorScheme","_useFirebaseContext","useFirebaseContext","setNoti","n","textDecorationLine","setColorScheme","MemberTabView","memberItem","MemberItem","ScrollView","MessengerTabView","_item$last_message","_item$last_message2","_item$last_message3","_avatarFromChannel","opacity","paddingLeft","unread_count","ConfigTabView","ConfigSections","getBottomTabs","OneTab","MaterialCommunityIcons","TwoTab","FourTab","SimpleLineIcons","InviteeScreen","_route$params","navigation","enterGuest","setEnterGuest","useLayoutEffect","setOptions","headerRight","user_ids","main","HomeScreen","_route$params2","home","setHome","HeaderRight","tab","StyledText","ContractFooter","setParams","ChatScreen","_useMessengerChannelL","inputRef","channelAvatar","_useMessengerContentL","memberList","_memberList$find","setTimer","autoFocus","setAutoFocus","bottomTab","setBottomTab","postValue","InviteModal","renderItem","canGoBack","goBack","_auth$user4","minWidth","VideoCallSection","FlatList","contentContainerStyle","onScroll","contentOffset","y","onLayout","layout","TimerTags","borderBottomRightRadius","top","Entypo","onSubmitEditing","blurOnSubmit","onFocus","borderBottomLeftRadius","resolve","reject","input","document","onchange","files","onabort","onerror","click","f","_auth$user5","login","LoginScreen","setUsername","password","setPassword","_login","placeholder","autoCapitalize","keyboardType","secureTextEntry","localSearchReducer","initialState","action","keyword","active","Error","InviteItem","selectedRef","has","setSelected","GroupTabView","_useLocalSearch","compare","_useReducer","useReducer","_useReducer2","searchState","useLocalSearch","memberSet","Set","includes","dispatchKeyword","ExternalMembershipTabView","setKeyword","copied","setCopied","timeoutRef","externalMemberList","getExternalMembershipList","useExternalMembershipList","inviteLink","drawerTabs","external","RowField","rowStyle","ROOTPATH","prefixes","config","screens","Main","NotFound","module","exports","NotFoundScreen","linkText","DrawerTabView","MessengerTab","colors","useTheme","onAddList","tabBar","card","borderTopColor","border","pointerEvents","accessibilityRole","borderTopWidth","drawerTab","Tab","elevation","borderRightWidth","Root","createStackNavigator","Navigator","headerMode","screenOptions","cardStyle","animationEnabled","cardStyleInterpolator","CardStyleInterpolators","forVerticalIOS","Screen","MainNavigator","headerShown","gestureDirection","modalValues","DrawerNavigator","headerStyle","headerTitleStyle","headerLeft","canGOBackScreen","headerLeftContainerStyle","forHorizontalIOS"],"mappings":"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","file":"static/js/5.882e3104.chunk.js","sourcesContent":["/**\r\n * Learn more about Light and Dark modes:\r\n * https://docs.expo.io/guides/color-schemes/\r\n */\r\n\r\nimport * as React from 'react';\r\nimport { Text as DefaultText, View as DefaultView } from 'react-native';\r\n\r\nimport Colors from '../constants/Colors'\r\nimport useColorScheme from '../hooks/useColorScheme';\r\n\r\nexport function useThemeColor(\r\n  props: { light?: string; dark?: string },\r\n  colorName: keyof typeof Colors.light & keyof typeof Colors.dark\r\n) {\r\n  const theme = useColorScheme();\r\n  const colorFromProps = props[theme];\r\n\r\n  if (colorFromProps) {\r\n    return colorFromProps;\r\n  } else {\r\n    return Colors[theme][colorName];\r\n  }\r\n}\r\n\r\ntype ThemeProps = {\r\n  lightColor?: string;\r\n  darkColor?: string;\r\n};\r\n\r\nexport type TextProps = ThemeProps & DefaultText['props'];\r\nexport type ViewProps = ThemeProps & DefaultView['props'];\r\n\r\nexport function Text(props: TextProps) {\r\n  const { style, lightColor, darkColor, ...otherProps } = props;\r\n  const color = useThemeColor({ light: lightColor, dark: darkColor }, 'text');\r\n\r\n  return <DefaultText style={[{ color }, style]} {...otherProps} />;\r\n}\r\n\r\nexport function View(props: ViewProps) {\r\n  const { style, lightColor, darkColor, ...otherProps } = props;\r\n  const backgroundColor = useThemeColor({ light: lightColor, dark: darkColor }, 'background');\r\n\r\n  return <DefaultView style={[{ backgroundColor }, style]} {...otherProps} />;\r\n}\r\n","const tintColorLight = '#2f95dc';\r\nconst tintColorDark = '#fff';\r\n\r\nexport default {\r\n  light: {\r\n    text: '#000',\r\n    background: '#fff',\r\n    tint: tintColorLight,\r\n    tabIconDefault: '#ccc',\r\n    tabIconSelected: tintColorLight,\r\n    header:'#24292f',\r\n    buttonColor:'rgb(242,242,242)',\r\n    buttonBackgroundColor: '#f6f8fa', //'rgba(9,30,66,0.08)',//rgb(242,242,242)\\\r\n    buttonBorderColor:'rgba(27,31,36,0.15)',\r\n    iconColor: 'black'\r\n  },\r\n  dark: {\r\n    text: '#fff',\r\n    background: '#000',\r\n    tint: tintColorDark,\r\n    tabIconDefault: '#ccc',\r\n    tabIconSelected: tintColorDark,\r\n    header:'#161b22',\r\n    buttonColor:'rgb(1,4,9)',\r\n    buttonBackgroundColor: '#282624',\r\n    buttonBorderColor:'rgba(229,225,220,0.15)',\r\n    iconColor: 'white'\r\n  },\r\n  borderColor:'#d0d7de',\r\n  \r\n  focus:'#0065A4',\r\n};\r\n","import React, { useState, createContext, useContext, useEffect } from \"react\";\r\nimport { Modal } from \"react-native\";\r\nimport useResizeContext from \"./useResizeContext\";\r\n\r\ntype ModalProps = any\r\n\r\ntype ModalState = {\r\n  Component:React.ComponentType<ModalProps>,\r\n  props:any\r\n  visible:boolean\r\n}\r\ntype SetModal = (Component:ModalState[\"Component\"]|null, props:ModalProps|null)=>void\r\n\r\nconst ModalsContext = createContext<{setModal: SetModal}>({\r\n    setModal: () => {}\r\n});\r\n\r\nexport const ModalsProvider = ({children, modals:allModals}:{children:React.ReactNode, modals:React.ComponentType<ModalProps>[]}) => {\r\n    const [modals, setModals] = useState<ModalState[]>([]);\r\n    const windowType = useResizeContext();\r\n    const [animationType, setAnimationType] = useState('none')\r\n    const setModal:SetModal = (Component, props) => {\r\n        const newModals = modals.map(m=>{\r\n            if(Component==null){\r\n                return {\r\n                    ...m,\r\n                    visible:false\r\n                }\r\n            }\r\n            else if(m.Component == Component){\r\n                return {\r\n                    Component, \r\n                    props:props!==null?props:m.props,\r\n                    visible:props!==null\r\n                }\r\n            }\r\n            return m        \r\n        })\r\n        setModals(newModals);\r\n    }\r\n    useEffect(()=>{\r\n        if (modals.filter(v=>v.visible).length == 0)\r\n            setAnimationType(windowType == 'landscape'?'fade':'slide')\r\n    }, [windowType])\r\n    useEffect(()=>{\r\n        setModals(allModals.map((Component)=>({Component, props:null, visible:false})))\r\n    }, [allModals])\r\n    return <ModalsContext.Provider value={{setModal}}>\r\n        {children}\r\n        {modals.map((modal, index)=>{\r\n            const { Component, props, visible } = modal;\r\n            return <Modal key={index} animationType={animationType as any} visible={visible} transparent>\r\n                <Component {...props}/>\r\n            </Modal>\r\n        })}\r\n    </ModalsContext.Provider>\r\n}\r\n\r\nexport default ()=>{\r\n    const modalsContext = useContext(ModalsContext)\r\n    return modalsContext\r\n}\r\n\r\n","import React, { useState, useEffect, createContext, useContext, useMemo } from 'react';\r\nimport { Dimensions, ScaledSize, useWindowDimensions } from 'react-native';\r\n//@ts-ignore\r\nimport useMobileDetect from 'use-mobile-detect-hook';\r\n\r\ntype WindowType = 'portrait' | 'landscape'\r\n\r\nconst getWindowType = (window:{width:number, height:number})=> window.height >= window.width?'portrait':'landscape' as WindowType;\r\n\r\nconst ResizeContextContext = createContext<WindowType>(getWindowType(Dimensions.get('window')));\r\n\r\nexport const ResizeContextProvider = ({children}:{children:React.ReactNode})=>{\r\n  const detectMobile = useMobileDetect();\r\n  const {width, height} = useWindowDimensions()\r\n  const [windowType, setWindowType] = useState(getWindowType({width, height}))\r\n  useEffect(()=>{\r\n    setWindowType(getWindowType({width, height}))\r\n  }, [width, height])\r\n  return <ResizeContextContext.Provider value={detectMobile.isMobile()?'portrait':windowType}>\r\n    {children}\r\n  </ResizeContextContext.Provider>\r\n}\r\n\r\nexport default function useResizeContext() {\r\n  const windowType = useContext(ResizeContextContext)\r\n  return windowType\r\n}","import React, { useState } from 'react';\r\nimport { Text, StyleSheet, Pressable, StyleProp, ViewStyle} from 'react-native';\r\nimport Colors from '../constants/Colors';\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport { CustomButtonProps } from '../types';\r\n\r\nconst DefaultButton = (props:CustomButtonProps)=>{\r\n    const [hover, setHover] = useState(false)\r\n    return <Pressable\r\n        onPress={()=>props.onPress()}\r\n        //@ts-ignore\r\n        onHoverIn={()=>setHover(true)}\r\n        onHoverOut={()=>setHover(false)}\r\n        disabled={props.disabled}\r\n        style={[\r\n            {\r\n                paddingVertical:5, \r\n                paddingHorizontal:16\r\n            },\r\n            props.style,\r\n            (hover || props.disabled)?{backgroundColor:props.color}:{}\r\n        ]}>\r\n            {props.children?props.children:\r\n            <Text selectable={false} style={[{fontSize:14}, props.textStyle]}>{props.title}</Text>}\r\n        </Pressable>\r\n}\r\n\r\nexport default (props:CustomButtonProps)=>{\r\n    const theme = useColorScheme()\r\n    const _props = {\r\n        color:Colors[theme].buttonColor,\r\n        ...props,\r\n        style:[\r\n            styles.style,\r\n            {\r\n                backgroundColor:Colors[theme].buttonBackgroundColor,\r\n                borderColor:Colors[theme].buttonBorderColor\r\n            },\r\n            props.style,\r\n        ] as StyleProp<ViewStyle>,\r\n        textStyle:[\r\n            styles.text, \r\n            {color:Colors[theme].text},\r\n            props.textStyle\r\n        ]\r\n    }\r\n    return <DefaultButton {..._props}/>\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n    style:{\r\n        borderRadius:6, \r\n        borderWidth:1, \r\n    },\r\n    text:{\r\n        textAlign:'center', \r\n        fontWeight:'600'\r\n    }\r\n});\r\n","import * as React from 'react';\r\nimport { Avatar } from 'react-native-paper';\r\nimport { AvatarProps } from '../../types';\r\n\r\nconst normalizeHash = (hash: number, min: number, max: number) => {\r\n    return Math.floor((hash % (max - min)) + min);\r\n};\r\n\r\nconst stringToHSL = (str: string, initHash?:number) => {\r\n    let hash = initHash || 0;\r\n    for (let i = 0; i < str.length; i++) {\r\n      hash = str.charCodeAt(i) + ((hash << 5) - hash);\r\n    }\r\n    hash = Math.abs(hash);\r\n    return `hsl(${normalizeHash(hash, 0, 360)}, ${normalizeHash(hash, 0, 100)}%, ${normalizeHash(hash, 25, 75)}%)`;\r\n};\r\n\r\nexport default (props:AvatarProps) => {\r\n    const backgroundColor = stringToHSL(props.name, props.userId)\r\n    return <Avatar.Text style={{backgroundColor}} size={props.size} label={props.name.split(' ').map(v=>v[0]).join().toUpperCase()} />\r\n};","import React from 'react';\r\n// import { MaterialIcons } from \"@expo/vector-icons\"\r\nimport Avatar from '../lib/react-native-paper/Avatar';\r\nimport { AvatarProps, MessengerChannel, User } from '../types';\r\n\r\nexport function avatarFromChannel(item:MessengerChannel, user?:User|null){\r\n    let avatar;\r\n    let name = item.name\r\n    if (item.member_count<3){\r\n        avatar = (item.member_count==1 || user?.id == item.subowner.id)?item.owner:item.subowner\r\n        name = name.length>0?name:avatar.name \r\n    }\r\n    return {avatar, name}\r\n}\r\n\r\nexport default (props:AvatarProps)=>{\r\n    // return <MaterialIcons size={38} style={{ marginBottom: -3, marginRight:10 }} name='account-circle'/>\r\n    return <Avatar {...props}/>\r\n}\r\n\r\n","import * as React from 'react';\r\nimport { View, Text } from './Themed';\r\nimport { StyleSheet, StyleProp, ViewStyle, TextStyle } from 'react-native';\r\nimport Colors from '../constants/Colors';\r\n\r\nexport type SectionParamList = {\r\n    title?: string,\r\n    titleStyle?:StyleProp<TextStyle>\r\n    outerContainerStyle?:StyleProp<TextStyle>\r\n    containerStyle?:StyleProp<ViewStyle>\r\n    bodyStyle?:StyleProp<ViewStyle>\r\n    subtitle?: string\r\n    withSeparator?: boolean\r\n    children?: React.ReactNode\r\n}\r\n\r\nexport default function CommonSection(props:SectionParamList){\r\n  return (\r\n    <View style={[styles.outerContainer, props.outerContainerStyle]}>\r\n        <View style={[styles.container, props.containerStyle]}>\r\n            {props.withSeparator?<View style={styles.separator} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />:undefined}\r\n            {props.title?<View style={styles.titleView}>\r\n              <Text style={[styles.title, props.titleStyle]}>{props.title}</Text>\r\n              <Text style={styles.subtitle}>{props.subtitle}</Text>\r\n            </View>:undefined}\r\n            <View style={[styles.bodyView, props.bodyStyle]}>\r\n            {props.children}\r\n            </View>\r\n          </View>\r\n        </View>\r\n    )\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  outerContainer:{\r\n    width:'100%',\r\n    maxWidth:1080,\r\n    alignItems:'stretch',\r\n    backgroundColor:'transparent'\r\n  },  \r\n  container: {\r\n      marginHorizontal:20,\r\n      marginVertical: 10,\r\n      backgroundColor:'transparent',\r\n    },\r\n    titleView:{\r\n      width: '100%',\r\n      flexDirection:'row',\r\n      backgroundColor:'transparent',\r\n      marginBottom:5,\r\n    },\r\n    title: {\r\n      flex:1,\r\n      fontSize: 16,\r\n    },\r\n    subtitle: {\r\n      flex:1,\r\n      fontSize: 12,\r\n      textAlign: 'right',\r\n      marginTop:4\r\n    },\r\n    separator: {\r\n      marginBottom: 20,\r\n      height: 1,\r\n      width: '100%',\r\n    },\r\n    bodyView:{\r\n      width: '100%',\r\n      padding: 20,\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n      borderWidth:1,\r\n      borderColor:Colors.borderColor,\r\n      borderRadius:6\r\n    }\r\n  });\r\n  ","import React from 'react'\r\nimport CommonSection from \"./CommonSection\";\r\nimport useResizeContext from '../hooks/useResizeContext';\r\n\r\nexport default (props:{children?: React.ReactNode})=>{\r\n    const windowType = useResizeContext();\r\n    return <CommonSection\r\n        outerContainerStyle={{flex:1, alignSelf:'center', backgroundColor:'#8888', maxWidth:undefined, flexShrink:1}}\r\n        containerStyle={{flex:1, margin:0, justifyContent:'center', alignItems:'center'}}\r\n        bodyStyle={windowType=='landscape'?{width:'90%', height:'90%', padding:'5%'}:{width:'100%', height:'100%', maxWidth:1080}}\r\n    >\r\n        {props.children}\r\n    </CommonSection>\r\n}\r\n\r\nexport const BottomSheet = (props:{children?: React.ReactNode})=><CommonSection\r\n    outerContainerStyle={{flex:1, alignSelf:'center', backgroundColor:'#8888', maxWidth:undefined}}\r\n    containerStyle={{flex:1, margin:0, justifyContent:'flex-end'}}\r\n>\r\n    {props.children}\r\n</CommonSection>","import { useEffect } from \"react\";\r\nimport { useMutation, useQuery, useQueryClient } from \"react-query\";\r\nimport { getMessengerChannelList, postChannel, postDirectChannel, putChannel } from \"../../apis\";\r\nimport { MessengerChannel, MessengerContent } from \"../../types\";\r\nimport { Auth } from \"../useAuthContext\";\r\nimport useWebsocketContext from \"../useWebsocketContext\";\r\n\r\nexport default function useMessengerChannelList(auth?:Auth){\r\n  const queryClient = useQueryClient()\r\n  const {lastJsonMessage} = useWebsocketContext()\r\n  const { data } = useQuery(\"MessengerChannelList\" , async()=>auth?.user?.id?(await getMessengerChannelList(auth.user.id)):[])\r\n\r\n  useEffect(()=>{\r\n    if(lastJsonMessage !=null){\r\n      if(lastJsonMessage['type']=='enter'){\r\n        queryClient.setQueryData<MessengerChannel[]>(\"MessengerChannelList\", (_data)=>{\r\n          return (_data?.find(v=>v.id==lastJsonMessage['data']['id'])?_data:[lastJsonMessage['data'] , ...(_data|| [])]).sort((a, b)=>a.id - b.id)\r\n        })\r\n      }\r\n      if (lastJsonMessage['type']=='next_message'){\r\n        const data:MessengerContent = lastJsonMessage['data']\r\n        queryClient.setQueryData<MessengerChannel[]>(\"MessengerChannelList\", (_data)=>(_data || []).map(v=>{\r\n          if (v.id == data.channel){\r\n            return {...v, last_message:{content:data.message_set[0]?.content, created:data.created}}\r\n          }\r\n          return v\r\n        }))\r\n      }\r\n      // if(lastJsonMessage['type']=='leave'){\r\n      //   queryClient.setQueryData<Channel[]>(\"MessengerChannelList\", (_data)=>_data?.filter(v=>v.id!=lastJsonMessage['data']['channel_id']) || [])\r\n      // }\r\n    }\r\n  }, [lastJsonMessage])\r\n  return data\r\n}\r\n\r\nexport function useMessengerChannelSorted(auth?:Auth){\r\n  const channelList = useMessengerChannelList(auth);\r\n  return channelList?.sort((a, b)=>(a.last_message?.created || '') < (b.last_message?.created || '')?1:-1)\r\n}\r\nexport function useMessengerChannelMutation(){\r\n  const queryClient = useQueryClient()\r\n\r\n  const create = useMutation(postChannel, {\r\n    onSuccess: ()=>queryClient.invalidateQueries(\"MessengerChannelList\")\r\n  });\r\n\r\n  const update = useMutation(putChannel, {\r\n    onSuccess: () => queryClient.invalidateQueries(\"MessengerChannelList\")\r\n  })\r\n\r\n  const direct = useMutation(postDirectChannel, {\r\n    onSuccess: () => queryClient.invalidateQueries(\"MessengerChannelList\")\r\n  })\r\n\r\n  return { create:create.mutateAsync, update:update.mutateAsync, direct:direct.mutateAsync}\r\n}","import React, { Context, createContext,  useContext, useEffect, useState } from \"react\"\r\nimport useWebSocket from \"react-use-websocket\"\r\nimport { SendJsonMessage } from \"react-use-websocket/dist/lib/types\"\r\nimport {websockerURL } from \"../constants/Envs\"\r\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\r\nimport { AppState, AppStateStatus } from \"react-native\";\r\n\r\ntype WebsocketContextType = {lastJsonMessage:any, sendJsonMessage:SendJsonMessage }\r\nconst defaultContext = {lastJsonMessage:undefined, sendJsonMessage:()=>{}}\r\nconst WebSocketContext = createContext<WebsocketContextType>(defaultContext);\r\n\r\nexport const WebSocketInternalProvider = ({children, path, Context, useBackground}:{children:React.ReactNode, path:string, Context:Context<WebsocketContextType>, useBackground?:boolean})=>{\r\n  const [token, setToken] = useState<string|null>(null)\r\n  const [isActive, setIsActive] = useState<boolean>(useBackground || AppState.currentState == 'active')\r\n  const { lastJsonMessage, sendJsonMessage } = useWebSocket(`${websockerURL}/${path}`,{\r\n    shouldReconnect: (closeEvent) => true,\r\n    protocols: token?['Authorization',  token]:undefined,\r\n    onOpen: (e)=>{console.log(`success websocket connection(${path})`)},\r\n    onClose: (e)=> {console.log(`closed websocket connection(${path})`)},\r\n  }, isActive && token!=null)\r\n  useEffect(()=>{\r\n    AsyncStorage.getItem('Authorization').then(setToken)\r\n    const onChange = (nextState:AppStateStatus)=>setIsActive(useBackground || nextState == 'active')\r\n    AppState.addEventListener(\"change\", onChange)\r\n    return ()=>AppState.removeEventListener(\"change\", onChange)\r\n  }, [])\r\n  return <Context.Provider value={token!=null?{lastJsonMessage, sendJsonMessage}:defaultContext}>\r\n      {children}\r\n    </Context.Provider>\r\n}\r\n\r\nexport const WebSocketProvider = ({disable, children}:{disable?:boolean, children:React.ReactNode})=>{\r\n  return disable?<>{children}</>:<WebSocketInternalProvider path={'messenger/ws/'} Context={WebSocketContext}>\r\n    {children}\r\n  </WebSocketInternalProvider>\r\n}\r\n\r\nexport default ()=>{\r\n  const webSocketContext = useContext(WebSocketContext)\r\n  return webSocketContext\r\n}\r\n\r\n","import React, { useState } from 'react';\r\nimport { StyleSheet} from 'react-native';\r\nimport { CustomButtonProps } from '../types';\r\nimport CommonButton from './CommonButton';\r\n\r\nexport default (props:CustomButtonProps)=>{\r\n    return <CommonButton {...props} style={[styles.style, props.style]}/>\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n    style:{\r\n        borderRadius:6, \r\n        backgroundColor: 'transparent',\r\n        borderWidth:0\r\n    },\r\n});\r\n","/**\r\n * If you are not familiar with React Navigation, refer to the \"Fundamentals\" guide:\r\n * https://reactnavigation.org/docs/getting-started\r\n *\r\n */\r\nimport { NavigationContainer, DefaultTheme, DarkTheme, NavigationContainerRef } from '@react-navigation/native';\r\nimport * as React from 'react';\r\n\r\nimport LinkingConfiguration from './LinkingConfiguration';\r\nimport RootNavigator from './RootNavigator';\r\n\r\nimport { useColorScheme as useDefaultColorScheme } from 'react-native';\r\nimport { useColorScheme as useColorScheme } from 'react-native-appearance';\r\nimport { ResizeContextProvider } from '../hooks/useResizeContext';\r\n\r\n\r\nconst navigationRef = React.createRef<NavigationContainerRef>();\r\n\r\nexport function navigate(name:string, params?:any) {\r\n  if (params)\r\n    navigationRef.current?.navigate(name, params);\r\n  navigationRef.current?.navigate(name);\r\n}\r\n\r\nexport default function Navigation() {\r\n  const defaultColorScheme = useDefaultColorScheme()\r\n  const userColorScheme = useColorScheme()\r\n  const colorScheme = userColorScheme =='no-preference'?defaultColorScheme:userColorScheme\r\n  return <NavigationContainer\r\n    ref={navigationRef}\r\n    documentTitle={{formatter: (options, route) => {return `TOKKI TOK`}}}\r\n    linking={(process.versions && process.versions['electron'])?undefined:LinkingConfiguration}\r\n    theme={colorScheme === 'dark' ? DarkTheme : DefaultTheme}>\r\n        <ResizeContextProvider>\r\n          <RootNavigator />\r\n        </ResizeContextProvider>\r\n  </NavigationContainer>\r\n}\r\n\r\n(function(l) {  // for github-page\r\n    if (l !== undefined && l.search[1] === '/' ) {\r\n        var decoded = l.search.slice(1).split('&').map(function(s) { \r\n        return s.replace(/~and~/g, '&')\r\n        }).join('?');\r\n        window.history.replaceState(null, '',\r\n            l.pathname.slice(0, -1) + decoded + l.hash\r\n        );\r\n    }\r\n}(window.location))\r\n    \r\nconst ignoreWarnings = ['ReactNativeFiberHostComponent'];\r\nlet _console:any = ()=>{}\r\nimport('lodash').then(_=>{\r\n  _console = _.clone(console);\r\n})\r\nconsole.warn = (message: string|Object) => {\r\n    var warn = true;\r\n    if (message instanceof Object)\r\n    warn = false;\r\n    else{\r\n    ignoreWarnings.forEach((value)=>{\r\n        if (message.indexOf && message.indexOf(value) <= -1) {\r\n            warn = false;\r\n        }\r\n    })\r\n    };\r\n    if (warn){\r\n        _console.warn(message);\r\n    }\r\n    else{\r\n        // console.log(message)\r\n    }\r\n};\r\n","import { useMutation, useQuery, useQueryClient } from \"react-query\";\r\nimport { postBulkMessengerMember, deleteMessengerMember, getMessengerMemberList } from \"../../apis\";\r\n\r\nexport default function useMessengerMemberList(channel_id:number){\r\n  const { data } = useQuery([\"MessengerMemberList\", channel_id] , async()=>await getMessengerMemberList(channel_id))\r\n  return data\r\n}\r\n\r\n\r\nexport function useMessengerMemberMutation(){\r\n  const queryClient = useQueryClient()\r\n  const invite = useMutation(postBulkMessengerMember, {\r\n    onSuccess: ()=>{\r\n      queryClient.invalidateQueries(\"MessengerMemberList\")\r\n    }\r\n  })\r\n\r\n  const leave = useMutation(deleteMessengerMember, {\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries(\"MessengerChannelList\")\r\n      queryClient.invalidateQueries(\"MessengerMemberList\")\r\n    }\r\n  })\r\n  return {invite:invite.mutateAsync, leave:leave.mutateAsync}\r\n}","import React, {useState, useEffect } from 'react';\r\nimport { StyleSheet } from 'react-native';\r\nimport { View, Text } from '../components/Themed';\r\nimport CommonButton from '../components/CommonButton';\r\n// import useBoardChannelList, { useBoardChannelMutation } from '../hooks/lists/useBoardChannelList';\r\nimport useAuthContext from '../hooks/useAuthContext';\r\nimport { navigate } from '../navigation';\r\nimport { Channel } from '../types';\r\nimport useMessengerChannelList, { useMessengerChannelMutation } from '../hooks/lists/useMessengerChannelList';\r\nimport TextField from '../components/TextField';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport ModalSection from '../components/ModalSection';\r\nimport { useMessengerMemberMutation } from '../hooks/lists/useMessengerMemberList';\r\nimport { avatarFromChannel } from '../components/Avatar';\r\n\r\nexport default function ChannelEditModal({id, member_id, type}: {id?:number, member_id?:number, type:string}) {\r\n  const { lang } = useLangContext()\r\n  const {auth} = useAuthContext()\r\n  const { setModal } = useModalsContext()\r\n  const channelList = useMessengerChannelList(auth)\r\n  const channelMutation = useMessengerChannelMutation()\r\n  const messengerMemberMutation = useMessengerMemberMutation()\r\n  const channel = channelList?.find(v=>v.id==id)\r\n  const [name, setName] = useState('')\r\n  const [description, setDescription] = useState('')\r\n  const back = ()=>{\r\n    setModal(ChannelEditModal, null)\r\n  }\r\n\r\n  useEffect(()=>{\r\n    if (channel){\r\n      const {name:_name} = avatarFromChannel(channel, auth.user)\r\n      setName(_name)\r\n      setDescription(channel?.description || '')\r\n    }\r\n  }, [channel])\r\n  return <ModalSection>\r\n    <View style={{justifyContent:'space-between', flex:1, width:'100%'}}>\r\n      <View style={{width:'100%'}}>\r\n        <Text style={{fontSize:20}}>{id?lang('Chat Setting'):lang('New chat')}</Text>\r\n        <View style={styles.separator} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\r\n        <TextField name={lang('Channel Name')} value={name} setValue={setName} width={'60%'}/>\r\n        <TextField name={lang('Description')} value={description} setValue={setDescription} multiline width={'60%'}/>\r\n      </View>\r\n      <View style={{width:'100%', flexDirection:'row'}}>\r\n        {member_id &&<View style={{flexDirection:'row', justifyContent:'flex-start'}}>\r\n          <CommonButton title={lang('leave')} style={{marginHorizontal:5}} onPress={()=>messengerMemberMutation.leave(member_id).then(back)}/>\r\n        </View>}\r\n        <View style={{flex:1, flexDirection:'row', justifyContent:'flex-end'}}>\r\n          <CommonButton title={lang('save')} onPress={()=>{\r\n            if(auth?.user?.id && auth.groupId){\r\n              const newChannel:Channel = {id, name, description, type, owner:auth?.user?.id, group:auth.groupId};\r\n              (id?channelMutation.update(newChannel):channelMutation.create(newChannel)).then(v=>navigate(\"Main\", {\r\n                screen:v.type == 'messenger'?'ChatScreen':'BoardScreen',\r\n                params:{id:v.id}\r\n              }))\r\n            }\r\n          }}/>\r\n          <CommonButton title={lang('cancel')} style={{marginHorizontal:5}} onPress={back}/>\r\n        </View>\r\n      </View>\r\n    </View>\r\n  </ModalSection>\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  field:{\r\n    width:'50%',\r\n    flexDirection:'row',\r\n    padding:10,\r\n  },\r\n  separator: {\r\n    marginBottom: 20,\r\n    height: 1,\r\n    width: '100%',\r\n  },\r\n})","import React from 'react'\r\nimport TextButton from \"./TextButton\"\r\nimport useAuthContext from \"../hooks/useAuthContext\"\r\nimport useResizeContext from '../hooks/useResizeContext'\r\nimport { View } from 'react-native'\r\nimport useModalsContext from '../hooks/useModalsContext'\r\nimport GuestLogoutModal from '../modals/GuestLogoutModal'\r\nimport useLangContext from '../hooks/useLangContext'\r\n\r\ntype ButtonProps = {title:string, onPress:()=>void, windowType?:'landscape'|'portrait'}\r\n\r\nexport default (props:{extra?:ButtonProps[]})=>{\r\n    const { lang } = useLangContext()\r\n    const {auth, dispatch} = useAuthContext()\r\n    const { setModal } = useModalsContext()\r\n    const windowType = useResizeContext()\r\n    const defaultButtonProps:ButtonProps[] = [{title:lang('sign out'), onPress:()=>{\r\n        if (auth?.user?.username.endsWith(\".guest\")){\r\n            setModal(GuestLogoutModal, {})\r\n        }\r\n        else{\r\n            dispatch({type:\"LOGOUT_REQUEST\"})\r\n        }\r\n    }}]\r\n    const buttonProps = (props.extra?[...props.extra, ...defaultButtonProps]:defaultButtonProps).filter(v=>v.windowType==windowType || v.windowType == undefined)\r\n    return<View style={{flexDirection:'row'}}>\r\n        {buttonProps.map((v,k)=><TextButton key={k} {...v} textStyle={{color:'white'}} color='#gray'/>)}\r\n    </View>\r\n}\r\n  ","import { useQuery } from \"react-query\";\r\nimport { getUserMembershipList } from \"../../apis\";\r\nimport { Auth } from \"../useAuthContext\";\r\n\r\nexport default function useUserMembershipList(auth?:Auth){\r\n  const { data } = useQuery([\"UserMembershipList\", auth?.groupId] , async()=>auth?.groupId?(await getUserMembershipList(auth?.groupId)):[])\r\n  return data\r\n}","import React from 'react';\r\nimport { TabView, SceneMap,NavigationState, SceneRendererProps, TabBar } from 'react-native-tab-view';\r\nimport Colors from '../constants/Colors';\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport { TabViewRecord } from '../types';\r\n\r\n\r\nexport default (props:{tabs:TabViewRecord, tabBarPosition:\"top\"|\"bottom\", index?:number, onTab?:(index:number)=>void})=>{\r\n  const { lang } = useLangContext()\r\n  const [index, setIndex] = React.useState(props.index || 0);\r\n  const theme = useColorScheme()\r\n  const entries = Object.entries(props.tabs)\r\n  const onTab = props.onTab\r\n  const icons = Object.assign({}, ...entries.map(([k, v])=>({[k]:v.icon})))\r\n  return <TabView\r\n    renderTabBar={(props:SceneRendererProps & {navigationState: NavigationState<any>})=>{\r\n      return <TabBar\r\n        {...props}\r\n        indicatorStyle={{ backgroundColor: \"#2196F3\" }}\r\n        style={{ backgroundColor:Colors[theme].background }}\r\n        activeColor={Colors[theme].text}\r\n        inactiveColor={Colors[theme].text}\r\n        renderIcon={(scene)=>icons[scene.route.key]}\r\n        onTabPress={(scene)=>onTab?.(entries.findIndex(([k, v])=>k == scene.route.key))}\r\n      />\r\n    }}\r\n    navigationState={{ index, routes: entries.map(([k, v])=>({key:k, title:lang(v.title)}))}}\r\n    onIndexChange={setIndex}\r\n    renderScene={SceneMap(Object.assign({}, ...entries.map(([k, v])=>({[k]:v.component}))))}\r\n    tabBarPosition={props.tabBarPosition}\r\n  />\r\n}\r\n\r\n","import * as React from 'react';\r\nimport { View } from './Themed';\r\nimport { StyleSheet, StyleProp, ViewStyle, TextStyle, Pressable } from 'react-native';\r\nimport Colors from '../constants/Colors';\r\n\r\nexport type ItemParamList = {\r\n    outerContainerStyle?:StyleProp<TextStyle>\r\n    containerStyle?:StyleProp<ViewStyle>\r\n    bodyStyle?:StyleProp<ViewStyle>\r\n    children?: React.ReactNode\r\n    onPress?: ()=>void\r\n}\r\n\r\nexport default function CommonItem(props:ItemParamList){\r\n  const [hover, setHover] = React.useState(false)\r\n  const [press, setPress] = React.useState(false)\r\n  return (\r\n    <Pressable\r\n      style={[styles.outerContainer ,props.outerContainerStyle, (press)?{backgroundColor:'rgb(242,242,242)'}:{}]}\r\n      onPressIn={()=>{setPress(true)}}\r\n      onPressOut={()=>{setPress(false);props.onPress?.()}}\r\n       //@ts-ignore\r\n       onHoverIn={()=>setHover(true)}\r\n       onHoverOut={()=>setHover(false)}\r\n    >\r\n        <View style={[styles.container ,props.containerStyle]}>\r\n            <View style={[styles.bodyView, props.bodyStyle]}>\r\n                <>{props.children}</>\r\n            </View>\r\n      </View>\r\n    </Pressable>\r\n    )\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  outerContainer:{\r\n    width:'100%',\r\n    maxWidth:1080,\r\n    alignItems:'stretch',\r\n  },  \r\n  container: {\r\n      marginHorizontal:20,\r\n      backgroundColor:'transparent'\r\n    },\r\n    bodyView:{\r\n      width: '100%',\r\n      padding: 10,\r\n      minHeight: 40,\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n      borderBottomWidth:1,\r\n      borderColor:Colors.borderColor,\r\n      backgroundColor:'transparent'\r\n    }\r\n  });\r\n  ","import { useCallback, useEffect, useState } from \"react\"\r\nimport { InfiniteData, useInfiniteQuery, useMutation, useQueryClient } from \"react-query\"\r\nimport { getMessengerContentList, postMessage, deleteMessengerContent } from \"../../apis\"\r\nimport { MessengerContent } from \"../../types\"\r\nimport useWebsocketContext from \"../useWebsocketContext\"\r\n\r\nexport type MessengerContentPage = {\r\n  next?:MessengerContentPage\r\n  current:MessengerContent[]\r\n}\r\n\r\nexport default function useMessengerContentList(channel_id:number){  \r\n  const queryClient = useQueryClient()\r\n  const { data, fetchNextPage } = useInfiniteQuery<MessengerContentPage>(\r\n    [\"MessengerContentList\", channel_id], \r\n    async({pageParam})=>getMessengerContentList(channel_id, pageParam).then(current=>({current})), \r\n    {\r\n      select:data=>{\r\n        if(data.pages.length > 1)\r\n          data.pages[data.pages.length - 2].next = data.pages[data.pages.length - 1]\r\n        return data;\r\n      },\r\n      getNextPageParam:(lastPage)=>lastPage?.current.length?lastPage.current[lastPage.current.length - 1].id:undefined,\r\n      refetchOnReconnect:false,\r\n      refetchOnWindowFocus:true\r\n    }\r\n  )\r\n  const { lastJsonMessage } = useWebsocketContext()\r\n  useEffect(()=>{\r\n    if(lastJsonMessage !=null && lastJsonMessage['data']['channel'] == channel_id){\r\n      if(lastJsonMessage['type']=='next_message'){\r\n        queryClient.setQueryData<InfiniteData<MessengerContentPage>>([\"MessengerContentList\", channel_id], (_data)=>{\r\n          if(_data?.pages[0].current && _data?.pages[0].current[0].id != lastJsonMessage['data'].id)\r\n            _data.pages[0].current = [lastJsonMessage['data'], ..._data?.pages[0].current]\r\n          return {...(_data || {pages:[], pageParams:[]})}\r\n        })\r\n      }\r\n      if(lastJsonMessage['type']=='delete_message'){\r\n        queryClient.setQueryData<InfiniteData<MessengerContentPage>>([\"MessengerContentList\", channel_id], (_data)=>{\r\n          console.log(_data?.pages)\r\n          _data?.pages.forEach(page=>{\r\n            const len = page.current.length\r\n            const newCurrent = page.current.filter(v=>v.id!=lastJsonMessage['data'].id)\r\n            console.log(len, newCurrent)\r\n            if (len != newCurrent.length){\r\n              page.current = newCurrent\r\n            }\r\n          })\r\n          return {...(_data || {pages:[], pageParams:[]})}\r\n        })\r\n      }\r\n    }\r\n  }, [lastJsonMessage])\r\n  return { data, fetchNextPage }\r\n}\r\n\r\nexport function useMessengerContentMutation(){\r\n  // const queryClient = useQueryClient()\r\n  const create = useMutation(postMessage, {\r\n    onSuccess: () => {\r\n      // queryClient.setQueryData(['MessengerContentList'], (data:any) => ({\r\n      //   pages: data.pages.slice(0, 1),\r\n      //   pageParams: data.pageParams.slice(0, 1),\r\n      // }))\r\n      // queryClient.invalidateQueries(\"MessengerContentList\")\r\n    }\r\n  });\r\n  const _delete = useMutation(deleteMessengerContent, {\r\n    onSuccess: (d, variables) => {\r\n      // queryClient.setQueryData(['MessengerContentList'], (data:any) => ({\r\n      //   pages: (data.pages as MessengerContent[][]).map(v=>v.filter(v2=>v2.id != variables)),\r\n      //   pageParams: data.pageParams,\r\n      // }))\r\n    }\r\n  })\r\n  return { create:create.mutate, delete:_delete.mutate }\r\n}","import React from 'react';\r\nimport useAuthContext from '../hooks/useAuthContext';\r\nimport CommonButton from '../components/CommonButton';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport { Text, View } from '../components/Themed';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport { BottomSheet } from '../components/ModalSection';\r\n\r\nexport default function GuestLogoutModal({id}:{id:number}) {\r\n  const { lang } = useLangContext()\r\n  const { setModal } = useModalsContext()\r\n  const {dispatch} = useAuthContext()\r\n  const back = ()=>{\r\n    setModal(GuestLogoutModal, null)\r\n  }\r\n  return <BottomSheet>\r\n    <Text>{lang('Guest users cannot reconnect after logging out. Please create an account or log in.')}</Text>\r\n    <View style={{width:'100%', flexDirection:'row', justifyContent:'flex-end'}}>\r\n      <CommonButton title={lang('sign out')} onPress={()=>dispatch({type:\"LOGOUT_REQUEST\"})}/>\r\n      <CommonButton title={lang('cancel')} onPress={()=>back()}/>\r\n    </View>\r\n  </BottomSheet>\r\n}\r\n","import React, { useState } from 'react';\r\nimport { TextInput } from 'react-native';\r\nimport Colors from '../constants/Colors';\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport { CustomTextInputProps } from '../types';\r\n\r\nexport default (props:CustomTextInputProps)=>{\r\n    const [contentHeight, setContentHeight] = useState<number>()\r\n    const minHeight = props.minHeight || 30\r\n    const theme = useColorScheme()\r\n    return <TextInput style={[{\r\n            borderColor:'#d0d7de', \r\n            fontSize:16, \r\n            borderWidth:1, \r\n            borderRadius:6, \r\n            paddingHorizontal:10, \r\n            paddingVertical:3, \r\n            backgroundColor:Colors[theme].background,\r\n            color:Colors[theme].text,\r\n            height:props.multiline?contentHeight:minHeight,\r\n        }, props.style]} \r\n        editable={!props.disabled} \r\n        value={props.value} \r\n        onChangeText={props.setValue}\r\n        onContentSizeChange={props.multiline?(e) => setContentHeight(Math.max(e.nativeEvent.contentSize.height, minHeight) + 2):undefined}\r\n        onBlur={()=>props.onBlur?.(props.value)}\r\n        onEndEditing={()=>props.onEndEditing?.(props.value)}\r\n        multiline={props.multiline}\r\n    />\r\n}","import React from \"react\"\r\nimport CommonItem from \"./CommonItem\"\r\nimport { UserMembership } from \"../types\"\r\nimport Avatar from \"./Avatar\"\r\nimport { Text, View } from \"./Themed\"\r\n\r\nexport default ({member:item, onPress}:{member:UserMembership, onPress?:()=>void})=> {\r\n    return <CommonItem key={item.id} bodyStyle={{flexDirection:'row', justifyContent:'flex-start'}} onPress={onPress}>\r\n        <View style={{marginTop:4, marginRight:12}}><Avatar name={item.name} userId={item.id} size={44}/></View>\r\n        <Text style={{fontSize:20, fontWeight:'400'}}>{item.name}</Text>\r\n    </CommonItem>\r\n}","import React, { Suspense, useState } from 'react';\r\nimport CommonButton from '../components/CommonButton';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport {Picker} from '@react-native-picker/picker';\r\nimport { Text, View } from '../components/Themed';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport { Ionicons } from '@expo/vector-icons';\r\nimport { TouchableOpacity } from 'react-native-gesture-handler';\r\nimport Colors from '../constants/Colors';\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport { BottomSheet } from '../components/ModalSection';\r\nimport dayjs from 'dayjs';\r\n\r\nconst dayTypes = ['AM', 'PM'].map(value=>({label:value, value}))\r\nconst hours = [...Array(12).keys()].map((value, index)=>(index + 1).toString().padStart(2, '0')).map(value=>({label:value, value}))\r\nconst minutes = [...Array(12).keys()].map((value, index)=>(index * 5).toString().padStart(2, '0')).map(value=>({label:value, value}))\r\n\r\n\r\nconst getDisableDays=(date:dayjs.Dayjs)=>{\r\n  let startDate = date.clone().startOf('month').add(-1, 'month')\r\n  const endDate = date.clone().endOf('month').add(1, 'month')\r\n  const today = dayjs().startOf('day')\r\n  const result = []\r\n  while(startDate<=endDate && startDate<today){\r\n    result.push(startDate.format('YYYY-MM-DD'))\r\n    startDate = startDate.add(1, 'day')\r\n  }\r\n  return result\r\n}\r\n\r\nconst defaultDayjs = ()=>{\r\n  const m = dayjs()\r\n  const restMinute = parseInt(m.format('mm')) % 5\r\n  return m.add(5-restMinute, 'minute')\r\n}\r\n\r\nexport default function DateTimePickerModal({datetime, callback}:{datetime?:string, callback:(datetime?:string)=>void}) {\r\n  const _dayjs = datetime?dayjs(datetime):defaultDayjs()\r\n  const { lang, locale } = useLangContext()\r\n  const theme = useColorScheme()\r\n  const [date, setDate] = useState(_dayjs.format('YYYY-MM-DD'));\r\n  const [dayType, setDayType] = useState(_dayjs.locale('en').format('A'))\r\n  const [hour, setHour] = useState(_dayjs.format('hh'))\r\n  const [minute, setMinute] = useState(_dayjs.format('mm'))\r\n  const [disableDays, setDisableDays] = useState<string[]>(getDisableDays(_dayjs))\r\n  const { setModal } = useModalsContext()\r\n  const Calendar = React.lazy(()=> import('../components/Calendar'))\r\n  const CommonPicker = React.lazy(()=>import('../components/CommonPicker'))\r\n  const back = ()=>{\r\n    setModal(DateTimePickerModal, null)\r\n  }\r\n  return <BottomSheet>\r\n    <View style={{flexDirection:'row', width:'100%'}}>\r\n      <View style={{flex:1, flexDirection:'row'}}>\r\n        <TouchableOpacity onPress={back}>\r\n          <Ionicons size={20} name=\"arrow-back\" color={Colors[theme].text}/>\r\n        </TouchableOpacity>\r\n      </View>\r\n      <View style={{flex:1}}>\r\n        <Text style={{fontSize:20, textAlign:'center'}}>{lang('Date & Time')}</Text>\r\n      </View>\r\n      <View style={{flex:1}}/>\r\n    </View>\r\n    <View style={{marginBottom: 20, height: 1, width: '100%'}} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\r\n    <Suspense fallback={<></>}>\r\n      <Calendar\r\n        locale={locale}\r\n        style={undefined} \r\n        setDate={setDate}\r\n        disableAllTouchEventsForDisabledDays={true}\r\n        onMonthChange={(v)=>setDisableDays(getDisableDays(dayjs(v.dateString)))}\r\n        markedDates={{\r\n          ...disableDays.reduce((p, c)=>{p[c]={disabled:true};return p}, {} as Record<string, any>),\r\n          ...(date?[date]:[]).reduce((p, c)=>{p[c]={selected:true};return p}, {} as Record<string, any>)\r\n        }}\r\n      />\r\n      <View style={{flexDirection:'row', paddingVertical:10, width:400, height:50}}>\r\n        <CommonPicker value={dayType} setValue={setDayType} values={dayTypes}/>\r\n        <Text style={{fontSize:20}}> </Text>\r\n        <CommonPicker value={hour} setValue={setHour} values={hours}/>\r\n        <Text style={{fontSize:20}}> : </Text>\r\n        <CommonPicker value={minute} setValue={setMinute} values={minutes}/>\r\n      </View>\r\n    </Suspense>\r\n    <View style={{flexDirection:'row'}}>\r\n      <CommonButton title={lang('save')} onPress={()=>{\r\n        callback?.(dayjs(`${date} ${hour}:${minute} ${dayType}`).toISOString())\r\n        back()\r\n      }}/>\r\n      <CommonButton title={lang('cancel')} onPress={()=>{\r\n        callback?.(undefined)\r\n        back()\r\n      }}/>\r\n      \r\n    </View>\r\n  </BottomSheet>\r\n}\r\n","import React from 'react';\r\nimport Clipboard from '@react-native-clipboard/clipboard/dist';\r\nimport CommonButton from '../components/CommonButton';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport { Text, View } from '../components/Themed';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport { BottomSheet } from '../components/ModalSection';\r\nimport { TouchableOpacity } from 'react-native-gesture-handler';\r\nimport Colors from '../constants/Colors';\r\nimport { Ionicons } from '@expo/vector-icons';\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport { useMessengerContentMutation } from '../hooks/lists/useMessengerContentList';\r\n\r\nexport default function MessageModal({id, content}:{id:number, content:string}) {\r\n  const { lang } = useLangContext()\r\n  const { setModal } = useModalsContext()\r\n  const theme = useColorScheme()\r\n  const contentMutation = useMessengerContentMutation()\r\n  const back = ()=>{\r\n    setModal(MessageModal, null)\r\n  }\r\n  return <BottomSheet>\r\n    <View style={{flexDirection:'row', width:'100%'}}>\r\n      <View style={{flex:1, flexDirection:'row'}}>\r\n        <TouchableOpacity onPress={back}>\r\n          <Ionicons size={20} name=\"arrow-back\" color={Colors[theme].text}/>\r\n        </TouchableOpacity>\r\n      </View>\r\n      <View style={{flex:1}}>\r\n        <Text style={{fontSize:20, textAlign:'center'}}>{lang('Message')}</Text>\r\n      </View>\r\n      <View style={{flex:1}}/>\r\n    </View>\r\n    <View style={{marginBottom: 20, height: 1, width: '100%'}} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\r\n      <CommonButton style={{height:40, width:'100%', maxWidth:320, justifyContent:'center'}} title={lang('copy')} onPress={()=>{Clipboard.setString(content);back()}}/>\r\n      <CommonButton style={{height:40, width:'100%', maxWidth:320, justifyContent:'center'}} textStyle={{color:'red'}} title={lang('delete')} onPress={()=>{contentMutation.delete(id);back()}}/>\r\n  </BottomSheet>\r\n}\r\n","import React, { useEffect } from 'react';\r\nimport Profile from '../components/Profile';\r\nimport useAuthContext from '../hooks/useAuthContext';\r\nimport useUserMembershipList from '../hooks/lists/useUserMembershipList';\r\nimport { useMessengerChannelMutation } from '../hooks/lists/useMessengerChannelList';\r\nimport CommonButton from '../components/CommonButton';\r\nimport { Channel } from '../types';\r\nimport { navigate } from '../navigation';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport { Text, View } from '../components/Themed';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport { Ionicons } from '@expo/vector-icons';\r\nimport { TouchableOpacity } from 'react-native-gesture-handler';\r\nimport Colors from '../constants/Colors';\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport { BottomSheet } from '../components/ModalSection';\r\n\r\nexport default function ProfileModal({id}:{id:number}) {\r\n  const { lang } = useLangContext()\r\n  const theme = useColorScheme()\r\n  const {auth} = useAuthContext()\r\n  const { setModal } = useModalsContext()\r\n  const userList = useUserMembershipList(auth)\r\n  const user = userList?.find(v=>v.id==id)\r\n  const isSelf = auth.user && user && (auth.user?.id==user?.id)\r\n  const channelMutation = useMessengerChannelMutation()\r\n  const back = ()=>{\r\n    setModal(ProfileModal, null)\r\n  }\r\n  useEffect(()=>{\r\n    if (!(id && user) && userList)\r\n      back()\r\n  }, [userList])\r\n  return user?<BottomSheet>\r\n    <View style={{flexDirection:'row', width:'100%'}}>\r\n      <View style={{flex:1, flexDirection:'row'}}>\r\n        <TouchableOpacity onPress={back}>\r\n          <Ionicons size={20} name=\"arrow-back\" color={Colors[theme].text}/>\r\n        </TouchableOpacity>\r\n      </View>\r\n      <View style={{flex:1}}>\r\n        <Text style={{fontSize:20, textAlign:'center'}}>{lang('profile')}</Text>\r\n      </View>\r\n      <View style={{flex:1}}/>\r\n    </View>\r\n    <View style={{marginBottom: 20, height: 1, width: '100%'}} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\r\n    \r\n    <Profile username={user.username} name={user.name} userId={user.id} />\r\n    <CommonButton title={lang(isSelf?'Chat with me':'1:1 Chat')} onPress={()=>{\r\n      if(auth?.user?.id && auth.groupId){\r\n        const newChannel:Channel = {name:\"\", type:'messenger', owner:auth?.user?.id, group:auth.groupId, subowner:isSelf?undefined:user.id};\r\n        channelMutation.direct(newChannel).then(v=>navigate(\"Main\", {screen:\"ChatScreen\", params: {id:v.id}}))\r\n      }\r\n    }}/>\r\n  </BottomSheet>:<></>\r\n}\r\n","import React from 'react';\r\nimport {View} from 'react-native'\r\nimport {Text} from './Themed';\r\nimport { ProfileProps } from '../types';\r\nimport Avatar from './Avatar';\r\nimport TextButton from './TextButton';\r\nimport CommonTextInput from './CommonTextInput';\r\nimport { patchUser } from '../apis';\r\nimport useAuthContext from '../hooks/useAuthContext';\r\n\r\nexport default (props:ProfileProps)=>{\r\n    const [name, setName] = React.useState<string>()\r\n    const { auth, dispatch } = useAuthContext()\r\n    const isSelf = auth.user?.id == props.userId\r\n    const onChange = ()=>{\r\n        isSelf && patchUser({id:props.userId, name:name || ''}).finally(()=>{\r\n            setName(undefined)\r\n            dispatch({type:\"REFRESH\"})\r\n        })\r\n    }\r\n    return <View style={{width:'100%', height:135, justifyContent:'space-evenly', alignItems:'center'}}>\r\n        <Avatar {...props} size={75}/>\r\n        {name===undefined?\r\n            <TextButton textStyle={{fontWeight:'bold', fontSize:15}} onPress={()=>isSelf && setName(props.name)} title={props.name} disabled={!isSelf}/>:\r\n            <CommonTextInput value={name} style={{textAlign:'center'}} setValue={setName} onBlur={onChange} onEndEditing={onChange} />}\r\n        <Text style={{fontWeight:'normal', fontSize:14}}>{props.username}</Text>\r\n    </View>\r\n}","import { useState,  useEffect } from \"react\"\r\nimport firebase from \"firebase/app\";\r\nimport \"firebase/messaging\";\r\nimport {FCM_PUBLIC_VAPID_KEY, FCM_API_KEY} from \"../constants/Envs\"\r\nimport { Notification as NotificationType, UserMembership } from \"../types\";\r\nimport { getNotification, postNotification, putNotification } from \"../apis/notification\";\r\nimport { Auth } from \"./useAuthContext\";\r\nconst firebaseConfig = require(\"../../web/firebase-config.js\")\r\n// Initialize Firebase\r\nconst key = firebaseConfig.messagingSenderId\r\nconst apiKeyEncrypted = (FCM_API_KEY as string).split('').map((v, i)=> (v.charCodeAt(0) ^ key.charCodeAt(i)).toString(16).padStart(2, '0')).join('')\r\nconst app = firebase.initializeApp({...firebaseConfig, apiKey:FCM_API_KEY});\r\n// const analytics = getAnalytics(app);\r\nconst messaging = firebase.messaging(app);\r\n\r\nmessaging.onMessage((payload) => {\r\n  if (!(\"Notification\" in window)) {\r\n    alert(\"This browser does not support desktop notification\");\r\n  }\r\n  else if (Notification.permission === \"granted\") {\r\n    const message_set = JSON.parse(payload.data['message_set'])[0]\r\n    new Notification(payload.data.channel_name, { body: `${payload.data.name}: ${message_set.content}` });\r\n  }\r\n});\r\n\r\nconst requestToken = async()=>{\r\n  const permission = await Notification.requestPermission();\r\n  if (permission === 'granted') {\r\n    const serviceWorkerRegistration = await navigator.serviceWorker.register(`${process.env.PUBLIC_URL}/firebase-messaging-sw.js?${apiKeyEncrypted}`)\r\n    console.log('[SW]: SCOPE: ', serviceWorkerRegistration.scope);\r\n    const currentToken = await messaging.getToken({serviceWorkerRegistration, vapidKey: FCM_PUBLIC_VAPID_KEY }).catch(\r\n      async()=>await messaging.getToken({serviceWorkerRegistration, vapidKey: FCM_PUBLIC_VAPID_KEY })\r\n    )\r\n    window.addEventListener('beforeunload', (event:any) => {\r\n      event.preventDefault();\r\n      serviceWorkerRegistration.unregister()\r\n    });\r\n    if (currentToken)\r\n      return currentToken\r\n  }\r\n  return undefined\r\n}\r\n\r\n\r\nlet noti:NotificationType|undefined\r\nlet notiListener:((enable:boolean)=>void)[] = []\r\n\r\nconst initEnable = async(user:UserMembership, callback:(enable:boolean)=>void)=>{\r\n  notiListener.push(callback)\r\n  if (notiListener.length == 1){  \r\n    noti = await getNotification(user.id)\r\n    if (noti === undefined){\r\n      noti = await postNotification({user:user.id, type:'WEB', token:null})\r\n    }\r\n    else if(noti.token){\r\n      requestToken().then(async token=>{\r\n        if(noti)\r\n          noti = await putNotification({...noti, token:(token||null)})\r\n        notiListener.map(c=>c(noti?.token?true:false))\r\n      })\r\n    }\r\n    notiListener.map(c=>c(noti?.token?true:false))\r\n  }\r\n}\r\n\r\nconst changeEnable = async(enable:boolean)=>{\r\n  if (noti){\r\n    if(enable){\r\n      const token = await requestToken() || null\r\n      noti = await putNotification({...noti, token})\r\n    }\r\n    else{\r\n      noti = await putNotification({...noti, token:null})\r\n    }\r\n  }\r\n  return noti?.token?true:false\r\n}\r\n\r\nexport default (auth:Auth)=>{\r\n  const [enable, setEnable] = useState<boolean|null>(null)\r\n  useEffect(()=>{\r\n    if (auth.user){\r\n      if(noti === undefined)\r\n        initEnable(auth.user, setEnable)\r\n      else{\r\n        setEnable(noti.token?true:false)\r\n        noti = undefined\r\n        notiListener = []\r\n      }\r\n    }else{\r\n      setEnable(false)\r\n    }\r\n  }, [auth.user])\r\n  return {\r\n    enable,\r\n    setEnable:(_enable:boolean)=>changeEnable(_enable).then(setEnable)\r\n  }\r\n}\r\n","import React from 'react'\r\nimport { View, StyleSheet, Linking, Platform } from 'react-native'\r\nimport { TouchableOpacity } from 'react-native-gesture-handler'\r\nimport { AntDesign } from '@expo/vector-icons'; \r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport Colors from '../constants/Colors';\r\n\r\nconst openURL = Platform.OS=='web'?(url:string)=>{location.href=url}:Linking.openURL\r\n\r\nexport default ()=>{\r\n    const theme = useColorScheme()\r\n    return<View style={Styles.footer_buttons}>\r\n        <TouchableOpacity style={Styles.footer_button} onPress={()=>openURL(\"https://github.com/blacktokki/tokki-tok\")}>\r\n            <AntDesign name=\"github\" size={24} color={Colors[theme].iconColor} />\r\n        </TouchableOpacity>\r\n        <TouchableOpacity style={Styles.footer_button} onPress={()=>Linking.openURL(\"mailto:ydh051541@naver.com\")}>\r\n            <AntDesign name=\"mail\" size={24} color={Colors[theme].iconColor} />\r\n        </TouchableOpacity>\r\n    </View>\r\n}\r\n\r\nconst Styles = StyleSheet.create({\r\n      footer_buttons: {\r\n        width: '100%',\r\n        flexDirection: 'row',\r\n        justifyContent: 'flex-end',\r\n        paddingBottom: 20,\r\n        paddingRight: 20,\r\n      },\r\n      footer_button: {\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        width: 38,\r\n        height: 38,\r\n        marginHorizontal: 12,\r\n        borderWidth: 1,\r\n        borderColor: '#E7E7E7',\r\n        borderRadius: 60,\r\n      },\r\n})","import React, {useLayoutEffect, useState} from 'react';\r\nimport {\r\n  Text,\r\n  TextInput,\r\n  TouchableOpacity,\r\n  View,\r\n  StyleSheet,\r\n} from 'react-native';\r\nimport { StackScreenProps } from '@react-navigation/stack';\r\nimport useAuthContext from '../../hooks/useAuthContext';\r\nimport useLangContext from '../../hooks/useLangContext';\r\nimport ContractFooter from '../../components/ContractFooter';\r\n\r\nexport default function LoginScreen({\r\n  navigation, route\r\n}: StackScreenProps<any, 'Login'>) {\r\n  const { lang } = useLangContext()\r\n  const [username, setUsername] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  const {error, dispatch} = useAuthContext()\r\n  const _login = ()=>dispatch({type:'LOGIN_REQUEST', username, password})\r\n  useLayoutEffect(() => {\r\n    navigation.setOptions({\r\n      headerRight: undefined\r\n    });\r\n  }, [navigation, route]);\r\n\r\n  return (<View style={Styles.login_container}>\r\n    <View style={Styles.login_wrapper}>\r\n      <View style={Styles.form}>\r\n        {error && <View style={Styles.form_error}>\r\n          <Text style={Styles.form_error_text}>{lang(error)}</Text>\r\n        </View>}\r\n        <TextInput\r\n          style={Styles.form_input}\r\n          value={username}\r\n          placeholder={lang('Username')}\r\n          onChangeText={(text) => setUsername(text)}\r\n          autoCapitalize={'none'}\r\n          keyboardType={'email-address'}\r\n          onSubmitEditing={_login}\r\n        />\r\n        <TextInput\r\n          style={Styles.form_input}\r\n          value={password}\r\n          placeholder={lang('Password')}\r\n          secureTextEntry\r\n          onChangeText={(text) => setPassword(text)}\r\n          onSubmitEditing={_login}\r\n        />\r\n        <TouchableOpacity onPress={_login}>\r\n          <View style={Styles.button}>\r\n            <Text style={Styles.button_label}>{lang('Sign in')}</Text>\r\n          </View>\r\n        </TouchableOpacity>\r\n        <TouchableOpacity onPress={() => dispatch({type:\"LOGIN_GUEST\"})}>\r\n          <Text style={Styles.guest_footer_text}>\r\n            {lang(\"Sign in as guest\")}\r\n          </Text>\r\n        </TouchableOpacity>\r\n      </View>\r\n      <View style={Styles.login_social}>\r\n        <View style={Styles.login_social_separator}>\r\n          <View style={Styles.login_social_separator_line} />\r\n          <Text style={Styles.login_social_separator_text}>{'*'}</Text>\r\n          <View style={Styles.login_social_separator_line} />\r\n        </View>\r\n        <View style={Styles.login_social_buttons}>\r\n        </View>\r\n      </View>\r\n      {/* <>\r\n        <TouchableOpacity onPress={() => navigate(\"RegistrationScreen\")}>\r\n          <Text style={Styles.login_footer_text}>\r\n            {\"Don't have an account? \"}\r\n            <Text style={Styles.login_footer_link}>{'Sign up'}</Text>\r\n          </Text>\r\n        </TouchableOpacity>\r\n      </> */}\r\n    </View>\r\n    <ContractFooter/>\r\n  </View>);\r\n};\r\n\r\nconst Styles = StyleSheet.create({\r\n    login_container: {\r\n      flex: 1,\r\n      backgroundColor: '#FFF',\r\n    },\r\n    login_header: {\r\n      alignItems: 'center',\r\n      paddingTop: 30,\r\n      paddingBottom: 50,\r\n      backgroundColor: '#208AEC',\r\n    },\r\n    login_header_logo: {\r\n      width: 220,\r\n      resizeMode: 'contain',\r\n    },\r\n    login_header_text: {\r\n      marginTop: 15,\r\n      color: '#f0f0f0',\r\n      fontSize: 16,\r\n    },\r\n    login_header_text_bold: {\r\n      color: '#fff',\r\n      fontWeight: 'bold',\r\n    },\r\n    login_wrapper: {\r\n      flex: 1,\r\n      justifyContent: 'space-between',\r\n      paddingTop: 40,\r\n      borderTopRightRadius: 12,\r\n      borderTopLeftRadius: 12,\r\n      backgroundColor: '#fff',\r\n      alignItems: 'center',\r\n    },\r\n    form: {\r\n      width: '100%',\r\n      maxWidth: 320,\r\n    },\r\n    form_error: {\r\n      height: 22,\r\n      width:'100%',\r\n    },\r\n    form_error_text:{\r\n      textAlignVertical:'center',\r\n      color:'red',\r\n      fontSize:13,\r\n    },\r\n    form_input: {\r\n      height: 44,\r\n      paddingHorizontal: 20,\r\n      marginBottom: 20,\r\n      backgroundColor: '#EDF0F7',\r\n      borderRadius: 50,\r\n    },\r\n    button: {\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n      height: 44,\r\n      backgroundColor: '#0065A4',\r\n      borderRadius: 50,\r\n    },\r\n    button_label: {\r\n      color: '#fff',\r\n      fontSize: 16,\r\n    },\r\n    login_social: {\r\n      width: '100%',\r\n      maxWidth: 280,\r\n      marginTop: 20,\r\n    },\r\n    login_social_separator: {\r\n      flexDirection: 'row',\r\n      alignItems: 'center',\r\n    },\r\n    login_social_separator_line: {\r\n      flex: 1,\r\n      width: '100%',\r\n      height: 1,\r\n      backgroundColor: '#E0E0E0',\r\n    },\r\n    login_social_separator_text: {\r\n      marginHorizontal: 10,\r\n      color: '#808080',\r\n      fontSize: 16,\r\n    },\r\n    login_social_buttons: {\r\n      flexDirection: 'row',\r\n      justifyContent: 'center',\r\n      marginTop: 20,\r\n    },\r\n    login_social_button: {\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n      width: 60,\r\n      height: 60,\r\n      marginHorizontal: 12,\r\n      borderWidth: 1,\r\n      borderColor: '#E7E7E7',\r\n      borderRadius: 60,\r\n    },\r\n    login_social_icon: {\r\n      width: 38,\r\n      height: 38,\r\n      resizeMode: 'contain',\r\n    },\r\n    login_social_facebook: {\r\n      backgroundColor: '#4267B2',\r\n      borderColor: '#4267B2',\r\n    },\r\n    login_footer_text: {\r\n      flexDirection: 'row',\r\n      alignItems: 'center',\r\n      color: '#808080',\r\n      fontSize: 14,\r\n    },\r\n    guest_footer_text: {\r\n      flexDirection: 'row',\r\n      alignSelf: 'center',\r\n      color: '#808080',\r\n      fontSize: 15,\r\n      margin: 15\r\n    },\r\n    login_footer_link: {\r\n      color: '#208AEC',\r\n      fontSize: 15,\r\n      fontWeight: 'bold',\r\n    },\r\n  });\r\n  ","import React from 'react'\r\nimport { TouchableOpacity } from \"react-native-gesture-handler\"\r\nimport CommonSection from \"./CommonSection\"\r\nimport { Image, Linking, TextStyle } from \"react-native\"\r\nimport { View, Text } from \"./Themed\"\r\nimport { Link } from \"../types\"\r\n\r\n\r\n\r\nexport default ({link, isMobile}:{link:Link, isMobile:boolean})=>{\r\n    return <CommonSection containerStyle={{marginHorizontal:0}} bodyStyle={{padding:0}}>\r\n    <TouchableOpacity onPress={()=>Linking.openURL(link.url)} style={{flexDirection:'row'}} containerStyle={{width:'100%'}}>\r\n        {link.image && <Image source={{uri:link.image}} resizeMode=\"cover\" style={{ width:'100%', maxWidth:isMobile?120:150, maxHeight:isMobile?120:150, borderWidth:1}}/>}\r\n        <View style={{flex:1, marginHorizontal:20}}>\r\n        <Text style={{fontSize:18}}>{link.title}</Text>\r\n        <Text style={{fontSize:14}}>{link.description}</Text>\r\n        <Text style={{fontSize:12}}>{link.url}</Text>\r\n        </View>\r\n    </TouchableOpacity>\r\n    </CommonSection>\r\n}","import React, { createContext, useContext } from \"react\"\r\nimport { SendJsonMessage } from \"react-use-websocket/dist/lib/types\";\r\nimport { WebSocketInternalProvider } from \"../../hooks/useWebsocketContext\";\r\n\r\nconst WebSocketContext = createContext<{lastJsonMessage:any, sendJsonMessage:SendJsonMessage }>({lastJsonMessage:undefined, sendJsonMessage:()=>{}});\r\n\r\nexport const WebSocketProvider = ({disable, children}:{disable?:boolean, children:React.ReactNode})=>{\r\n  return disable?<></>:<WebSocketInternalProvider path={'messenger/ws/rtc/'} Context={WebSocketContext} useBackground>\r\n    {children}\r\n  </WebSocketInternalProvider>\r\n}\r\n\r\nexport default ()=>{\r\n  const webSocketContext = useContext(WebSocketContext)\r\n  return webSocketContext\r\n}\r\n\r\n","import React, { useCallback, useRef, useState, useMemo } from \"react\";\r\n//@ts-ignore\r\nimport { RTCView, mediaDevices, RTCPeerConnection, MediaStream, RTCSessionDescription, RTCIceCandidate } from \"react-native-webrtc-web-shim\";\r\nimport {TURN_SERVER} from \"../../../constants/Envs\"\r\n\r\n\r\nconsole.log(TURN_SERVER?\"use turn server\": \"use stun server\")\r\n\r\nexport const peerConstraints = {\r\n\ticeServers: [TURN_SERVER?JSON.parse(TURN_SERVER):{urls: 'stun:stun.l.google.com:19302'}]\r\n};\r\n\r\nexport const sessionConstraints = {\r\n\tmandatory: {\r\n\t\tOfferToReceiveAudio: true,\r\n\t\tOfferToReceiveVideo: true,\r\n\t\tVoiceActivityDetection: true\r\n\t}\r\n};\r\n\r\nconst mediaConstraints = {audio:true, video:{framerate:30}}\r\n\r\n//@ts-ignore\r\nexport {MediaStream, RTCPeerConnection, RTCSessionDescription} from \"react-native-webrtc-web-shim\";\r\n\r\nconst onICEcandidate = (pc:typeof RTCPeerConnection, message:any)=>{\r\n\tconst _message = message.data.rtcMessage\r\n\t\tconst candidate = new RTCIceCandidate(_message);\r\n\t\tif (pc) {\r\n\t\t\tconsole.log(\"ICE candidate Added\");\r\n\t\t\tpc.addIceCandidate(candidate);\r\n\t\t}\r\n}\r\n\r\nconst sendICEcandidate = (event:any, sendMessage:(data:any)=>void, receiver:string, target:string) => {\r\n\t// When you find a null candidate then there are no more candidates.\r\n\t// Gathering of candidates has finished.\r\n\tif ( !event.candidate ) { return; };\r\n\t// Send the event.candidate onto the person you're calling.\r\n\t// Keeping to Trickle ICE Standards, you should send the candidates immediately.\r\n\tsendMessage({type:'ICEcandidate', receiver, data:{target, rtcMessage:event.candidate}})\r\n  }\r\n\r\nconst BAND_WIDTH = 8000\r\n\r\nconst optimizeSdp = (offerDescription:RTCSessionDescription)=>{\r\n\tvar arr = offerDescription.sdp.split('\\r\\n');\r\n\tarr.forEach((str:string, i:number) => {\r\n\t\tif (/^a=fmtp:\\d*/.test(str)) {\r\n\t\t\tarr[i] = str + `;x-google-max-bitrate=${BAND_WIDTH};x-google-min-bitrate=${BAND_WIDTH};x-google-start-bitrate=${BAND_WIDTH}`;\r\n\t\t} else if (/^a=mid:(0|video)/.test(str)) { // if with audio then 0=>1\r\n\t\t\tarr[i] += `\\r\\nb=AS:${BAND_WIDTH}`;\r\n\t\t}\r\n\t});\r\n  \treturn new RTCSessionDescription({\r\n    \ttype: offerDescription.type,\r\n    \tsdp: arr.join('\\r\\n'),\r\n  \t})\r\n}\r\n\r\nconst createOffer = async(pcRefCurrent:{pc?:typeof RTCPeerConnection, receiver:string}, sendMessage:(data:any)=>void, stream:typeof MediaStream, target:string, user?:{name:string})=>{\r\n\tstream && pcRefCurrent.pc.addStream( stream );\r\n\tconst offerDescription = optimizeSdp((await pcRefCurrent.pc.createOffer( sessionConstraints )));\r\n\tawait pcRefCurrent.pc.setLocalDescription( offerDescription );\r\n\tsendMessage({type:'call', receiver:pcRefCurrent.receiver, data:{target, name:user?.name, rtcMessage:offerDescription}})\r\n}\r\n\r\nexport const useLocalCam = (sendMessage:(data:any)=>void)=>{\r\n\tconst pcRef = useRef<Record<number,{pc:typeof RTCPeerConnection, receiver:string}>>({})\r\n\tconst [sender, setSender] = useState<string>()\r\n\tconst [_stream, setStream] = useState<MediaStream>()\r\n\tconst isPlay = useMemo(()=>_stream?true:false, [_stream])\r\n\tconst CustomRTCView = useCallback(React.memo(({style}:{style:any})=>(_stream?<RTCView stream={_stream} style={style} videoProps={{height:'100%'}} />:<></>)) , [_stream])\r\n\tconst start = useCallback(async(user:{name:string}, stream?:typeof MediaStream, mode?:'camera'|'display')=>{\r\n\t\tconsole.log(\"start\");\r\n\t\tif (!_stream || mode!==undefined) {\r\n\t\t\ttry {\r\n\t\t\t\tlet newStream:typeof MediaStream;\r\n\t\t\t\tif(mode == 'camera'){\r\n\t\t\t\t\tnewStream = await mediaDevices.getUserMedia(mediaConstraints)\r\n\t\t\t\t}\r\n\t\t\t\telse if (mode == 'display'){\r\n\t\t\t\t\tnewStream = await mediaDevices.getDisplayMedia(mediaConstraints)\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tnewStream = stream || await mediaDevices.getUserMedia(mediaConstraints).catch((e:any)=>mediaDevices.getDisplayMedia(mediaConstraints));\r\n\t\t\t\t}\r\n\t\t\t\tsetStream(newStream)\r\n\t\t\t\tObject.entries(pcRef.current).map(([k, v])=>{\r\n\t\t\t\t\tcreateOffer(v, sendMessage, newStream, 'guest', user)\r\n\t\t\t\t})\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.error(e);\r\n\t\t\t}\r\n\t\t}\r\n\t}, [_stream])\r\n\tconst stop = useCallback(()=>{\r\n\t\tconsole.log(\"stop\");\r\n\t\tif(_stream){\r\n\t\t\t_stream.getTracks().map((track:any) => track.stop());\r\n\t\t\tsetStream(undefined)\r\n\t\t}\r\n\t}, [_stream])\r\n\treturn {\r\n\t\tstart,\r\n\t\tstop,\r\n\t\twebsocketOnMessage: async(response:any, user:{name:string})=>{\r\n\t\t\tlet type = response.type;\r\n\t\t\tif (type == 'connection'){\r\n\t\t\t\tsetSender(response.data.channel_name)\r\n\t\t\t}\r\n\t\t\tif (type == 'start' && response.data.target=='host'){\r\n\t\t\t  console.log('1 start')\r\n\t\t\t  const peerConnection = new RTCPeerConnection( peerConstraints );\r\n\t\t\t  peerConnection.addEventListener( 'icecandidate', (event:any) => sendICEcandidate(event, sendMessage, response.sender, 'guest'));\r\n\t\t\t  pcRef.current[response.sender] = {pc:peerConnection, receiver: response.sender}\r\n\t\t\t  createOffer(pcRef.current[response.sender], sendMessage, _stream, 'guest', user)\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (type == \"answer\" && response.data.target == 'host'){\r\n\t\t\t  console.log('3 answer')\r\n\t\t\t  const peerConnection = pcRef.current[response.sender].pc\r\n\t\t\t  const answerDescription = new RTCSessionDescription(response.data.rtcMessage);\r\n\t\t\t  await peerConnection.setRemoteDescription( answerDescription );\r\n\t\t\t  // const streams = pcRef.current.pc.getRemoteStreams()\r\n\t\t\t  // setMirrorStream(streams[streams.length - 1])\r\n\t\t\t}\r\n\t\t\tif (type == \"ICEcandidate\" && response.data.target=='host'){\r\n\t\t\t\tconst peerConnection = pcRef.current[response.sender].pc\r\n\t\t\t\tonICEcandidate(peerConnection, response)\r\n\t\t\t}\r\n\t\t},\r\n\t\tCustomRTCView,\r\n\t\tisPlay,\r\n\t\tsender,\r\n\t\t// renderMirrorView,\r\n\t}\r\n}\r\n\r\nexport const useRemoteCam = (sendMessage:(data:any)=>void)=>{\r\n\tconst pcRef = useRef<{pc?:RTCPeerConnection, receiver?:string, statsInterval?:any}>({})\r\n\tconst [user, setUser] = useState<{name:string}>()\r\n\tconst [_stream, setStream] = useState<MediaStream>()\r\n\tconst CustomRTCView = useCallback(React.memo((style:any)=>_stream?<RTCView stream={_stream} style={style} videoProps={{height:'100%'}} />:<></>), [_stream])\r\n\tconst isPlay = useMemo(()=>_stream?true:false, [_stream])\r\n\tconst start = useCallback((receiver:string)=>{\r\n\t\tconsole.log(\"start\");\r\n\t\tif (!pcRef.current.pc) {\r\n\t\t  pcRef.current.pc = new RTCPeerConnection( peerConstraints );\r\n\t\t  pcRef.current.receiver = receiver\r\n\t\t}\r\n\t\tif (!_stream){\r\n\t\t\tsendMessage({type:'start', receiver, data:{'target': 'host'}})\r\n\t\t}\r\n\t}, [_stream])\r\n\tconst stop = () => {\r\n\t\tconsole.log(\"stop\");\r\n\t\tif (pcRef.current.pc) {\r\n\t\t  // peerConnection._unregisterEvents();\r\n\t\t  setStream(undefined)\r\n\t\t  pcRef.current.pc.close();\r\n\t\t  pcRef.current.pc = undefined\r\n\t\t  pcRef.current.receiver = undefined\r\n\t\t  clearInterval(pcRef.current.statsInterval)\r\n\t\t}\r\n\t}\r\n\treturn {\r\n\t\tstart,\r\n\t\tstop,\r\n\t\twebsocketOnMessage: async(response:any)=>{\r\n\t\t\tlet type = response.type;\r\n\t\t\tif (type == 'start' && response.data.target=='guest' && response.sender == pcRef.current?.receiver){\r\n\t\t\t\tconsole.log('(remote)1 start')\r\n\t\t\t\tconst peerConnection = pcRef.current.pc\r\n\t\t\t\tsetUser({name: response.data.name})\r\n\t\t\t\tpeerConnection.addEventListener('icecandidate', (event:any) => sendICEcandidate(event, sendMessage, response.sender, 'host'));\r\n\t\t\t\tpeerConnection.addEventListener('iceconnectionstatechange', (e:any)=>{\r\n\t\t\t\t\tif (pcRef.current.pc.iceConnectionState == 'connected'){\r\n\t\t\t\t\t\tlet activeStream = false\r\n\t\t\t\t\t\tpcRef.current.statsInterval = setInterval(async()=>{\r\n\t\t\t\t\t\t\tconst stats = await pcRef.current.pc.getStats(null)\r\n\t\t\t\t\t\t\tlet statsOutput = \"\";\r\n\t\t\t\t\t\t\tlet framePerSecond = undefined\r\n\t\t\t\t\t\t\tstats.forEach((report:any) => {\r\n\t\t\t\t\t\t\t\tif (report.type === \"inbound-rtp\" && report.kind === \"video\") {\r\n\t\t\t\t\t\t\t\t\tObject.keys(report).forEach((statName) => {\r\n\t\t\t\t\t\t\t\t\t\tstatsOutput += `${statName}: ${report[statName]}\\n`;\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\tframePerSecond = report.framesPerSecond\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tconsole.log(activeStream, framePerSecond)\r\n\t\t\t\t\t\t\tif (framePerSecond != undefined){\r\n\t\t\t\t\t\t\t\tactiveStream = true\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if (activeStream){\r\n\t\t\t\t\t\t\t\tstop()\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tconsole.log(new Date().toTimeString().split(' ')[0], statsOutput)\r\n\t\t\t\t\t\t}, 1000);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (pcRef.current.pc.iceConnectionState == 'failed'){\r\n\t\t\t\t\t\tstop()\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t// peerConnection.addTransceiver('audio', {\r\n\t\t\t\t// \tdirection: 'recvonly'\r\n\t\t\t\t// });\r\n\t\t\t\tpeerConnection.addTransceiver('video', {\r\n\t\t\t\t\tdirection: 'recvonly'\r\n\t\t\t\t});\r\n\t\t\t\tawait createOffer({pc:pcRef.current.pc, receiver:response.sender}, sendMessage, _stream, 'host', user)\r\n\t\t\t}  \r\n\t\t\tif (type == \"answer\" && response.data.target=='guest' && response.sender == pcRef.current?.receiver){\r\n\t\t\t\tconsole.log('(remote)3 answer')\r\n\t\t\t\tconst answerDescription = new RTCSessionDescription(response.data.rtcMessage);\r\n\t\t\t\tawait pcRef.current.pc.setRemoteDescription( answerDescription );\r\n\t\t\t\tconst streams = pcRef.current.pc.getRemoteStreams()\r\n\t\t\t\tsetStream(streams[streams.length - 1])\r\n\t\t\t\tsendMessage({type:'end', receiver:pcRef.current.receiver, data:{}})\r\n\t\t\t}\r\n\t\t\tif (type == \"call\" && response.sender == pcRef.current?.receiver){\r\n\t\t\t  console.log('2 call')\r\n\t\t\t  const peerConnection = pcRef.current.pc\r\n\t\t\t  setUser({name:response.data.name})\r\n\t\t\t  if (!peerConnection)\r\n\t\t\t\treturn\r\n\t\t\t  peerConnection.addEventListener( 'icecandidate', (event:any) => sendICEcandidate(event, sendMessage, response.sender, 'host'));\r\n\t\t\t  const offerDescription = new RTCSessionDescription(response.data.rtcMessage);\r\n\t\t\t  await peerConnection.setRemoteDescription( offerDescription );\r\n\t\t\t  const answerDescription = await peerConnection.createAnswer( sessionConstraints );\r\n\t\t\t  await peerConnection.setLocalDescription( answerDescription );\r\n\t\t\t  sendMessage({type:'answer', receiver:pcRef.current.receiver, data:{target:'host', rtcMessage:peerConnection.localDescription}})\r\n\t\t\t  // Here is a good place to process candidates.\r\n\t\t\t  const streams = pcRef.current.pc.getRemoteStreams()\r\n\t\t\t  setStream(streams[streams.length - 1])\r\n\t\t\t}\r\n\t\t\tif (type == \"ICEcandidate\" && response.data.target=='guest' && response.sender == pcRef.current?.receiver)\r\n\t\t\t  onICEcandidate(pcRef.current.pc, response)\r\n\t\t},\r\n\t\tCustomRTCView,\r\n\t\tuser,\r\n\t\tisPlay\r\n\t}\r\n}","import {StyleSheet} from \"react-native\";\r\nexport {useLocalCam, useRemoteCam} from \"./p2p\"\r\n\r\nexport const camStyle = StyleSheet.create({\r\n\tcontainer:{ flex: 1},\r\n\tcam:{ flex: 1, height:'100%'},\r\n\tbottonContainer: {position:\"absolute\", bottom:0, justifyContent:'flex-end'},\r\n\tbuttonBar: { flexDirection: \"row\", justifyContent: \"space-around\" },\r\n\tlabel: {backgroundColor:'#0008', color:'white', paddingHorizontal:5},\r\n})","import React, { useEffect } from \"react\";\r\nimport {Button, View, Text} from \"react-native\";\r\nimport useWebsocketContext from \"./useWebsocketContext\";\r\nimport { useLocalCam, camStyle} from \"./webrtc\";\r\n\r\n\r\nexport default (props:{user?:{name:string}|null, mode?:'camera'|'display'|null})=>{\r\n  const {lastJsonMessage, sendJsonMessage} = useWebsocketContext()\r\n  const {start, stop, websocketOnMessage, CustomRTCView, isPlay} = useLocalCam(sendJsonMessage)\r\n  useEffect(()=>{\r\n    props.user && lastJsonMessage && websocketOnMessage(lastJsonMessage, props.user)\r\n  }, [lastJsonMessage, props.user])\r\n  useEffect(()=>{\r\n    if(props.mode && !isPlay){\r\n      props.user && start(props.user, undefined, props.mode)\r\n    }\r\n    else if(props.mode===null && isPlay){\r\n      stop()\r\n    }\r\n    return ()=>{isPlay && stop()}\r\n  }, [isPlay, props.user, props.mode])\r\n  return (\r\n    <View style={camStyle.container}>\r\n      <CustomRTCView style={camStyle.cam}/>\r\n      <View style={camStyle.bottonContainer}>\r\n        <View style={camStyle.buttonBar}>  \r\n        </View>\r\n        <View style={{flexDirection:'row'}}><Text style={camStyle.label}>{props.user?.name}</Text></View>\r\n        <View style={camStyle.buttonBar}>\r\n          {props.mode === undefined && !isPlay && <Button title=\"Start\" onPress={()=>props.user && start(props.user)} />}\r\n          {props.mode === undefined && isPlay && <Button title=\"Stop\" onPress={stop} />}\r\n        </View>\r\n      </View>\r\n    </View>\r\n  );\r\n}\r\n","import React, { useState, useEffect, } from \"react\";\r\nimport {Button,Text, TextInput, View} from \"react-native\";\r\nimport useWebsocketContext from \"./useWebsocketContext\";\r\nimport { useRemoteCam, camStyle} from \"./webrtc\";\r\n\r\nexport default (props:{receiver?:string})=>{\r\n  const [receiver, setReceiver] = useState('')\r\n  const {lastJsonMessage, sendJsonMessage} = useWebsocketContext()\r\n  const {start, stop, websocketOnMessage, CustomRTCView, isPlay, user} = useRemoteCam(sendJsonMessage)\r\n  useEffect(()=>{\r\n    lastJsonMessage && websocketOnMessage(lastJsonMessage)\r\n  }, [lastJsonMessage])\r\n  useEffect(()=>{\r\n    if(props.receiver){\r\n      start(props.receiver)\r\n    }\r\n    return ()=>stop()\r\n  }, [props.receiver])\r\n  return (\r\n    <View style={camStyle.container}>\r\n      <CustomRTCView style={camStyle.cam}/>\r\n      <View style={camStyle.bottonContainer}>\r\n        <View style={camStyle.buttonBar}>\r\n        </View>\r\n        <View style={{flexDirection:'row'}}>{\r\n          (props.receiver || isPlay)?\r\n          <Text style={camStyle.label}>{user?.name || 'loading...'}</Text>:\r\n          <>\r\n            <Text style={{borderWidth:1}}>Receiver:&nbsp;</Text>\r\n            <TextInput style={{borderWidth:1, flex:1}} value={receiver} onChangeText={setReceiver}/>\r\n          </> \r\n        }</View>\r\n        <View style={camStyle.buttonBar}>\r\n          {props.receiver === undefined && !isPlay && <Button title=\"Start\" onPress={()=>start(receiver)} />}\r\n          {props.receiver === undefined && isPlay && <Button title=\"Stop\" onPress={stop} />}\r\n        </View>\r\n      </View>\r\n    </View>\r\n  );\r\n}\r\n\r\n","import React, {useEffect, useState} from 'react';\r\nimport { StyleSheet, View } from 'react-native';\r\nimport { View as ThemedView } from '../../../components/Themed' \r\nimport Colors from '../../../constants/Colors';\r\nimport {default as useRtcContext, WebSocketProvider as RtcProvider} from \"../../../lib/react-native-webrtc/useWebsocketContext\";\r\nimport LocalCam from '../../../lib/react-native-webrtc/LocalCam';\r\nimport RemoteCam from '../../../lib/react-native-webrtc/RemoteCam';\r\nimport useResizeContext from '../../../hooks/useResizeContext';\r\nimport useAuthContext from '../../../hooks/useAuthContext';\r\nimport { TouchableOpacity } from 'react-native-gesture-handler';\r\nimport CommonButton from '../../../components/CommonButton';\r\nimport { Ionicons } from '@expo/vector-icons';\r\nimport useIsMobile from '../../../hooks/useIsMobile';\r\n\r\ntype VideoType = 'camera'|'display'|null\r\ntype VideoCallProps = {channel_id:number, setDisable:(disable:boolean)=>void, disable?:boolean}\r\n\r\n\r\nconst VideoView = (props:{\r\n  scale:string,\r\n  focusGuest?:string,\r\n  setFocusGuest:(focusGuest?:string)=>void\r\n  receiver?:string\r\n  children:React.ReactNode\r\n})=>{\r\n  return <View style={[{maxWidth:props.scale, maxHeight:props.scale, borderWidth:1, borderColor:Colors.borderColor, backgroundColor:'gray', flexDirection:'row', flexGrow:1}, (props.focusGuest == undefined || props.focusGuest == props.receiver)?{height:'100%'}:{maxWidth:0, height:0}]}>\r\n    <TouchableOpacity style={{flex:1}} containerStyle={{flex:1, justifyContent:'center'}} onPress={()=>props.setFocusGuest(props.focusGuest?undefined:props.receiver)}>\r\n    {props.children}\r\n    </TouchableOpacity>\r\n  </View>\r\n    \r\n  \r\n}\r\n\r\nconst VideoCallContainer = ({channel_id, disable, setDisable}:VideoCallProps)=>{\r\n  const {auth} = useAuthContext()\r\n  const isMobile = useIsMobile()\r\n  const [videoMode, setVideoMode] = useState<VideoType>(null)\r\n  const [guests, setGuests] = useState<string[]>([])\r\n  const [focusGuest, setFocusGuest] = useState<string>()\r\n  const windowType = useResizeContext()\r\n  const { lastJsonMessage, sendJsonMessage } = useRtcContext()\r\n  useEffect(()=>{\r\n    if(lastJsonMessage !=null){\r\n      if(lastJsonMessage['type']=='connection'){\r\n        sendJsonMessage({'type':'broadcast', 'data':{'channel_id':channel_id}})\r\n      }\r\n      if(lastJsonMessage['type']=='broadcast_guest' || lastJsonMessage['type']=='broadcast_host'){\r\n        setGuests([...guests, lastJsonMessage['sender']])\r\n      }\r\n      if(lastJsonMessage['type']=='broadcast_disconnect'){\r\n        const channel_name = lastJsonMessage['sender']\r\n        const exist = guests.find(v=>v == channel_name)\r\n        exist && setGuests(guests.filter(v=>v != channel_name))\r\n      }\r\n    }\r\n  }, [lastJsonMessage])\r\n  const scale = focusGuest?'100%':`${100 / Math.max(2, Math.ceil(Math.sqrt(guests.length + 1)))}%`\r\n  const toggleVideoMode = (mode:VideoType)=>{\r\n    setVideoMode(videoMode!=mode?mode:null)\r\n  }\r\n  return lastJsonMessage !==undefined ?\r\n    <ThemedView style={[\r\n      {aspectRatio:!disable?16/9:0, borderColor:Colors.borderColor, borderRadius:10},\r\n      windowType=='landscape'?{flexShrink:1, flexGrow:0, height:'100%', borderLeftWidth:1, paddingBottom:65}:{maxHeight:'36%', width:'100%', borderBottomWidth:1}\r\n    ]}>\r\n      <View style={{aspectRatio:focusGuest?undefined:16/9, backgroundColor:'white', flexWrap:'wrap', flexDirection:'row', width:'100%', height:'100%'}}>\r\n        {guests.map((receiver, i)=><VideoView scale={scale} focusGuest={focusGuest} setFocusGuest={setFocusGuest} receiver={receiver}>\r\n          <RemoteCam receiver={receiver}/>\r\n        </VideoView>\r\n        )}\r\n        <VideoView scale={scale} focusGuest={focusGuest} setFocusGuest={setFocusGuest} receiver={auth.user?.name}>\r\n          <LocalCam user={auth.user} mode={videoMode}/>\r\n        </VideoView>\r\n      </View>\r\n      <ThemedView style={[\r\n          {position:'absolute', alignItems:'center', justifyContent:'flex-end', width:'100%',flexDirection:'row'},\r\n          windowType=='landscape'?{bottom:0, paddingTop:15, paddingBottom:10, paddingHorizontal:19}:{backgroundColor:'transparent'}\r\n        ]}>\r\n        <CommonButton title={'⏺️'} style={{height:40, paddingTop:8}} onPress={()=>toggleVideoMode('camera')}/>\r\n        {!isMobile && <CommonButton title={'🖥️'} style={{height:40, paddingTop:8}} onPress={()=>toggleVideoMode('display')}/>}\r\n        <CommonButton title={''} style={{height:40, paddingTop:8}} onPress={()=>setDisable(true)}>\r\n          <Ionicons size={20} name=\"arrow-back\" color={'deepskyblue'}/>\r\n        </CommonButton>\r\n      </ThemedView>\r\n    </ThemedView>:\r\n  <></>\r\n  }\r\n  \r\nexport default React.memo(({channel_id, disable, setDisable}:VideoCallProps)=>{\r\n  return <RtcProvider disable={disable}>\r\n    <VideoCallContainer channel_id={channel_id} disable={disable} setDisable={setDisable}/>\r\n  </RtcProvider>\r\n})\r\n","import React from 'react'\r\nimport { TouchableOpacity } from \"react-native-gesture-handler\"\r\nimport CommonSection from \"./CommonSection\"\r\nimport { Linking, TextStyle } from \"react-native\"\r\nimport { FontAwesome } from '@expo/vector-icons'; \r\nimport { View, Text } from \"./Themed\"\r\nimport { File } from \"../types\"\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport Colors from '../constants/Colors';\r\n\r\nfunction humanFileSize(size:number) {\r\n    var i = size == 0 ? 0 : Math.floor(Math.log(size) / Math.log(1024));\r\n    return (size / Math.pow(1024, i)).toFixed(2) + ' ' + ['B', 'kB', 'MB', 'GB', 'TB'][i];\r\n  }\r\n  \r\n\r\nexport default ({file, isMobile, showBorder}:{file:File, isMobile:boolean, showBorder:boolean})=>{\r\n    const theme = useColorScheme()\r\n    return <CommonSection containerStyle={{marginHorizontal:0}} bodyStyle={showBorder?{padding:10}:{borderWidth:0, padding:0}}>\r\n    <TouchableOpacity onPress={()=>Linking.openURL(file.file)} style={{flexDirection:'row', alignItems:'flex-start'}} containerStyle={{width:'100%'}}>\r\n        <FontAwesome name=\"file-o\" size={20} color={Colors[theme].iconColor} />\r\n        <View style={{flex:1, marginHorizontal:10}}>\r\n            <Text style={{fontSize:18}}>{file.filename}</Text>\r\n            <Text style={{fontSize:14}}>{humanFileSize(file.filesize)}</Text>\r\n        </View>\r\n    </TouchableOpacity>\r\n    </CommonSection>\r\n}","import React, {useState, useEffect} from \"react\"\r\nimport dayjs from \"dayjs\";\r\nimport {View, TouchableOpacity} from 'react-native'\r\nimport { Text } from \"../../../components/Themed\";\r\nimport useTimerMessageContentList from \"../../../hooks/lists/useTimerMessageContent\";\r\nimport { MessengerContent } from \"../../../types\";\r\nimport Avatar from \"../../../components/Avatar\";\r\nimport Hyperlink from \"react-native-hyperlink\";\r\n\r\nexport function timerFormat(datetime:string){\r\n    return _timerFormat(dayjs(datetime), dayjs())\r\n}\r\n\r\nfunction _timerFormat(m:dayjs.Dayjs, now:dayjs.Dayjs){\r\n    if (m.year() != now.year()){\r\n        return m.format('YYYY.MM')\r\n    }\r\n    if(m.month()!= now.month() || m.day() != now.day()){\r\n        return m.format('MM.DD')\r\n    }\r\n    return m.format('HH:mm')\r\n  }\r\n\r\nexport function timerToString(timer:string){\r\n    return dayjs(timer).format('YYYY.MM.DD HH:mm')\r\n}\r\n\r\nconst TimerTag = (props:{data:MessengerContent, now:dayjs.Dayjs, isExpand:boolean, setExpand:(id?:number)=>void})=>{\r\n    const start = dayjs(props.data.created)\r\n    const end = dayjs(props.data.timer)\r\n    const ratio = (start.diff(props.now)/start.diff(end))\r\n    return <TouchableOpacity onPress={()=>props.setExpand(props.isExpand?undefined:props.data.id)}>\r\n        <View style={{backgroundColor:'lightgray', borderRadius:20, overflow:'hidden', margin:5}}>\r\n            <View style={{backgroundColor:'darkgray', position:'absolute', width:`${ratio*100}%`, height:'100%'}}/>\r\n            {props.isExpand?\r\n            <View style={{paddingVertical:5, paddingHorizontal:5, maxWidth:270}}>\r\n                <View style={{flexDirection:'row'}}>\r\n                    <Avatar name={props.data.name} userId={props.data.user} size={20}/>\r\n                    <View style={{paddingHorizontal:5}}><Text>{props.data.name}</Text></View>\r\n                </View>\r\n                <View style={{flexDirection:'row', alignItems:'stretch'}}>\r\n                    <Text>⌚</Text>\r\n                    <Text selectable>{timerToString(props.data.timer)}</Text>\r\n                </View>\r\n                {/* @ts-ignore */}\r\n                <Hyperlink linkDefault={ true } style={{wordBreak:\"break-word\"}} linkStyle={{color: '#12b886'}}>\r\n                    <Text selectable>{props.data.message_set[0].content}</Text>\r\n                </Hyperlink>\r\n            </View>:    \r\n            <View style={{paddingVertical:5, paddingHorizontal:5, flexDirection:'row'}}>\r\n                <Avatar name={props.data.name} userId={props.data.user} size={20}/>\r\n                <View style={{paddingHorizontal:5}}><Text>{_timerFormat(end, props.now)}</Text></View>\r\n            </View>}\r\n        </View>\r\n    </TouchableOpacity>\r\n}\r\n\r\n\r\nexport default (props:{channel_id:number})=>{\r\n    const timerMessages = useTimerMessageContentList(props.channel_id)\r\n    const [now, setNow] = useState(dayjs())\r\n    const [expand, setExpand] = useState<number>()\r\n    useEffect(()=>{\r\n        const timeout = setTimeout(()=>{\r\n            setNow(dayjs())\r\n        }, 2000)\r\n        return ()=>clearTimeout(timeout)\r\n    }, [now])\r\n    return <View style={{flexDirection:'row', paddingTop:5, paddingHorizontal:20}}>\r\n        {timerMessages?.map((v,i)=><TimerTag key={i} data={v} now={now} isExpand={v.id==expand} setExpand={setExpand}/>)}\r\n    </View>\r\n}","import { useEffect, useMemo } from \"react\"\r\nimport { useQuery, useQueryClient } from \"react-query\"\r\nimport { getTimerMessageContentList } from \"../../apis\"\r\nimport { MessengerContent } from \"../../types\"\r\nimport useWebsocketContext from \"../useWebsocketContext\"\r\nimport dayjs from \"dayjs\"\r\n\r\nexport default function useTimerMessageContentList(channel_id:number){  \r\n  const queryClient = useQueryClient()\r\n  const { data } = useQuery<MessengerContent[]>(\r\n    [\"TimerMessageContentList\", channel_id], \r\n    async()=>await getTimerMessageContentList(channel_id, dayjs().toISOString()), \r\n  )\r\n  const { lastJsonMessage } = useWebsocketContext()\r\n  useEffect(()=>{\r\n    if(lastJsonMessage !=null && lastJsonMessage['data']['channel'] == channel_id){\r\n      if(lastJsonMessage['type']=='next_message'){\r\n        if(lastJsonMessage['data']['timer'] && dayjs() < dayjs(lastJsonMessage['data']['timer']))\r\n          queryClient.setQueryData<MessengerContent[]>([\"TimerMessageContentList\", channel_id], (_data)=>{\r\n            return [...(_data || []), lastJsonMessage['data']]\r\n          })\r\n      }\r\n      if(lastJsonMessage['type']=='delete_message'){\r\n        queryClient.setQueryData<MessengerContent[]>([\"TimerMessageContentList\", channel_id], (_data)=>{\r\n          return [...(_data?.filter(v=>v.id!=lastJsonMessage['data'].id) || [])]\r\n        })\r\n      }\r\n    }\r\n  }, [lastJsonMessage])\r\n  const sorted = useMemo(()=>data?.sort((a, b)=>(a.timer || '') > (b.timer || '')?1:-1), [data])\r\n  useEffect(()=>{\r\n    if (sorted?.[0]?.timer){\r\n      const id = sorted[0].id\r\n      const ms = Math.min(dayjs(sorted[0].timer).diff(dayjs()), Number.MAX_VALUE)\r\n      let timeout = setTimeout(()=>{\r\n        queryClient.setQueryData<MessengerContent[]>([\"TimerMessageContentList\", channel_id], (_data)=>{\r\n          return (_data || []).filter(v=>v.id!=id || dayjs(v.timer).diff(dayjs()) > 0)\r\n        })\r\n      }, ms)\r\n      return ()=>clearTimeout(timeout)\r\n    }\r\n  },[sorted])\r\n  return sorted\r\n}\r\n","import React, {useCallback, useEffect, useLayoutEffect, useMemo, useRef, useState} from 'react';\r\nimport { StackScreenProps } from '@react-navigation/stack';\r\nimport { Platform, StyleSheet, View, TouchableOpacity } from 'react-native';\r\nimport CommonSection from '../../../components/CommonSection';\r\nimport { FlatList, TextInput } from 'react-native-gesture-handler';\r\nimport CommonButton from '../../../components/CommonButton';\r\nimport useMessengerContentList, { MessengerContentPage, useMessengerContentMutation } from '../../../hooks/lists/useMessengerContentList';\r\nimport useAuthContext from '../../../hooks/useAuthContext';\r\nimport HeaderRight from '../../../components/HeaderRight';\r\nimport useMessengerMemberList from '../../../hooks/lists/useMessengerMemberList';\r\nimport Colors from '../../../constants/Colors';\r\nimport useColorScheme from '../../../hooks/useColorScheme';\r\nimport { Text, View as ThemedView } from '../../../components/Themed' \r\nimport Hyperlink from 'react-native-hyperlink'\r\nimport useMessengerChannelList from '../../../hooks/lists/useMessengerChannelList';\r\nimport useIsMobile from '../../../hooks/useIsMobile';\r\nimport LinkPreview from '../../../components/LinkPreview';\r\nimport Avatar, { avatarFromChannel } from '../../../components/Avatar';\r\nimport VideoCallSection from './VideoCallSection';\r\nimport useResizeContext from '../../../hooks/useResizeContext';\r\nimport FilePreview from '../../../components/FilePreview';\r\nimport useModalsContext from '../../../hooks/useModalsContext';\r\nimport InviteModal from '../../../modals/InviteModal';\r\nimport DateTimePickerModal from '../../../modals/DateTimePickerModal'\r\nimport useLangContext from '../../../hooks/useLangContext';\r\nimport { Entypo } from '@expo/vector-icons';\r\nimport TimerTags, { timerFormat, timerToString } from './TimerTags';\r\nimport MessageModal from '../../../modals/MessageModal';\r\nimport ChannelEditModal from '../../../modals/ChannelEditModal';\r\n\r\n\r\nfunction uploadFile(){\r\n  return new Promise<Blob|undefined>((resolve, reject)=>{\r\n    if (Platform.OS == 'web'){\r\n      var input = document.createElement('input');\r\n      input.type = 'file';\r\n      input.onchange = e => { \r\n        resolve((e.target as any).files[0])\r\n      }\r\n      input.onabort = reject\r\n      input.onerror = reject\r\n      input.click();\r\n    }\r\n    else\r\n      resolve(undefined)\r\n  })\r\n}\r\n\r\nconst MessengerContentPageItem = React.memo((props:MessengerContentPage & {ownerId?:number})=>{\r\n  const isMobile = useIsMobile()\r\n  const { setModal } = useModalsContext()\r\n  let nextPage = props.next;\r\n    while(nextPage?.next && nextPage.current.length==0){\r\n      nextPage = nextPage.next\r\n    }\r\n    const nextContent = nextPage?.current[0]\r\n    return <View style={{flexDirection: 'column-reverse'}}>\r\n      \r\n      {props.current.map((content, index2)=>{\r\n        const next = index2 + 1 < props.current.length?props.current[index2+1]:nextContent\r\n        const created:string = content.created.slice(0, 16)\r\n        const date = created.slice(0, 10)\r\n        const isSystem = content.user == null\r\n        const isFirst = next==undefined || (content.user != next.user || created != next.created.slice(0, 16))\r\n        const isSelf = props.ownerId == content.user\r\n        const dayChanged = next==undefined || date != next.created.slice(0, 10)\r\n        const message = content.message_set[0]\r\n        const openModal = ()=>setModal(MessageModal, {id:content.id, content:message.content})\r\n        if (isSystem)\r\n          return <View key={content.id} style={{flexDirection:'row', justifyContent:'center', width:'100%', marginVertical:5}}>\r\n            <Text>{message.content}</Text>\r\n          </View>\r\n        return <View key={content.id}>\r\n          {dayChanged?<View style={{flexDirection:'row', justifyContent:'center', width:'100%'}}><Text>{date}</Text></View>:undefined}\r\n          <View key={content.id} style={{flexDirection:'row', justifyContent:isSelf?'space-between':'flex-start', width:'100%'}}>\r\n            {isFirst && !isSelf? <View style={{marginTop:3, marginLeft:12}}><Avatar name={content.name} userId={content.user} size={36}/></View>:<View style={{width:48}}/>}\r\n            <CommonSection outerContainerStyle={{width:undefined, maxWidth:'90%'}} title={isFirst?content.name:undefined} titleStyle={{flex:undefined}} bodyStyle={{padding:10}} subtitle={`${created.slice(11)}`}>\r\n              <TouchableOpacity onLongPress={openModal}>\r\n                {content.timer && <View style={{flexDirection:'row', alignItems:'stretch'}}>\r\n                  <Text style={{fontSize:12}}>⌚</Text>\r\n                  <Text style={{fontSize:12}} selectable={!isMobile}>{timerToString(content.timer)}</Text>\r\n                </View>}\r\n                <View style={{width:\"100%\"}}>\r\n                  {/* @ts-ignore */}\r\n                  <Hyperlink linkDefault={ true } style={{wordBreak:\"break-word\"}} linkStyle={{color: '#12b886'}}>\r\n                    <Text selectable={!isMobile} style={{textAlign:isSelf?'right':'left'}}>{message.content}</Text>\r\n                  </Hyperlink>\r\n                </View>\r\n              {content.file_set.map((file, fileIndex)=><FilePreview key={fileIndex} file={file} isMobile={isMobile} showBorder={content.file_set.length>1 || message.content.length>0}/>)}\r\n              {content.link_set.map((link, linkIndex)=><LinkPreview key={linkIndex} link={link} isMobile={isMobile}/>)}\r\n              </TouchableOpacity>        \r\n            </CommonSection>\r\n          </View>\r\n        </View>\r\n      })}\r\n    </View>\r\n\r\n})\r\n\r\nexport default function ChatScreen({navigation, route}: StackScreenProps<any, 'Chat'>) {\r\n  const { lang, locale } = useLangContext()\r\n  const isMobile = useIsMobile()\r\n  const channel_id = route?.params?.id\r\n  const height = useRef(0)\r\n  const inputRef = useRef<TextInput>(null)\r\n  const {auth} = useAuthContext()\r\n  const { setModal } = useModalsContext()\r\n  const channel = useMessengerChannelList(auth)?.find(v=>v.id==parseInt(channel_id))\r\n  const channelAvatar = channel?avatarFromChannel(channel, auth.user):undefined\r\n  const {data, fetchNextPage } = useMessengerContentList(channel_id)\r\n  const memberList = useMessengerMemberList(channel_id)\r\n  const member_id = useMemo(()=>memberList?.find(v=>v.user == auth.user?.id)?.id, [auth, memberList])\r\n  const windowType = useResizeContext()\r\n  const [value, setValue] = useState('')\r\n  const [timer, setTimer] = useState<string>()\r\n  const [autoFocus, setAutoFocus] = useState<boolean|null>(null)\r\n  const [videoMode, setVideoMode] = useState<boolean>(false)\r\n  const [bottomTab, setBottomTab] = useState<boolean>(false)\r\n\r\n  const theme = useColorScheme()\r\n  const postValue = ()=>{\r\n    if (value.length>0){\r\n      contentMutation.create({channel:channel_id, user:auth.user?.id, content:value, timer})\r\n      setValue('')\r\n      setTimer(undefined)\r\n      setBottomTab(false)\r\n      setAutoFocus(true)\r\n    }\r\n  }\r\n  const contentMutation = useMessengerContentMutation()\r\n\r\n  useLayoutEffect(() => {\r\n    navigation.setOptions({\r\n      headerRight: ()=> <HeaderRight extra={[\r\n        {title:lang('invite'), onPress:()=>setModal(InviteModal, {id:channel_id})},\r\n        {title:lang('setting'), onPress:()=>setModal(ChannelEditModal, {id:channel_id, type:'messenger', member_id})}\r\n      ]}/>,\r\n      title: channelAvatar?.name\r\n    });\r\n  }, [navigation, route, member_id, locale]);\r\n\r\n  const renderItem = useCallback(({item, index}:{item:MessengerContentPage, index:number})=><MessengerContentPageItem {...item} ownerId={auth.user?.id}/>, [auth])\r\n  \r\n  const back = ()=>{\r\n    if(navigation.canGoBack())\r\n        navigation.goBack()\r\n      else{\r\n        navigation.navigate('HomeScreen', {tab:2})\r\n      }\r\n  }\r\n  useEffect(()=>{\r\n    setModal(null, null)\r\n    if (!channel_id)\r\n      back()\r\n  }, [route])\r\n  useEffect(()=>{\r\n    if (memberList===null || (memberList!=undefined && memberList.find(v=>v.user==auth.user?.id)==undefined))\r\n      back()\r\n  }, [memberList])\r\n  useEffect(()=>{\r\n    if(autoFocus){\r\n      (inputRef.current as any).focus()\r\n      setAutoFocus(false)\r\n    }\r\n  }, [autoFocus])\r\n  useEffect(()=>{\r\n    if (autoFocus==null && !isMobile){\r\n      const timeout = setTimeout(()=>setAutoFocus(true), 500)\r\n      return ()=>clearTimeout(timeout)\r\n    }\r\n  })\r\n  return <View style={[\r\n    {flex:1, alignItems:'center'},\r\n    windowType=='landscape'?{flexDirection:'row-reverse', minWidth:480}:{flexDirection:'column'}\r\n  ]}>\r\n    <VideoCallSection channel_id={channel_id} setDisable={(d)=>setVideoMode(!d)} disable={!videoMode}/>\r\n    <View style={[{flex:videoMode?undefined:1, flexShrink:1}, windowType=='landscape'?{minWidth:320, height:'100%'}:{width:'100%'}]}>\r\n      <FlatList\r\n        style={{flexDirection: 'column-reverse'}}\r\n        contentContainerStyle={{padding:10, flexGrow:1, flexDirection: 'column-reverse'}}\r\n        data={data?.pages}\r\n        renderItem={renderItem}\r\n        onScroll={(e)=>{\r\n          if (e.nativeEvent.contentOffset.y + e.nativeEvent.contentSize.height - height.current < 1)\r\n            fetchNextPage()\r\n        }}\r\n        onLayout={(p)=>{height.current = p.nativeEvent.layout.height}}\r\n      />\r\n      <View style={{position:'absolute'}}>\r\n        <TimerTags channel_id={channel_id}/>\r\n      </View>\r\n      <ThemedView style={{bottom:0, width:'100%', paddingTop:15, paddingBottom:10, paddingHorizontal:19}}>\r\n        <View style={{alignItems:'center', width:'100%',flexDirection:'row'}}>\r\n          <CommonButton title={''} style={{height:40, paddingTop:8, borderTopRightRadius:0, borderBottomRightRadius:0}} onPress={()=>setBottomTab(!bottomTab)}>\r\n            <View style={{top:-2}}>\r\n              <Entypo name={bottomTab?\"cross\":\"plus\"} size={24} color={Colors[theme].text}/>\r\n            </View>\r\n          </CommonButton>\r\n          {timer && <CommonButton style={{height:40, paddingTop:8, borderRadius:0}} title={`⌚${timerFormat(timer)}`} onPress={()=>{setModal(DateTimePickerModal, {datetime:timer, callback:(datetime:string)=>setTimer(datetime)});setBottomTab(false)}}/>}\r\n          <TextInput ref={inputRef} value={value} onChangeText={setValue} style={{\r\n            flex:1, borderWidth:1, height:40, borderColor:Colors.borderColor, backgroundColor:Colors[theme].background, color:Colors[theme].text\r\n          }} onSubmitEditing={postValue} blurOnSubmit={true} onFocus={()=>setBottomTab(false)}/>\r\n          <CommonButton style={{height:40, paddingTop:8, borderTopLeftRadius:0, borderBottomLeftRadius:0}} title={'💬'} onPress={postValue}/>\r\n        </View>\r\n\r\n        {bottomTab && <View style={{alignItems:'center', width:'100%', flexDirection:'row', paddingTop:15, paddingBottom:5}}>\r\n          <CommonButton style={{height:80, flex:1, justifyContent:'center', marginRight:15}} title={`📤\\n ${lang('Upload File')}`} onPress={()=>uploadFile().then(f=>{contentMutation.create({channel:channel_id, user:auth.user?.id, content:'', file:f});setBottomTab(false)})}/>\r\n          <CommonButton style={{height:80, flex:1, justifyContent:'center', marginRight:15}} title={`⌚\\n ${lang('Timer Message')}`} onPress={()=>{setModal(DateTimePickerModal, {datetime:timer, callback:(datetime:string)=>setTimer(datetime)});setBottomTab(false)}}/>\r\n          <CommonButton style={{height:80, flex:1, justifyContent:'center'}} title={`📹\\n ${lang('Video Call')}`} onPress={()=>{setVideoMode(!videoMode);setBottomTab(false)}} disabled={videoMode}/>\r\n        </View>}\r\n      </ThemedView>\r\n    </View>\r\n  </View>\r\n}","import React from \"react\"\r\nimport CommonSection from \"../../../components/CommonSection\"\r\nimport Colors from \"../../../constants/Colors\"\r\nimport useColorScheme, { setColorScheme } from \"../../../hooks/useColorScheme\"\r\nimport { StyleSheet, Text, View} from 'react-native';\r\nimport useLangContext from \"../../../hooks/useLangContext\";\r\nimport { useColorScheme as useConfigColorScheme} from 'react-native-appearance';\r\nimport useAuthContext from \"../../../hooks/useAuthContext\";\r\nimport useFirebaseContext from \"../../../hooks/useFirebaseContext\";\r\nimport TextButton from \"../../../components/TextButton\";\r\n\r\n\r\nconst ConfigSection = ({title, children}:{title:string, children?: React.ReactNode})=>{\r\n  const theme = useColorScheme()\r\n  const color = Colors[theme].text\r\n  return <CommonSection bodyStyle={{alignItems:'flex-start', backgroundColor:theme=='light'?'transparent':\"black\"}}>\r\n    <Text style={{fontSize:20, color, fontWeight:'600'}}>{title}</Text>\r\n    {children}\r\n  </CommonSection>\r\n}\r\n\r\nexport default ()=>{\r\n  const { lang, locale, setLocale } = useLangContext()\r\n  const theme = useColorScheme()\r\n  const configTheme = useConfigColorScheme()\r\n  const { auth } = useAuthContext()\r\n  const {enable:noti, setEnable:setNoti} = useFirebaseContext(auth)\r\n  const color = Colors[theme].text\r\n  return <>\r\n    <ConfigSection title={lang('* Notification Settings')}>\r\n      <View style={{flexDirection:'row'}}>\r\n        {[[lang('On'), true], [lang('Off'), false]].map(([title, n])=><TextButton\r\n          key={title} title={title || ''} textStyle={{fontSize:16, color, textDecorationLine:noti==n?'underline':'none'}} style={{borderRadius:20}} onPress={()=>{setNoti(n)}}/>)}\r\n      </View>\r\n    </ConfigSection>\r\n    <ConfigSection title={lang('* Language Settings')}>\r\n    <View style={{flexDirection:'row'}}>\r\n        {[[lang('Auto'), 'auto'], ['한국어', 'ko'], ['English', 'en']].map(([title, l])=><TextButton \r\n          key={title} title={title || ''} textStyle={{fontSize:16, color, textDecorationLine:locale==l?'underline':'none'}} style={{borderRadius:20}} onPress={()=>setLocale(l)}/>)}\r\n      </View>\r\n    </ConfigSection>\r\n    <ConfigSection title={lang('* Skin Settings')}>\r\n      <View style={{flexDirection:'row'}}>\r\n        {[[lang('Auto'), 'no-preference'], [lang('Light'), 'light'], [lang('Dark'), 'dark']].map(([title, colorScheme])=><TextButton \r\n          key={title} title={title} textStyle={{fontSize:16, color, textDecorationLine:configTheme==colorScheme?'underline':'none'}} style={{borderRadius:20}} onPress={(\r\n            )=>setColorScheme(colorScheme)}/>)}\r\n      </View>\r\n    </ConfigSection>\r\n  </>\r\n}","import React, {useState, useEffect, useLayoutEffect, useMemo} from 'react';\r\nimport { StackScreenProps } from '@react-navigation/stack';\r\nimport { StyleSheet, View} from 'react-native';\r\nimport { Text as StyledText } from 'react-native-paper';\r\nimport { Text } from '../../../components/Themed'\r\nimport useResizeContext from '../../../hooks/useResizeContext';\r\nimport TabView from '../../../components/TabView';\r\nimport HeaderRight from '../../../components/HeaderRight';\r\nimport TextButton from '../../../components/TextButton';\r\nimport Colors from '../../../constants/Colors';\r\nimport useColorScheme  from '../../../hooks/useColorScheme';\r\nimport useModalsContext from '../../../hooks/useModalsContext';\r\nimport ChannelEditModal from '../../../modals/ChannelEditModal';\r\nimport useLangContext from '../../../hooks/useLangContext';\r\nimport ContractFooter from '../../../components/ContractFooter';\r\nimport { TabViewRecord } from '../../../types';\r\nimport useAuthContext from '../../../hooks/useAuthContext';\r\nimport useUserMembershipList from '../../../hooks/lists/useUserMembershipList';\r\nimport { FontAwesome, Ionicons, MaterialCommunityIcons, SimpleLineIcons } from '@expo/vector-icons';\r\nimport { useMessengerChannelSorted } from '../../../hooks/lists/useMessengerChannelList';\r\nimport { ScrollView } from 'react-native-gesture-handler';\r\nimport CommonItem from '../../../components/CommonItem';\r\nimport MemberItem from '../../../components/MemberItem';\r\nimport ProfileModal from '../../../modals/ProfileModal';\r\nimport { navigate } from '../../../navigation';\r\nimport CommonSection from '../../../components/CommonSection';\r\nimport ConfigSections from './ConfigSections';\r\nimport Avatar, { avatarFromChannel } from '../../../components/Avatar';\r\n\r\nconst MemberTabView = ()=>{\r\n  const {auth} = useAuthContext()\r\n  const theme = useColorScheme()\r\n  const { setModal } = useModalsContext()\r\n  const userList = useUserMembershipList(auth)\r\n  const memberItem = React.useMemo(\r\n      ()=>userList && userList.map((item, index)=><MemberItem key={index} member={item} onPress={()=>setModal(ProfileModal, {id:item.id})}/>), [userList])\r\n  return <ScrollView style={{flex:1, backgroundColor:Colors[theme].background}}>\r\n      {memberItem}\r\n  </ScrollView>\r\n}\r\n\r\nconst MessengerTabView = ()=>{\r\n  const {auth} = useAuthContext()\r\n  const channelList = useMessengerChannelSorted(auth)\r\n  const theme = useColorScheme()\r\n\r\n  const today = (new Date()).toISOString().slice(0, 10)\r\n  return <ScrollView style={{flex:1, backgroundColor:Colors[theme].background}}>\r\n      {channelList?.map((item, index)=>{\r\n          const {avatar, name} = avatarFromChannel(item, auth.user)\r\n          const date = item.last_message?.created.slice(0,10)\r\n          return <CommonItem key={index} bodyStyle={{flexDirection:'row', justifyContent:'space-between'}} onPress={()=>navigate(\"ChatScreen\", {id:item.id})}>\r\n              <View style={{flexDirection:'row'}}>\r\n                  {avatar?\r\n                    <View style={{ marginRight:20}}>\r\n                      <Avatar name={avatar.name} size={44} userId={avatar.id}/>\r\n                    </View>:\r\n                    <FontAwesome size={40} color={Colors[theme].iconColor} style={{ marginBottom: -3, marginRight:20 }} name='users'/>}\r\n                  <View>\r\n                      <View style={{flexDirection:'row'}}>\r\n                          <Text style={{fontSize:18}}>{name}</Text>\r\n                          <Text style={{fontSize:18, opacity: 0.4, paddingLeft:5}}>{item.member_count}</Text>\r\n                      </View>\r\n                      <Text style={{fontSize:16, opacity: 0.4}}>{item.last_message?.content}</Text>\r\n                  </View>\r\n              </View>\r\n              <View>\r\n                  <Text style={{fontSize:14, opacity: 0.4, textAlign:'right'}}>{date==today?item.last_message?.created.slice(11,16):date}</Text>\r\n                  <Text style={{fontSize:14, textAlign:'right'}}>{item.unread_count?item.unread_count:' '}</Text>\r\n              </View>\r\n          </CommonItem>\r\n      })}\r\n  </ScrollView>\r\n}\r\n\r\n\r\nconst ConfigTabView = ()=>{\r\n  const theme = useColorScheme()\r\n  return <View style={{flex:1, backgroundColor:Colors[theme].background}}>\r\n    <ConfigSections/>\r\n  </View>\r\n}\r\n\r\nconst getBottomTabs = (theme:'light'|'dark')=>{\r\n  const color = Colors[theme].iconColor\r\n  return {\r\n    OneTab:{\r\n        title:'member',\r\n        component:MemberTabView,\r\n        icon:<MaterialCommunityIcons size={32} color={color} style={{ marginBottom: -3 }} name='account'/>,\r\n    },\r\n    TwoTab:{\r\n        title:'chat',\r\n        component:MessengerTabView,\r\n        icon:<Ionicons size={30} color={color} style={{ marginBottom: -3 }} name='chatbox'/>\r\n    },\r\n    // ThreeTab:{\r\n    //     title:'board',\r\n    //     component:()=><></>,\r\n    //     icon:<></>\r\n    // },\r\n    FourTab:{\r\n        title:'config',\r\n        component:ConfigTabView,\r\n        icon:<SimpleLineIcons size={30} color={color} style={{ marginBottom: -3 }} name='options'/>\r\n    }\r\n  } as TabViewRecord\r\n}\r\n\r\n\r\nexport default function HomeScreen({navigation, route}: StackScreenProps<any, 'Home'>) {\r\n  const { lang, locale } = useLangContext()\r\n  const windowType = useResizeContext();\r\n  const theme = useColorScheme()\r\n  const { setModal } = useModalsContext()\r\n  const [ home, setHome ] = useState(windowType == 'landscape')\r\n  const color = Colors[theme].text\r\n  const options = [\r\n    {title:lang('member'), headerRight:()=><HeaderRight/>},\r\n    {title:lang('chat'), headerRight:()=><HeaderRight extra={[{title:lang('create'), onPress:()=>setModal(ChannelEditModal, {type:'messenger'})}]}/>},\r\n    // {title:'board', headerRight:()=><HeaderRight extra={[{title:'create', onPress:()=>setModal(ChannelEditModal, props:{type:'board'}}) }]}/>},\r\n    {title:lang('config'), headerRight:()=><HeaderRight/>}\r\n  ]\r\n  \r\n  useLayoutEffect(() => {\r\n    const index = route?.params?.tab | 0\r\n    navigation.setOptions(windowType == 'portrait'?options[index]:{\r\n      title: lang('home'),\r\n      headerRight: ()=><HeaderRight/>\r\n    });\r\n  }, [navigation, route, windowType, locale]);\r\n  useEffect(()=>{\r\n    setHome(windowType == 'landscape')\r\n  }, [windowType])\r\n  return home?\r\n    <View style={{flex:1, justifyContent:'center', alignItems:'center'}}>\r\n      <View style={{width:'80%', flex:1, marginTop:72}}>\r\n        <StyledText style={{fontSize:32, color}}>Tokki Tok</StyledText>\r\n        <View style={{backgroundColor:Colors.borderColor, height:1, width:'100%'}}/>\r\n        {/* <Text style={{fontSize:20, color:'gray'}}>Welcome! This is a messenger for teams.</Text>*/}\r\n        <View style={{height:24}}/>\r\n        <CommonSection bodyStyle={{alignItems:'flex-start', backgroundColor:'transparent'}}>\r\n          <TextButton title={lang('+ New chat')} textStyle={{fontSize:20, color}} style={{paddingLeft:0, borderRadius:20}} onPress={()=>setModal(ChannelEditModal, {type:'messenger'})}/>\r\n        </CommonSection>\r\n        <ConfigSections/>\r\n      </View>\r\n      <ContractFooter/>\r\n    </View>:\r\n    <TabView tabs={getBottomTabs(theme)} tabBarPosition=\"bottom\" index={parseInt(route.params?.['tab'] || 0)} onTab={(index)=>{navigation.setParams({tab:index})}}/>\r\n}\r\n\r\n","import React, {useEffect, useLayoutEffect, useState} from 'react';\r\n\r\nimport { StackScreenProps } from '@react-navigation/stack';\r\nimport useAuthContext from '../../hooks/useAuthContext';\r\nimport useMessengerChannelList from '../../hooks/lists/useMessengerChannelList';\r\nimport { Text } from '../../components/Themed';\r\nimport { useMessengerMemberMutation } from '../../hooks/lists/useMessengerMemberList';\r\n\r\nexport default function InviteeScreen({navigation, route}: StackScreenProps<any, 'Invitee'>) {\r\n    const id = route?.params?.id\r\n    const {auth, dispatch} = useAuthContext()\r\n    const [enterGuest, setEnterGuest] = useState(false)\r\n    const channelList = useMessengerChannelList(auth)\r\n    const messengerMemberMutation = useMessengerMemberMutation()\r\n    useLayoutEffect(() => {\r\n        navigation.setOptions({headerRight: undefined});\r\n    }, []);\r\n    useEffect(()=>{\r\n        if(auth.user==null && enterGuest==false){\r\n            dispatch({type:\"LOGIN_GUEST\"})\r\n            setEnterGuest(true)\r\n        }\r\n        else if(auth.user && channelList!==undefined){\r\n            if(channelList.find(v=>v.id==id) === undefined){\r\n                console.log(`invite processing (channel:${id})`)\r\n                messengerMemberMutation.invite({\r\n                    channel_id:id,\r\n                    user_ids:[auth.user.id]\r\n                }).then(()=>navigation.replace(\"ChatScreen\", {id}))\r\n            }\r\n            else{\r\n                console.log('already invite')\r\n                navigation.replace(\"ChatScreen\", {id})\r\n            }\r\n        }\r\n    }, [auth, channelList, enterGuest])\r\n  return <Text>{'초대중'}</Text>\r\n};\r\n","import LoginScreen from \"./main/LoginScreen\";\r\nimport ChatScreen from \"./main/ChatScreen\";\r\nimport HomeScreen from \"./main/HomeScreen\";\r\nimport TabOneScreen from \"./main/TabOneScreen\";\r\nimport InviteeScreen from \"./main/InviteeScreen\";\r\n// import BoardScreen from \"../lib/blacktokki-board/BoardScreen\";\r\n// import BoardEditScreen from \"../lib/blacktokki-board/BoardEditScreen\";\r\nimport { Screens } from \"../types\";\r\n\r\nexport const main = {\r\n    HomeScreen:{\r\n        title:'home',\r\n        component:HomeScreen,\r\n        path:'home',\r\n    },\r\n    ChatScreen:{\r\n        title:'chat',\r\n        component:ChatScreen,\r\n        path:'chat'\r\n    },\r\n    // BoardScreen:{\r\n    //     title:'board',\r\n    //     component:BoardScreen,\r\n    //     path:'board'\r\n    // },\r\n    // TabOneScreen:{\r\n    //     title:'tab one',\r\n    //     component:TabOneScreen,\r\n    //     path:'one'\r\n    // },\r\n    InviteeScreen:{\r\n        title: '',        \r\n        component:InviteeScreen,\r\n        path:'invitee'\r\n    }\r\n} as Screens\r\n\r\nexport const login = {\r\n    LoginScreen:{\r\n        path: 'login',\r\n        title: 'Sign in',\r\n        component:LoginScreen\r\n    },\r\n    InviteeScreen:{\r\n        path:'invitee',\r\n        title: '',\r\n        component:InviteeScreen\r\n    }\r\n} as Screens\r\n\r\nexport const modal = {\r\n    // BoardEditScreen:{\r\n    //     title:'board',\r\n    //     component:BoardEditScreen,\r\n    //     path:'modal/board'\r\n    // },\r\n} as Screens","import { useMemo, useReducer } from \"react\"\r\n\r\ntype LocalSearchAction = {type:string, keyword?:string}\r\n\r\ntype LocalSearchState ={active:boolean, keyword:string}\r\n\r\n\r\n\r\nconst localSearchReducer =(initialState:LocalSearchState, action:LocalSearchAction)=>{\r\n    switch (action.type){\r\n        case 'SEARCH':\r\n          return {\r\n            ...initialState,\r\n            keyword: action.keyword\r\n          } as LocalSearchState\r\n        case 'ENABLE_SEARCH':\r\n          return {\r\n            ...initialState,\r\n            active:true,\r\n          }\r\n        case 'DISABLE_SEARCH':\r\n            return{\r\n                ...initialState,\r\n                active:false,\r\n                keyword: ''\r\n            }\r\n        default:\r\n            throw new Error( `Unhandled action type: ${action.type}`)\r\n    }\r\n  }\r\n\r\n\r\nexport default function useLocalSearch<T>(target:T[], compare:(value:T, keyword:string)=>boolean) {\r\n  const [searchState, dispatch] = useReducer(localSearchReducer, {active:false, keyword:''})\r\n  const data = useMemo(()=>searchState.active?target.filter(v=>compare(v, searchState.keyword)):target, [searchState, target])\r\n  return {searchState, dispatch, data}\r\n}","import React, {useRef,MutableRefObject, useMemo, useState, useEffect } from 'react';\r\nimport Clipboard from '@react-native-clipboard/clipboard/dist';\r\nimport { View, Text } from '../components/Themed';\r\nimport useAuthContext from '../hooks/useAuthContext';\r\nimport useUserMembershipList from '../hooks/lists/useUserMembershipList';\r\nimport { TabViewRecord, UserMembership } from '../types';\r\nimport CommonButton from '../components/CommonButton';\r\nimport useMessengerMemberList, { useMessengerMemberMutation } from '../hooks/lists/useMessengerMemberList';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport useExternalMembershipList from '../hooks/lists/useExternalMembershipList';\r\nimport TextField from '../components/TextField';\r\nimport useLocalSearch from '../hooks/useLocalSearch';\r\nimport TabView from '../components/TabView';\r\nimport { FlatList, TouchableOpacity } from 'react-native-gesture-handler';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport MemberItem from '../components/MemberItem';\r\nimport ModalSection from '../components/ModalSection';\r\n\r\nconst InviteItem = (props:{item:UserMembership, selectedRef:MutableRefObject<Set<number>>})=>{\r\n  const [selected, setSelected] = useState(props.selectedRef.current.has(props.item.id))\r\n  return <View style={selected?{borderWidth:1, borderColor:'blue'}:{}}>\r\n    <MemberItem member={props.item} onPress={()=>{\r\n      if (selected){\r\n        setSelected(false)\r\n        props.selectedRef.current.delete(props.item.id)\r\n      }\r\n      else{\r\n        setSelected(true)\r\n        props.selectedRef.current.add(props.item.id)\r\n      }\r\n    }}/>\r\n  </View>\r\n\r\n}\r\ntype InviteTabViewProps = {\r\n  id:number,\r\n  selectedRef:MutableRefObject<Set<number>>\r\n}\r\n\r\nconst GroupTabView = ({id, selectedRef}:InviteTabViewProps)=>{\r\n  const { lang } = useLangContext()\r\n  const {auth} = useAuthContext()\r\n  const { setModal } = useModalsContext()\r\n  const userList = useUserMembershipList(auth)\r\n  const memberList = useMessengerMemberList(id)\r\n  const messengerMemberMutation = useMessengerMemberMutation()\r\n  const rawData = useMemo(()=>{\r\n    const memberSet = new Set(memberList?.map(v=>v.user))\r\n    return userList?.filter(v=>!memberSet.has(v.id)) || []\r\n  }, [userList, memberList])\r\n  const {data, dispatch:dispatchKeyword, searchState} = useLocalSearch(rawData, (v, keyword)=>(v.username.includes(keyword) || v.name.includes(keyword)))\r\n  const search = (k:string)=>{\r\n    if (k?.length>0){\r\n      dispatchKeyword({type:'ENABLE_SEARCH'})\r\n      dispatchKeyword({type:'SEARCH', keyword:k})\r\n    }\r\n    else{\r\n      dispatchKeyword({type:'DISABLE_SEARCH'})\r\n    }\r\n  }\r\n  const back = ()=>{\r\n    setModal(InviteModal, null)\r\n  }\r\n  return <View style={{alignItems:'center', flex:1}}>\r\n    <View style={{'width': '100%', flex:1}}>\r\n      <TextField name={`${lang('Username')} & ${lang('Name')}`} value={searchState.keyword} setValue={search} width={'80%'}/>\r\n      {id && data && <FlatList contentContainerStyle={{flexGrow:1}} data={data} renderItem={({item})=><InviteItem item={item} selectedRef={selectedRef}/>}/>}\r\n    </View>\r\n    <View style={[{width:'100%', flexDirection:'row', padding:10,}, {justifyContent:'flex-end'}]}>\r\n      <CommonButton title={lang('invite')} onPress={()=>{\r\n        messengerMemberMutation.invite({\r\n          channel_id:id,\r\n          user_ids:[...selectedRef.current]\r\n        }).then(back)\r\n      }}/>\r\n      <CommonButton title={lang('cancel')} onPress={back}/>\r\n    </View>\r\n  </View>\r\n}\r\n\r\nconst DELAY = 500\r\n\r\nconst ExternalMembershipTabView = ({id, selectedRef}:InviteTabViewProps)=>{\r\n  const { lang } = useLangContext()\r\n  const [value, setValue] = useState('')\r\n  const [keyword, setKeyword] = useState('')\r\n  const [copied, setCopied] = useState(false)\r\n  const timeoutRef = useRef<NodeJS.Timeout>()\r\n  const { setModal } = useModalsContext()\r\n  const memberList = useMessengerMemberList(id)\r\n  const externalMemberList = useExternalMembershipList(keyword)\r\n  const data = useMemo(()=>{\r\n    const memberSet = new Set(memberList?.map(v=>v.user))\r\n    return externalMemberList?.filter(v=>!memberSet.has(v.id)) || []\r\n  }, [externalMemberList, memberList])\r\n  const messengerMemberMutation = useMessengerMemberMutation()\r\n  useEffect(()=>{\r\n    timeoutRef.current = setTimeout(()=>{\r\n      setKeyword(value)\r\n    }, DELAY)\r\n    return ()=>{timeoutRef.current && clearTimeout(timeoutRef.current)}\r\n  }, [value])\r\n  const back = ()=>{\r\n    setModal(InviteModal, null)\r\n  }\r\n  const inviteLink = location.href.replace('chat', 'invitee')\r\n  return <View style={{alignItems:'center', flex:1}}>\r\n  <TouchableOpacity style={{paddingVertical:10, flexDirection:\"row\"}} onPress={()=>{Clipboard.setString(inviteLink);setCopied(true)}}>\r\n    <Text style={{fontSize:14}}>{lang('invite link')}{\": \"}</Text>\r\n    <Text style={{fontSize:14, color:'#12b886'}}>{inviteLink}{\" \"}</Text>\r\n    {copied && <Text style={{fontSize:12, color:'red'}}>{lang(\"copied\")}</Text>}\r\n  </TouchableOpacity>\r\n  <View style={{'width': '100%', flex:1}}>\r\n    <TextField name={lang('Username')} value={value} setValue={setValue} width={'80%'}/>\r\n    {id && data && <FlatList contentContainerStyle={{flexGrow:1}} data={data} renderItem={({item})=><InviteItem item={item} selectedRef={selectedRef}/>}/>}\r\n  </View>\r\n  <View style={[{width:'100%', flexDirection:'row', padding:10,}, {justifyContent:'flex-end'}]}>\r\n    <CommonButton title={lang('invite')} onPress={()=>{\r\n      messengerMemberMutation.invite({\r\n        channel_id:id,\r\n        user_ids:[...selectedRef.current]\r\n      }).then(back)\r\n    }}/>\r\n    <CommonButton title={lang('cancel')} onPress={back}/>\r\n  </View>\r\n</View>\r\n}\r\n\r\nexport default function InviteModal({id}:{id:number}) {\r\n  const { lang } = useLangContext()\r\n  const selectedRef = useRef<Set<number>>(new Set())\r\n  const drawerTabs:TabViewRecord = {\r\n    group:{\r\n      title: 'Group',\r\n      component: ()=><GroupTabView id={id} selectedRef={selectedRef}/>,\r\n      icon: <></>\r\n    },\r\n    external:{\r\n      title: 'External members',\r\n      component: ()=><ExternalMembershipTabView id={id} selectedRef={selectedRef}/>,\r\n      icon: <></>\r\n    }\r\n  }\r\n  return <ModalSection>\r\n    <View style={{flex:1, width:'100%'}}>\r\n      <View style={{width:'100%'}}>\r\n        <Text style={{fontSize:20}}>{lang('invite')}</Text>\r\n        <View style={{marginBottom: 20, height: 1, width: '100%'}} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\r\n      </View>\r\n      <TabView tabs={drawerTabs} tabBarPosition={\"top\"}/>\r\n    </View>\r\n  </ModalSection>\r\n}\r\n\r\n","import { useQuery } from \"react-query\";\r\nimport { getExternalMembershipList } from \"../../apis\";\r\n\r\nexport default function useExternalMembershipList(keyword?:string){\r\n  const { data } = useQuery([\"UserMembershipList\", keyword] , async()=>keyword?(await getExternalMembershipList(keyword)):[])\r\n  return data\r\n}","import React, { useMemo } from 'react';\r\n\r\nimport { TextProps, StyleProp } from 'react-native';\r\nimport {View, Text } from './Themed'\r\nimport useResizeContext from '../hooks/useResizeContext';\r\n\r\ntype Props = {\r\n  name: string,\r\n  width?:number,\r\n  children: React.ReactNode\r\n  textStyle?: StyleProp<TextProps>\r\n}\r\n\r\nexport default function RowField(props:Props) {\r\n  const windowType = useResizeContext()\r\n  const rowStyle = useMemo(()=>windowType=='landscape'?\r\n    {flexDirection:'row', alignItems: 'center', justifyContent:'space-between'}:\r\n    {flexDirection:'column', alignItems:'flex-start'} as any\r\n  , [windowType])\r\n  return (\r\n    <View style={[{paddingVertical:5, width:'100%'}, rowStyle]}>\r\n        <Text style={[windowType=='landscape'?{flex:1}:{width:'100%'},{paddingHorizontal: 15, fontSize:16}, props.textStyle]}>{props.name}</Text>\r\n        <View style={[windowType=='landscape'?{flex:6}:{width:'100%'},{paddingHorizontal: 15}]}>\r\n          <View style={{width:props.width}}>\r\n            {props.children}\r\n          </View>\r\n        </View>\r\n    </View>\r\n  )\r\n}","import React from 'react';\r\nimport { StyleProp, TextStyle } from 'react-native';\r\nimport { CustomTextInputProps } from '../types';\r\nimport CommonTextInput from './CommonTextInput';\r\nimport RowField from './RowField';\r\n\r\nexport default function TextField(props:CustomTextInputProps & {name: string, width?:any, textStyle?:StyleProp<TextStyle>}) {\r\n  return (\r\n    <RowField name={props.name} width={props.width} textStyle={props.textStyle}>\r\n      <CommonTextInput {...props} />\r\n   </RowField>\r\n  )\r\n}","/**\r\n * Learn more about deep linking with React Navigation\r\n * https://reactnavigation.org/docs/deep-linking\r\n * https://reactnavigation.org/docs/configuring-links\r\n */\r\n\r\nimport { LinkingOptions } from '@react-navigation/native';\r\nimport * as Linking from 'expo-linking';\r\nimport {main, login, modal} from '../screens';\r\n\r\nconst ROOTPATH = 'tokki-tok'  // github repository name\r\n\r\nObject.values(modal).forEach(v=>v.path = ROOTPATH + '/' + v.path)\r\n\r\nexport default  {\r\n  prefixes: [Linking.makeUrl('/')],\r\n  config: {\r\n    screens: {\r\n      Main: {\r\n        screens:{\r\n          ...main,\r\n          ...login,\r\n          NotFound: '*',\r\n        },\r\n        path: ROOTPATH\r\n      },\r\n      ...modal\r\n    },\r\n  },\r\n} as LinkingOptions;\r\n","firebaseConfig = {\n    \"authDomain\": \"virtual-metrics-355712.firebaseapp.com\",\n    \"projectId\": \"virtual-metrics-355712\",\n    \"storageBucket\": \"virtual-metrics-355712.appspot.com\",\n    \"messagingSenderId\": \"76003576924\",\n    \"appId\": \"1:76003576924:web:c8c8a006d07918bbc02a99\",\n    \"measurementId\": \"G-SEL35L4N5R\"\n}\nif (typeof module !== 'undefined') {\n    module.exports = firebaseConfig\n}\n","import { StackScreenProps } from '@react-navigation/stack';\r\nimport * as React from 'react';\r\nimport { StyleSheet, Text, TouchableOpacity, View } from 'react-native';\r\nimport useLangContext from '../hooks/useLangContext';\r\n\r\nexport default function NotFoundScreen({\r\n  navigation,\r\n}: StackScreenProps<any, 'NotFound'>) {\r\n  const { lang } = useLangContext()\r\n  return (\r\n    <View style={styles.container}>\r\n      <Text style={styles.title}>{lang(\"This screen doesn't exist.\")}</Text>\r\n      <TouchableOpacity onPress={() => navigation.replace('HomeScreen')} style={styles.link}>\r\n        <Text style={styles.linkText}>{lang(\"Go to home screen!\")}</Text>\r\n      </TouchableOpacity>\r\n    </View>\r\n  );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    backgroundColor: '#fff',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    padding: 20,\r\n  },\r\n  title: {\r\n    fontSize: 20,\r\n    fontWeight: 'bold',\r\n  },\r\n  link: {\r\n    marginTop: 15,\r\n    paddingVertical: 15,\r\n  },\r\n  linkText: {\r\n    fontSize: 14,\r\n    color: '#2e78b7',\r\n  },\r\n});\r\n","import { useTheme } from '@react-navigation/native';\r\nimport React, { useState } from 'react';\r\nimport { View, StyleSheet } from 'react-native';\r\nimport Profile from '../components/Profile';\r\nimport TextButton from '../components/TextButton';\r\nimport Colors from '../constants/Colors';\r\nimport useResizeContext from '../hooks/useResizeContext';\r\nimport TabView from '../components/TabView';\r\nimport { MessengerChannel, TabViewRecord, User, UserMembership } from '../types';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport ChannelEditModal from '../modals/ChannelEditModal';\r\nimport CommonItem from '../components/CommonItem';\r\nimport { Text } from '../components/Themed';\r\nimport useAuthContext, { Auth } from '../hooks/useAuthContext';\r\nimport { useMessengerChannelSorted } from '../hooks/lists/useMessengerChannelList';\r\nimport { navigate } from '.'\r\nimport { avatarFromChannel } from '../components/Avatar';\r\n\r\nconst DrawerTabView = (props:{auth:Auth, data:(MessengerChannel & {onPress?:()=>void})[]})=><View style={{flex:1}}>\r\n    {props.data.map((item, index)=>{\r\n      const {name} = avatarFromChannel(item, props.auth.user)\r\n      return <CommonItem key={index} containerStyle={{marginHorizontal:0}} bodyStyle={{alignItems:'flex-start'}} onPress={item.onPress}>\r\n        <Text style={{marginLeft:20}}>{name}</Text>\r\n      </CommonItem>\r\n    })}\r\n</View>\r\n\r\nconst MessengerTabView = ()=>{\r\n  const {auth} = useAuthContext()\r\n  const channelList = useMessengerChannelSorted(auth);\r\n  return <DrawerTabView auth={auth} data={(channelList || []).map(item=>({...item, onPress:()=>navigate(\"ChatScreen\", {id:item.id})}))}/>\r\n}\r\n\r\nconst drawerTabs:TabViewRecord = {\r\n  MessengerTab:{\r\n      title:'messenger',\r\n      component:MessengerTabView,\r\n      icon:<></>\r\n  },\r\n}\r\n\r\nexport default ({user}:{user:UserMembership})=> {\r\n  const { colors } = useTheme();\r\n  const windowType = useResizeContext();\r\n  const [index, setIndex] = useState(0);\r\n  const { setModal } = useModalsContext()\r\n  const onAddList = [\r\n    ()=>setModal(ChannelEditModal, {type:'messenger'}),\r\n    ()=>setModal(ChannelEditModal, {type:'board'})\r\n  ]\r\n  return <View style={windowType=='landscape'?[\r\n      styles.tabBar,\r\n      {\r\n        backgroundColor: colors.card,\r\n        borderTopColor: colors.border,\r\n      },\r\n      // tabBarStyle,\r\n    ]:{width:0}}\r\n    pointerEvents={false ? 'none' : 'auto'}\r\n  >\r\n    <Profile userId={user.id} username={user.username} name={user.name}/>\r\n    {windowType=='landscape' && <>\r\n      <View style={{flexDirection:'row-reverse'}}>\r\n          <TextButton title='+' textStyle={{fontSize:20}} style={{borderRadius:20}} onPress={onAddList[index]}/>\r\n      </View>\r\n      <View accessibilityRole=\"tablist\" style={styles.content}>\r\n        {Object.keys(drawerTabs).length>1 ? \r\n          <TabView tabs={drawerTabs} tabBarPosition={\"top\"} onTab={setIndex}/>: \r\n          <View style={{borderTopWidth:1, flex:1, borderColor:colors.border}}>            \r\n            {Object.values(drawerTabs).map(drawerTab=>{const Tab = drawerTab.component; return <Tab key={drawerTab.title}/>})}\r\n          </View>\r\n        }\r\n      </View>\r\n    </>}\r\n  </View>\r\n}\r\n\r\n{/*<Text style={[styles.label, { color: d.isFocused ? colors.primary : '#222' }]}></Text> */}\r\n\r\nconst styles = StyleSheet.create({\r\n    tabBar: {\r\n      width:240,\r\n      elevation: 8,\r\n      borderRightWidth:1,\r\n      borderColor:Colors.borderColor\r\n    },\r\n    content: {\r\n      flex: 1,\r\n      flexDirection: 'row',\r\n    },\r\n    tab: {\r\n        flex: 1,\r\n        alignItems: 'center',\r\n    },\r\n    label: {\r\n        textAlign: 'center',\r\n        backgroundColor: 'transparent',\r\n      },\r\n  });","import InviteModal from \"./InviteModal\";\r\nimport ProfileModal from \"./ProfileModal\";\r\nimport ChannelEditModal from \"./ChannelEditModal\"\r\nimport GuestLogoutModal from \"./GuestLogoutModal\";\r\nimport DateTimePickerModal from \"./DateTimePickerModal\"\r\nimport MessageModal from \"./MessageModal\";\r\n\r\nexport default [\r\n    InviteModal,\r\n    ProfileModal,\r\n    ChannelEditModal,\r\n    GuestLogoutModal,\r\n    DateTimePickerModal,\r\n    MessageModal\r\n]","import { CardStyleInterpolators, createStackNavigator } from '@react-navigation/stack';\r\nimport React, {useMemo} from 'react';\r\nimport { View } from 'react-native';\r\nimport { Ionicons } from '@expo/vector-icons';\r\nimport useResizeContext from '../hooks/useResizeContext';\r\nimport NotFoundScreen from '../screens/NotFoundScreen';\r\nimport {main, login, modal} from '../screens';\r\nimport DrawerNavigator from './DrawerNavigator';\r\nimport useAuthContext from '../hooks/useAuthContext';\r\nimport { WebSocketProvider } from '../hooks/useWebsocketContext';\r\nimport HeaderRight from '../components/HeaderRight'\r\nimport Colors from '../constants/Colors';\r\nimport { TouchableOpacity } from 'react-native-gesture-handler';\r\nimport useFirebaseContext from '../hooks/useFirebaseContext';\r\nimport useIsMobile from '../hooks/useIsMobile';\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport { ModalsProvider } from '../hooks/useModalsContext';\r\nimport modals from '../modals';\r\nimport useLangContext from '../hooks/useLangContext';\r\n\r\nconst Root = createStackNavigator();\r\n\r\nexport default function RootNavigator() {\r\n    const windowType = useResizeContext();\r\n    return <Root.Navigator\r\n        mode= 'modal'\r\n        headerMode= 'screen'\r\n        screenOptions={{\r\n            cardStyle:{backgroundColor:\"white\"},\r\n            animationEnabled: true,\r\n            cardStyleInterpolator: CardStyleInterpolators.forVerticalIOS,\r\n        }}\r\n    >\r\n        <Root.Screen name=\"Main\" component={MainNavigator} options={{headerShown:false}}/>\r\n        {Object.entries(modal).map(([key, screen])=><Root.Screen key={key} name={key} component={screen.component} options={{\r\n            title: screen.title,\r\n            gestureDirection: windowType == 'landscape'?'vertical-inverted':'vertical'\r\n        }} />)}\r\n    </Root.Navigator>\r\n}\r\n\r\nconst Main = createStackNavigator();\r\n\r\nfunction headerLeft(navigation:any, route:any, windowType:string, isMobile:boolean){\r\n    const canGOBackScreen = ['HomeScreen', 'LoginScreen'].findIndex(v=>v == route.name) == -1\r\n    const goBack = ()=>{\r\n        if (navigation.canGoBack())\r\n            navigation.goBack()\r\n        else if (canGOBackScreen)\r\n            navigation.replace('HomeScreen')\r\n    }\r\n    if (windowType=='portrait' && canGOBackScreen)\r\n        return <TouchableOpacity onPress={goBack}><Ionicons size={isMobile?20:24} style={{marginHorizontal:isMobile?16:20 }} name=\"arrow-back\"/></TouchableOpacity>\r\n    return null\r\n}\r\n\r\nconst MainNavigator = ()=>{\r\n    const windowType = useResizeContext();\r\n    const isMobile = useIsMobile()\r\n    const {auth} = useAuthContext()\r\n    const theme = useColorScheme()\r\n    const {lang, locale} = useLangContext()\r\n    const entries = useMemo(()=>{\r\n        if (auth.user === undefined)\r\n            return []\r\n        console.log('current user: ', auth.user)\r\n        return Object.entries(auth.user === null?login:main)\r\n    }, [auth, locale])\r\n    const modalValues = useMemo(()=>{\r\n        if (auth.user === undefined)\r\n            return []\r\n        return auth.user === null?[]:modals\r\n    }, [auth])\r\n\r\n    const {enable:noti} = useFirebaseContext(auth)\r\n    const headerLeftColor = 'white'\r\n    return (auth.user!==undefined && noti!=null?<View style={{flexDirection:'row', flex:1}}>\r\n        <ModalsProvider modals={modalValues}>\r\n            {auth.user?<DrawerNavigator user={auth.user}/>:undefined}\r\n            <View style={{flex:1}}>\r\n                <WebSocketProvider disable={auth.user === null || auth.user === undefined}>\r\n                        <Main.Navigator\r\n                            screenOptions={({navigation, route})=>({\r\n                                headerStyle:{backgroundColor:Colors[theme].header, height:isMobile?50:undefined},\r\n                                headerTitleStyle:{color:'white'},\r\n                                headerLeft:()=>headerLeft(navigation, route, windowType, isMobile),\r\n                                headerRight:()=><HeaderRight/>,\r\n                                headerLeftContainerStyle:{backgroundColor:headerLeftColor, borderBottomWidth:1, borderColor:headerLeftColor},\r\n                                cardStyle:{flexShrink:1},\r\n                                animationEnabled:windowType=='portrait',\r\n                                cardStyleInterpolator: CardStyleInterpolators.forHorizontalIOS\r\n                            })}\r\n                        >\r\n                            {entries.map(([key, screen])=><Main.Screen key={key} name={key} component={screen.component} options={{ title: lang(screen.title) }} />)}\r\n                            <Main.Screen name=\"NotFound\" component={NotFoundScreen} options={{ title: 'Oops!' }} />\r\n                        </Main.Navigator>\r\n                </WebSocketProvider>\r\n            </View>\r\n        </ModalsProvider>\r\n    </View>:<></>);\r\n}"],"sourceRoot":""}