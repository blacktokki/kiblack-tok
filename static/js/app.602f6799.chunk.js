(this.webpackJsonp=this.webpackJsonp||[]).push([[0],{112:function(e,t,n){"use strict";n.r(t);var r=n(51),a=n.n(r),o=n(23),c=n.n(o),i=n(0),u=n.n(i),l=n(124),s=n(47),d=n(78),f=n(1),p=n(31);t.default=function(e){var t=Object(s.default)().dispatch,n=Object(d.default)(),r=[{title:Object(p.default)("sign out"),onPress:function(){return t({type:"LOGOUT_REQUEST"})}}],o=(e.extra?[].concat(c()(e.extra),r):r).filter((function(e){return e.windowType==n||void 0==e.windowType}));return u.a.createElement(f.default,{style:{flexDirection:"row"}},o.map((function(e,t){return u.a.createElement(l.default,a()({key:t},e,{textStyle:{color:"white"},color:"#gray"}))})))}},114:function(e,t,n){"use strict";n.r(t),n.d(t,"main",(function(){return Ce})),n.d(t,"login",(function(){return ke})),n.d(t,"modal",(function(){return Pe}));var r=n(9),a=n.n(r),o=n(0),c=n.n(o),i=n(28),u=n(48),l=n(109),s=n(1),d=n(2),f=n(47),p=n(31);var m=d.default.create({login_container:{flex:1,backgroundColor:"#FFF"},login_header:{alignItems:"center",paddingTop:30,paddingBottom:50,backgroundColor:"#208AEC"},login_header_logo:{width:220,resizeMode:"contain"},login_header_text:{marginTop:15,color:"#f0f0f0",fontSize:16},login_header_text_bold:{color:"#fff",fontWeight:"bold"},login_wrapper:{flex:1,justifyContent:"space-between",paddingVertical:40,borderTopRightRadius:12,borderTopLeftRadius:12,marginTop:-10,backgroundColor:"#fff",alignItems:"center"},form:{width:"100%",maxWidth:280},form_input:{height:44,paddingHorizontal:20,marginBottom:20,backgroundColor:"#EDF0F7",borderRadius:50},button:{alignItems:"center",justifyContent:"center",height:44,backgroundColor:"#0065A4",borderRadius:50},button_label:{color:"#fff",fontSize:16},login_social:{width:"100%",maxWidth:280,marginTop:20},login_social_separator:{flexDirection:"row",alignItems:"center"},login_social_separator_line:{flex:1,width:"100%",height:1,backgroundColor:"#E0E0E0"},login_social_separator_text:{marginHorizontal:10,color:"#808080",fontSize:16},login_social_buttons:{flexDirection:"row",justifyContent:"center",marginTop:20},login_social_button:{alignItems:"center",justifyContent:"center",width:60,height:60,marginHorizontal:12,borderWidth:1,borderColor:"#E7E7E7",borderRadius:60},login_social_icon:{width:38,height:38,resizeMode:"contain"},login_social_facebook:{backgroundColor:"#4267B2",borderColor:"#4267B2"},login_footer_text:{flexDirection:"row",alignItems:"center",color:"#808080",fontSize:14},guest_footer_text:{flexDirection:"row",alignSelf:"center",color:"#808080",fontSize:15,margin:15},login_footer_link:{color:"#208AEC",fontSize:15,fontWeight:"bold"}}),b=n(51),g=n.n(b),v=n(8),h=n(29),y=n(40);function O(e){return o.createElement(h.View,{style:[w.outerContainer,e.outerContainerStyle]},o.createElement(h.View,{style:[w.container,e.containerStyle]},e.withSeparator?o.createElement(h.View,{style:w.separator,lightColor:"#ddd",darkColor:"rgba(255,255,255, 0.3)"}):void 0,e.title?o.createElement(h.View,{style:w.titleView},o.createElement(h.Text,{style:[w.title,e.titleStyle]},e.title),o.createElement(h.Text,{style:w.subtitle},e.subtitle)):void 0,o.createElement(h.View,{style:[w.bodyView,e.bodyStyle]},e.children)))}var w=d.default.create({outerContainer:{width:"100%",maxWidth:1080,alignItems:"stretch",backgroundColor:"transparent"},container:{marginHorizontal:20,marginVertical:10,backgroundColor:"transparent"},titleView:{width:"100%",flexDirection:"row",backgroundColor:"transparent",marginBottom:5},title:{flex:1,fontSize:16},subtitle:{flex:1,fontSize:12,textAlign:"right",marginTop:4},separator:{marginBottom:20,height:1,width:"100%"},bodyView:{width:"100%",padding:20,alignItems:"center",justifyContent:"center",borderWidth:1,borderColor:y.default.borderColor,borderRadius:6}}),E=n(111),j=n(64),x=n(4),S=n.n(x),C=n(23),k=n.n(C),P=n(7),M=n.n(P),T=n(54),_=n(56),D=n(123);function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function R(e){var t=Object(T.useQueryClient)(),n=Object(T.useInfiniteQuery)(["MessengerContentList",e],(function(t){var n;return M.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return n=t.pageParam,r.abrupt("return",Object(_.getMessengerContentList)(e,n).then((function(e){return{current:e}})));case 2:case"end":return r.stop()}}),null,null,null,Promise)}),{select:function(e){return e.pages.length>1&&(e.pages[e.pages.length-2].next=e.pages[e.pages.length-1]),e},getNextPageParam:function(e){return null!=e&&e.current.length?e.current[e.current.length-1].id:void 0},refetchOnReconnect:!1,refetchOnWindowFocus:!1}),r=n.data,a=n.fetchNextPage,c=Object(D.default)().lastJsonMessage;return Object(o.useEffect)((function(){null!=c&&"next_message"==c.type&&c.data.channel==e&&t.setQueryData(["MessengerContentList",e],(function(e){return null!=e&&e.pages[0].current&&(null==e?void 0:e.pages[0].current[0].id)!=c.data.id&&(e.pages[0].current=[c.data].concat(k()(null==e?void 0:e.pages[0].current))),function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach((function(t){S()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e||{pages:[],pageParams:[]})}))}),[c]),{data:r,fetchNextPage:a}}var L=n(112);function z(e){return Object(T.useQuery)(["MessengerMemberList",e],(function(){return M.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,M.a.awrap(Object(_.getMessengerMemberList)(e));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),null,null,null,Promise)})).data}function B(){var e=Object(T.useQueryClient)(),t=Object(T.useMutation)(_.postBulkMessengerMember,{onSuccess:function(){e.invalidateQueries("MessengerMemberList")}}),n=Object(T.useMutation)(_.deleteMessengerMember,{onSuccess:function(){e.invalidateQueries("MessengerChannelList"),e.invalidateQueries("MessengerMemberList")}});return{invite:t.mutate,leave:n.mutate}}var V=n(50),W=n(84),A=n(410),U=n(95),N=n(152),H=n(68),F=n(181),G=function(e){var t=e.link,n=e.isMobile,r=e.hideUrl,a=e.align;return c.a.createElement(O,{containerStyle:{marginHorizontal:0},bodyStyle:{padding:0}},c.a.createElement(E.TouchableOpacity,{onPress:function(){return F.default.openURL(t.url)},style:{flexDirection:"row"},containerStyle:{width:"100%"}},t.image&&c.a.createElement(H.default,{source:{uri:t.image},resizeMode:"cover",style:{width:"100%",maxWidth:n?120:150,maxHeight:n?120:150,borderWidth:1}}),c.a.createElement(h.View,{style:{flex:1,marginHorizontal:20}},c.a.createElement(h.Text,{style:{fontSize:20}},t.title),c.a.createElement(h.Text,{style:{fontSize:14,textAlign:a}},t.description),1!=r&&c.a.createElement(h.Text,{style:{fontSize:12}},t.url))))},Q=n(164),J=Object(o.createContext)({lastJsonMessage:void 0,sendJsonMessage:function(){}}),q=function(e){var t=e.disable,n=e.children;return t?c.a.createElement(c.a.Fragment,null):c.a.createElement(D.WebSocketInternalProvider,{path:"messenger/ws/rtc/",Context:J,useBackground:!0},n)},K=function(){return Object(o.useContext)(J)},Y=n(168),X=n(65);console.log("use turn server");var Z={iceServers:[JSON.parse('{"urls": "turn:34.64.153.219:3478", "credential": "qwer1234", "username": "ydh051541"}')]},$={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0,VoiceActivityDetection:!0}},ee={audio:!0,video:{framerate:30}},te=function(e,t){var n=t.data.rtcMessage,r=new X.RTCIceCandidate(n);e&&(console.log("ICE candidate Added"),e.addIceCandidate(r))},ne=function(e,t,n,r){e.candidate&&t({type:"ICEcandidate",receiver:n,data:{target:r,rtcMessage:e.candidate}})},re=function(e){var t=e.sdp.split("\r\n");return t.forEach((function(e,n){/^a=fmtp:\d*/.test(e)?t[n]=e+";x-google-max-bitrate=8000;x-google-min-bitrate=8000;x-google-start-bitrate=8000":/^a=mid:(0|video)/.test(e)&&(t[n]+="\r\nb=AS:8000")})),new X.RTCSessionDescription({type:e.type,sdp:t.join("\r\n")})},ae=function(e,t,n,r,a){var o;return M.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return n&&e.pc.addStream(n),c.t0=re,c.next=4,M.a.awrap(e.pc.createOffer($));case 4:return c.t1=c.sent,o=(0,c.t0)(c.t1),c.next=8,M.a.awrap(e.pc.setLocalDescription(o));case 8:t({type:"call",receiver:e.receiver,data:{target:r,name:null==a?void 0:a.name,rtcMessage:o}});case 9:case"end":return c.stop()}}),null,null,null,Promise)},oe=d.default.create({container:{flex:1},cam:{flex:1,height:"100%"},bottonContainer:{position:"absolute",bottom:0,justifyContent:"flex-end"},buttonBar:{flexDirection:"row",justifyContent:"space-around"},label:{backgroundColor:"#0008",color:"white",paddingHorizontal:5}}),ce=function(e){var t,n=K(),r=n.lastJsonMessage,u=function(e){var t=Object(o.useRef)({}),n=Object(o.useState)(),r=a()(n,2),i=r[0],u=r[1],l=Object(o.useState)(),s=a()(l,2),d=s[0],f=s[1],p=Object(o.useMemo)((function(){return!!d}),[d]),m=Object(o.useCallback)(c.a.memo((function(e){var t=e.style;return d?c.a.createElement(X.RTCView,{stream:d,style:t,videoProps:{height:"100%"}}):c.a.createElement(c.a.Fragment,null)})),[d]);return{start:Object(o.useCallback)((function(n,r,o){var c;return M.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:if(console.log("start"),d&&void 0===o){i.next=28;break}if(i.prev=2,"camera"!=o){i.next=9;break}return i.next=6,M.a.awrap(X.mediaDevices.getUserMedia(ee));case 6:c=i.sent,i.next=21;break;case 9:if("display"!=o){i.next=15;break}return i.next=12,M.a.awrap(X.mediaDevices.getDisplayMedia(ee));case 12:c=i.sent,i.next=21;break;case 15:if(i.t0=r,i.t0){i.next=20;break}return i.next=19,M.a.awrap(X.mediaDevices.getUserMedia(ee).catch((function(e){return X.mediaDevices.getDisplayMedia(ee)})));case 19:i.t0=i.sent;case 20:c=i.t0;case 21:f(c),Object.entries(t.current).map((function(t){var r=a()(t,2),o=(r[0],r[1]);ae(o,e,c,"guest",n)})),i.next=28;break;case 25:i.prev=25,i.t1=i.catch(2),console.error(i.t1);case 28:case"end":return i.stop()}}),null,null,[[2,25]],Promise)}),[d]),stop:Object(o.useCallback)((function(){console.log("stop"),d&&(d.getTracks().map((function(e){return e.stop()})),f(void 0))}),[d]),websocketOnMessage:function(n,r){var a,o,c,i,l;return M.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:if("connection"==(a=n.type)&&u(n.data.channel_name),"start"==a&&"host"==n.data.target&&(console.log("1 start"),(o=new X.RTCPeerConnection(Z)).addEventListener("icecandidate",(function(t){return ne(t,e,n.sender,"guest")})),t.current[n.sender]={pc:o,receiver:n.sender},ae(t.current[n.sender],e,d,"guest",r)),"answer"!=a||"host"!=n.data.target){s.next=9;break}return console.log("3 answer"),c=t.current[n.sender].pc,i=new X.RTCSessionDescription(n.data.rtcMessage),s.next=9,M.a.awrap(c.setRemoteDescription(i));case 9:"ICEcandidate"==a&&"host"==n.data.target&&(l=t.current[n.sender].pc,te(l,n));case 10:case"end":return s.stop()}}),null,null,null,Promise)},CustomRTCView:m,isPlay:p,sender:i}}(n.sendJsonMessage),l=u.start,d=u.stop,f=u.websocketOnMessage,p=u.CustomRTCView,m=u.isPlay;return Object(o.useEffect)((function(){e.user&&r&&f(r,e.user)}),[r,e.user]),Object(o.useEffect)((function(){return e.mode&&!m?e.user&&l(e.user,void 0,e.mode):null===e.mode&&m&&d(),function(){m&&d()}}),[m,e.user,e.mode]),c.a.createElement(s.default,{style:oe.container},c.a.createElement(p,{style:oe.cam}),c.a.createElement(s.default,{style:oe.bottonContainer},c.a.createElement(s.default,{style:oe.buttonBar}),c.a.createElement(s.default,{style:{flexDirection:"row"}},c.a.createElement(i.default,{style:oe.label},null==(t=e.user)?void 0:t.name)),c.a.createElement(s.default,{style:oe.buttonBar},void 0===e.mode&&!m&&c.a.createElement(Y.default,{title:"Start",onPress:function(){return e.user&&l(e.user)}}),void 0===e.mode&&m&&c.a.createElement(Y.default,{title:"Stop",onPress:d}))))},ie=function(e){var t=Object(o.useState)(""),n=a()(t,2),r=n[0],l=n[1],d=K(),f=d.lastJsonMessage,p=function(e){var t=Object(o.useRef)({}),n=Object(o.useState)(),r=a()(n,2),i=r[0],u=r[1],l=Object(o.useState)(),s=a()(l,2),d=s[0],f=s[1],p=Object(o.useCallback)(c.a.memo((function(e){return d?c.a.createElement(X.RTCView,{stream:d,style:e,videoProps:{height:"100%"}}):c.a.createElement(c.a.Fragment,null)})),[d]),m=Object(o.useMemo)((function(){return!!d}),[d]),b=Object(o.useCallback)((function(n){console.log("start"),t.current.pc||(t.current.pc=new X.RTCPeerConnection(Z),t.current.receiver=n),d||e({type:"start",receiver:n,data:{target:"host"}})}),[d]),g=function(){console.log("stop"),t.current.pc&&(f(void 0),t.current.pc.close(),t.current.pc=void 0,t.current.receiver=void 0,clearInterval(t.current.statsInterval))};return{start:b,stop:g,websocketOnMessage:function(n){var r,a,o,c,l,s,p,m,b,v,h,y;return M.a.async((function(O){for(;;)switch(O.prev=O.next){case 0:if("start"!=(l=n.type)||"guest"!=n.data.target||n.sender!=(null==(r=t.current)?void 0:r.receiver)){O.next=10;break}return console.log("(remote)1 start"),s=t.current.pc,u({name:n.data.name}),s.addEventListener("icecandidate",(function(t){return ne(t,e,n.sender,"host")})),s.addEventListener("iceconnectionstatechange",(function(e){if("connected"==t.current.pc.iceConnectionState){var n=!1;t.current.statsInterval=setInterval((function(){var e,r,a;return M.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,M.a.awrap(t.current.pc.getStats(null));case 2:e=o.sent,r="",a=void 0,e.forEach((function(e){"inbound-rtp"===e.type&&"video"===e.kind&&(Object.keys(e).forEach((function(t){r+=t+": "+e[t]+"\n"})),a=e.framesPerSecond)})),console.log(n,a),void 0!=a?n=!0:n&&g(),console.log((new Date).toTimeString().split(" ")[0],r);case 9:case"end":return o.stop()}}),null,null,null,Promise)}),1e3)}else"failed"==t.current.pc.iceConnectionState&&g()})),s.addTransceiver("video",{direction:"recvonly"}),O.next=10,M.a.awrap(ae({pc:t.current.pc,receiver:n.sender},e,d,"host",i));case 10:if("answer"!=l||"guest"!=n.data.target||n.sender!=(null==(a=t.current)?void 0:a.receiver)){O.next=18;break}return console.log("(remote)3 answer"),p=new X.RTCSessionDescription(n.data.rtcMessage),O.next=15,M.a.awrap(t.current.pc.setRemoteDescription(p));case 15:m=t.current.pc.getRemoteStreams(),f(m[m.length-1]),e({type:"end",receiver:t.current.receiver,data:{}});case 18:if("call"!=l||n.sender!=(null==(o=t.current)?void 0:o.receiver)){O.next=36;break}if(console.log("2 call"),b=t.current.pc,u({name:n.data.name}),b){O.next=24;break}return O.abrupt("return");case 24:return b.addEventListener("icecandidate",(function(t){return ne(t,e,n.sender,"host")})),v=new X.RTCSessionDescription(n.data.rtcMessage),O.next=28,M.a.awrap(b.setRemoteDescription(v));case 28:return O.next=30,M.a.awrap(b.createAnswer($));case 30:return h=O.sent,O.next=33,M.a.awrap(b.setLocalDescription(h));case 33:e({type:"answer",receiver:t.current.receiver,data:{target:"host",rtcMessage:b.localDescription}}),y=t.current.pc.getRemoteStreams(),f(y[y.length-1]);case 36:"ICEcandidate"==l&&"guest"==n.data.target&&n.sender==(null==(c=t.current)?void 0:c.receiver)&&te(t.current.pc,n);case 37:case"end":return O.stop()}}),null,null,null,Promise)},CustomRTCView:p,user:i,isPlay:m}}(d.sendJsonMessage),m=p.start,b=p.stop,g=p.websocketOnMessage,v=p.CustomRTCView,h=p.isPlay,y=p.user;return Object(o.useEffect)((function(){f&&g(f)}),[f]),Object(o.useEffect)((function(){return e.receiver&&m(e.receiver),function(){return b()}}),[e.receiver]),c.a.createElement(s.default,{style:oe.container},c.a.createElement(v,{style:oe.cam}),c.a.createElement(s.default,{style:oe.bottonContainer},c.a.createElement(s.default,{style:oe.buttonBar}),c.a.createElement(s.default,{style:{flexDirection:"row"}},e.receiver||h?c.a.createElement(i.default,{style:oe.label},(null==y?void 0:y.name)||"loading..."):c.a.createElement(c.a.Fragment,null,c.a.createElement(i.default,{style:{borderWidth:1}},"Receiver:\xa0"),c.a.createElement(u.default,{style:{borderWidth:1,flex:1},value:r,onChangeText:l}))),c.a.createElement(s.default,{style:oe.buttonBar},void 0===e.receiver&&!h&&c.a.createElement(Y.default,{title:"Start",onPress:function(){return m(r)}}),void 0===e.receiver&&h&&c.a.createElement(Y.default,{title:"Stop",onPress:b}))))},ue=n(78),le=function(e){return c.a.createElement(s.default,{style:[{maxWidth:e.scale,maxHeight:e.scale,borderWidth:1,borderColor:y.default.borderColor,backgroundColor:"gray",flexDirection:"row",flexGrow:1},void 0==e.focusGuest||e.focusGuest==e.receiver?{}:{width:0,height:0}]},c.a.createElement(E.TouchableOpacity,{style:{flex:1},containerStyle:{flex:1,justifyContent:"center"},onPress:function(){return e.setFocusGuest(e.focusGuest?void 0:e.receiver)}},e.children))},se=function(e){var t,n=e.channel_id,r=e.disable,i=e.setDisable,u=Object(f.default)().auth,l=Object(o.useState)(null),d=a()(l,2),p=d[0],m=d[1],b=Object(o.useState)([]),g=a()(b,2),v=g[0],O=g[1],w=Object(o.useState)(),E=a()(w,2),x=E[0],S=E[1],C=Object(ue.default)(),P=K(),M=P.lastJsonMessage,T=P.sendJsonMessage;Object(o.useEffect)((function(){if(null!=M&&("connection"==M.type&&T({type:"broadcast",data:{channel_id:n}}),"broadcast_guest"!=M.type&&"broadcast_host"!=M.type||O([].concat(k()(v),[M.sender])),"broadcast_disconnect"==M.type)){var e=M.sender;v.find((function(t){return t==e}))&&O(v.filter((function(t){return t!=e})))}}),[M]);var _=x?"100%":100/Math.max(2,Math.ceil(Math.sqrt(v.length+1)))+"%",D=function(e){m(p!=e?e:null)};return void 0!==M?c.a.createElement(h.View,{style:[{aspectRatio:r?0:16/9,borderColor:y.default.borderColor,borderRadius:10},"landscape"==C?{flexShrink:.5,height:"100%",borderLeftWidth:1,paddingBottom:65}:{maxHeight:"36%",width:"100%",borderBottomWidth:1}]},c.a.createElement(s.default,{style:{aspectRatio:16/9,backgroundColor:"white",flexWrap:"wrap",flexDirection:"row",width:"100%",height:"100%"}},v.map((function(e,t){return c.a.createElement(le,{scale:_,focusGuest:x,setFocusGuest:S,receiver:e},c.a.createElement(ie,{receiver:e}))})),c.a.createElement(le,{scale:_,focusGuest:x,setFocusGuest:S,receiver:null==(t=u.user)?void 0:t.name},c.a.createElement(ce,{user:u.user,mode:p}))),c.a.createElement(h.View,{style:[{position:"absolute",alignItems:"center",justifyContent:"flex-end",width:"100%",flexDirection:"row"},"landscape"==C?{bottom:0,paddingVertical:15,paddingHorizontal:19}:{backgroundColor:"transparent"}]},c.a.createElement(j.default,{title:"\u23fa\ufe0f",onPress:function(){return D("camera")}}),c.a.createElement(j.default,{title:"\ud83d\udda5\ufe0f",onPress:function(){return D("display")}}),c.a.createElement(j.default,{title:"\ud83d\udcf9",onPress:function(){return i(!0)}}))):c.a.createElement(c.a.Fragment,null)},de=c.a.memo((function(e){var t=e.channel_id,n=e.disable,r=e.setDisable;return c.a.createElement(q,{disable:n},c.a.createElement(se,{channel_id:t,disable:n,setDisable:r}))}));function fe(e){var t=0==e?0:Math.floor(Math.log(e)/Math.log(1024));return(e/Math.pow(1024,t)).toFixed(2)+" "+["B","kB","MB","GB","TB"][t]}var pe=c.a.memo((function(e){for(var t,n=Object(N.default)(),r=e.next;null!=(a=r)&&a.next&&0==r.current.length;){var a;r=r.next}var o=null==(t=r)?void 0:t.current[0];return c.a.createElement(s.default,{style:{flexDirection:"column-reverse"}},e.current.map((function(t,r){var a=r+1<e.current.length?e.current[r+1]:o,i=t.created.slice(0,16),u=i.slice(0,10),l=null==t.user,d=void 0==a||t.user!=a.user||i!=a.created.slice(0,16),f=e.ownerId==t.user,p=void 0==a||u!=a.created.slice(0,10),m=t.message_set[0];return l?c.a.createElement(s.default,{key:t.id,style:{flexDirection:"row",justifyContent:"center",width:"100%",marginVertical:5}},c.a.createElement(h.Text,null,m.content)):c.a.createElement(s.default,{key:t.id},p?c.a.createElement(s.default,{style:{flexDirection:"row",justifyContent:"center",width:"100%"}},c.a.createElement(h.Text,null,u)):void 0,c.a.createElement(s.default,{key:t.id,style:{flexDirection:"row",justifyContent:f?"space-between":"flex-start",width:"100%"}},d&&!f?c.a.createElement(s.default,{style:{marginTop:3,marginLeft:12}},c.a.createElement(Q.default,{name:t.name,userId:t.user,size:36})):c.a.createElement(s.default,{style:{width:48}}),c.a.createElement(O,{outerContainerStyle:{width:void 0,maxWidth:"90%"},title:d?t.name:void 0,titleStyle:{flex:void 0},bodyStyle:{padding:10},subtitle:""+i.slice(11)},c.a.createElement(A.default,{linkDefault:!0,style:{wordBreak:"break-word"},linkStyle:{color:"#12b886"}},c.a.createElement(h.Text,{selectable:!0},m.content)),t.link_set.map((function(e,t){return c.a.createElement(G,{key:t,link:e,isMobile:n})})),m.file&&m.filename&&m.filesize&&c.a.createElement(G,{link:{title:"\ud83d\udce5 "+m.filename,url:m.file,description:fe(m.filesize),image:null},hideUrl:!0,align:"right",isMobile:n}))))})))}));var me=n(26),be=n(232),ge=n(171),ve=n(124);d.default.create({Panel_Button_Text:{textAlign:"center",color:"#fff",fontSize:21},Panel_Holder:{borderWidth:1,borderColor:"#888",marginVertical:5}});var he=n(234);function ye(e){var t=Object(ue.default)(),n=Object(o.useMemo)((function(){return"landscape"==t?{flexDirection:"row",alignItems:"center",justifyContent:"space-between"}:{flexDirection:"column",alignItems:"flex-start"}}),[t]);return c.a.createElement(h.View,{style:[{paddingVertical:5,width:"100%"},n]},c.a.createElement(h.Text,{style:["landscape"==t?{flex:1}:{width:"100%"},{paddingHorizontal:15,fontSize:16},e.textStyle]},e.name),c.a.createElement(h.View,{style:["landscape"==t?{flex:6}:{width:"100%"},{paddingHorizontal:15}]},c.a.createElement(h.View,{style:{width:e.width}},e.children)))}function Oe(e){return c.a.createElement(ye,{name:e.name,width:e.width,textStyle:e.textStyle},c.a.createElement(he.default,e))}var we=d.default.create({field:{width:"50%",flexDirection:"row",padding:10},separator:{marginBottom:20,height:1,width:"100%"}}),Ee=n(156),je=n(182),xe=function(e){var t=Object(o.useState)(e.selectedRef.current.has(e.item.id)),n=a()(t,2),r=n[0],i=n[1];return c.a.createElement(h.View,{style:r?{borderWidth:1,borderColor:"blue"}:{}},Object(je.renderMemberItem)(e.item,(function(){r?(i(!1),e.selectedRef.current.delete(e.item.id)):(i(!0),e.selectedRef.current.add(e.item.id))})))};var Se=n(233);var Ce={HomeScreen:{title:Object(p.default)("home"),component:function(e){var t,n=e.navigation,r=e.route,a=Object(ue.default)(),u=Object(W.default)(),l=y.default[u].text,d=[{title:Object(p.default)("member"),headerRight:function(){return c.a.createElement(L.default,null)}},{title:Object(p.default)("messenger"),headerRight:function(){return c.a.createElement(L.default,{extra:[{title:Object(p.default)("create"),onPress:function(){return Object(V.navigate)("ChannelEditScreen",{type:"messenger"})}}]})}},{title:"config",headerRight:function(){return c.a.createElement(L.default,null)}}];return Object(o.useLayoutEffect)((function(){var e,t=0|(null==r||null==(e=r.params)?void 0:e.tab);n.setOptions("portrait"==a?d[t]:{title:Object(p.default)("home"),headerRight:function(){return c.a.createElement(L.default,null)}})}),[n,r,a]),c.a.createElement(c.a.Fragment,null,"landscape"==a?c.a.createElement(s.default,{style:{flex:1,justifyContent:"center",alignItems:"center"}},c.a.createElement(s.default,{style:{width:"80%",height:"80%"}},c.a.createElement(me.default,{style:{fontSize:32,color:l}},"Tokki Tok"),c.a.createElement(s.default,{style:{backgroundColor:y.default.borderColor,height:1,width:"100%"}}),c.a.createElement(s.default,{style:{flex:1,alignItems:"flex-start"}},c.a.createElement(i.default,{style:{fontSize:24}}," "),c.a.createElement(i.default,{style:{fontSize:24,fontWeight:"500",color:l}},Object(p.default)("Quick Start")),c.a.createElement(ve.default,{title:Object(p.default)("+ New Messenger"),textStyle:{fontSize:20,color:l},style:{paddingLeft:0,borderRadius:20},onPress:function(){return Object(V.navigate)("ChannelEditScreen",{type:"messenger"})}})))):c.a.createElement(c.a.Fragment,null),c.a.createElement(s.default,{style:"portrait"==a?{flex:1}:{width:0,flex:0}},c.a.createElement(be.TabViewNavigator,{tabs:ge.bottomTabs,tabBarPosition:"bottom",index:parseInt((null==(t=r.params)?void 0:t.tab)||0),onTab:function(e){n.setParams({tab:e})}})))},path:"home"},ChatScreen:{title:Object(p.default)("chat"),component:function(e){var t,n,r=e.navigation,i=e.route,u=null==i||null==(t=i.params)?void 0:t.id,l=Object(o.useRef)(0),d=Object(o.useRef)(null),m=Object(f.default)().auth,b=null==(n=Object(U.default)(m))?void 0:n.find((function(e){return e.id==parseInt(u)})),O=R(u),w=O.data,x=O.fetchNextPage,S=z(u),C=Object(o.useMemo)((function(){var e;return null==S||null==(e=S.find((function(e){var t;return e.user==(null==(t=m.user)?void 0:t.id)})))?void 0:e.id}),[m,S]),k=Object(ue.default)(),P=B(),M=Object(o.useState)(""),D=a()(M,2),I=D[0],A=D[1],N=Object(o.useState)(!0),H=a()(N,2),F=H[0],G=H[1],Q=Object(o.useState)(!1),J=a()(Q,2),q=J[0],K=J[1],Y=Object(W.default)(),X=function(){var e;I.length>0&&(Z.create({channel:u,user:null==(e=m.user)?void 0:e.id,content:I}),A(""),G(!0))},Z=function(){var e=Object(T.useMutation)(_.postMessage,{onSuccess:function(){}}),t=Object(T.useMutation)(_.deleteMessengerContent,{onSuccess:function(e,t){}});return{create:e.mutate,delete:t.mutate}}();Object(o.useLayoutEffect)((function(){r.setOptions({headerRight:function(){return c.a.createElement(L.default,{extra:[{title:Object(p.default)("invite"),onPress:function(){Object(V.navigate)("InviteScreen",{id:u})}},{title:Object(p.default)("leave"),onPress:function(){C&&P.leave(C),ee()}}]})},title:null==b?void 0:b.name})}),[r,i,C]);var $=Object(o.useCallback)((function(e){var t,n=e.item;e.index;return c.a.createElement(pe,g()({},n,{ownerId:null==(t=m.user)?void 0:t.id}))}),[m]),ee=function(){r.canGoBack()?r.goBack():r.navigate("HomeScreen",{tab:2})};return Object(o.useEffect)((function(){u||ee()}),[]),Object(o.useEffect)((function(){F&&(d.current.focus(),G(!1))}),[F]),c.a.createElement(s.default,{style:{flex:1,alignItems:"center",flexDirection:"landscape"==k?"row-reverse":"column"}},c.a.createElement(de,{channel_id:u,setDisable:function(e){return K(!e)},disable:!q}),c.a.createElement(s.default,{style:[{flex:q?void 0:1,flexShrink:1},"landscape"==k?{minWidth:320,height:"100%"}:{width:"100%"}]},c.a.createElement(E.FlatList,{style:{flexDirection:"column-reverse"},contentContainerStyle:{padding:10,flexGrow:1,flexDirection:"column-reverse"},data:null==w?void 0:w.pages,renderItem:$,onScroll:function(e){e.nativeEvent.contentOffset.y+e.nativeEvent.contentSize.height-l.current<1&&x()},onLayout:function(e){l.current=e.nativeEvent.layout.height}}),c.a.createElement(h.View,{style:{bottom:0,alignItems:"center",width:"100%",flexDirection:"row",paddingTop:15,paddingBottom:10,paddingHorizontal:19}},c.a.createElement(E.TextInput,{ref:d,value:I,onChangeText:A,style:{flex:1,borderWidth:1,height:40,borderRadius:6,borderColor:y.default.borderColor,backgroundColor:y.default[Y].background,color:y.default[Y].text},onSubmitEditing:X,blurOnSubmit:!0}),c.a.createElement(j.default,{title:"\ud83d\udcac",onPress:X}),c.a.createElement(j.default,{title:"\ud83d\udce4",onPress:function(){return new Promise((function(e,t){if("web"==v.default.OS){var n=document.createElement("input");n.type="file",n.onchange=function(t){e(t.target.files[0])},n.onabort=t,n.onerror=t,n.click()}else e(void 0)})).then((function(e){var t;Z.create({channel:u,user:null==(t=m.user)?void 0:t.id,content:"",newFile:e})}))}}),!q&&c.a.createElement(j.default,{title:"\ud83d\udcf9",onPress:function(){return K(!q)}}))))},path:"chat"},TabOneScreen:{title:"tab one",component:function(e){return e.navigation,c.a.createElement(s.default,{style:{padding:10}})},path:"one"}},ke={LoginScreen:{path:"login",title:Object(p.default)("Sign in"),component:function(e){var t=e.navigation,n=e.route,r=Object(o.useState)(""),d=a()(r,2),b=d[0],g=d[1],v=Object(o.useState)(""),h=a()(v,2),y=h[0],O=h[1],w=Object(f.default)().dispatch,E=function(){return w({type:"LOGIN_REQUEST",username:b,password:y})};return Object(o.useLayoutEffect)((function(){t.setOptions({headerRight:void 0})}),[t,n]),c.a.createElement(s.default,{style:m.login_wrapper},c.a.createElement(s.default,{style:m.form},c.a.createElement(u.default,{style:m.form_input,value:b,placeholder:Object(p.default)("Username"),onChangeText:function(e){return g(e)},autoCapitalize:"none",keyboardType:"email-address",onSubmitEditing:E}),c.a.createElement(u.default,{style:m.form_input,value:y,placeholder:Object(p.default)("Password"),secureTextEntry:!0,onChangeText:function(e){return O(e)},onSubmitEditing:E}),c.a.createElement(l.default,{onPress:E},c.a.createElement(s.default,{style:m.button},c.a.createElement(i.default,{style:m.button_label},Object(p.default)("Sign in")))),c.a.createElement(l.default,{onPress:function(){return w({type:"LOGIN_GUEST"})}},c.a.createElement(i.default,{style:m.guest_footer_text},Object(p.default)("Sign in as guest")))),c.a.createElement(s.default,{style:m.login_social},c.a.createElement(s.default,{style:m.login_social_separator},c.a.createElement(s.default,{style:m.login_social_separator_line}),c.a.createElement(i.default,{style:m.login_social_separator_text},"*"),c.a.createElement(s.default,{style:m.login_social_separator_line})),c.a.createElement(s.default,{style:m.login_social_buttons})))}}},Pe={ChannelEditScreen:{title:Object(p.default)("channel"),component:function(e){var t,n,r=e.navigation,i=e.route,u=null==i||null==(t=i.params)?void 0:t.id,l=null==i||null==(n=i.params)?void 0:n.type,s=Object(f.default)().auth,d=Object(U.default)(s),m=Object(U.useMessengerChannelMutation)(),b=null==d?void 0:d.find((function(e){return e.id==u})),g=Object(o.useState)(""),v=a()(g,2),y=v[0],w=v[1],E=Object(o.useState)(""),x=a()(E,2),S=x[0],C=x[1];return Object(o.useEffect)((function(){b&&(w(b.name),C((null==b?void 0:b.description)||""))}),[b]),c.a.createElement(O,{outerContainerStyle:{alignSelf:"center"}},c.a.createElement(h.View,{style:{justifyContent:"space-around"}},c.a.createElement(h.Text,{style:{fontSize:20}},Object(p.default)("Channel"))),c.a.createElement(h.View,{style:we.separator,lightColor:"#ddd",darkColor:"rgba(255,255,255, 0.3)"}),c.a.createElement(h.View,{style:{width:"100%"}},c.a.createElement(Oe,{name:Object(p.default)("Channel Name"),value:y,setValue:w,width:"60%"}),c.a.createElement(Oe,{name:Object(p.default)("Description"),value:S,setValue:C,multiline:!0,width:"60%"})),c.a.createElement(h.View,{style:{width:"100%",flexDirection:"row",justifyContent:"flex-end"}},c.a.createElement(j.default,{title:Object(p.default)("save"),onPress:function(){var e;if(null!=s&&null!=(e=s.user)&&e.id&&s.groupId){var t,n={id:u,name:y,description:S,type:l,owner:null==s||null==(t=s.user)?void 0:t.id,group:s.groupId};(u?m.update(n):m.create(n)).then((function(e){return Object(V.navigate)("Main",{screen:"messenger"==e.type?"MessengerScreen":"BoardScreen",params:{id:e.id}})}))}}}),c.a.createElement(j.default,{title:Object(p.default)("cancel"),style:{marginHorizontal:5},onPress:function(){r.canGoBack()?r.goBack():r.replace("Main")}})))},path:"modal/channel"},InviteScreen:{title:Object(p.default)("invite"),component:function(e){var t,n=e.navigation,r=e.route,a=null==r||null==(t=r.params)?void 0:t.id,i=Object(f.default)().auth,u=Object(Ee.default)(i),l=z(a),s=B(),d=Object(o.useRef)(new Set),m=Object(o.useMemo)((function(){var e=new Set(null==l?void 0:l.map((function(e){return e.user})));return null==u?void 0:u.filter((function(t){return!e.has(t.id)}))}),[u,l]),b=function(){n.canGoBack()?n.goBack():a?Object(V.navigate)("ChatScreen",{id:a}):n.replace("Main")};return c.a.createElement(O,{outerContainerStyle:{alignSelf:"center"}},c.a.createElement(h.View,{style:{backgroundColor:"white",width:"50%"}},null==m?void 0:m.map((function(e,t){return c.a.createElement(xe,{key:t,item:e,selectedRef:d})}))),c.a.createElement(h.View,{style:[{width:"50%",flexDirection:"row",padding:10},{justifyContent:"flex-end"}]},c.a.createElement(j.default,{title:Object(p.default)("invite"),onPress:function(){s.invite({channel_id:a,user_ids:k()(d.current)}),b()}}),c.a.createElement(j.default,{title:Object(p.default)("cancel"),onPress:b})))},path:"modal/invite"},ProfileScreen:{title:Object(p.default)("profile"),component:function(e){var t,n=e.navigation,r=e.route,a=null==r||null==(t=r.params)?void 0:t.id,i=Object(f.default)().auth,u=Object(Ee.default)(i),l=null==u?void 0:u.find((function(e){return e.id==a})),s=Object(U.useMessengerChannelMutation)();return Object(o.useEffect)((function(){a&&l||!u||(n.canGoBack()?n.goBack():n.replace("Main"))}),[u]),l?c.a.createElement(h.View,{style:{padding:10}},c.a.createElement(Se.default,{username:l.username,name:l.name,userId:l.id}),c.a.createElement(j.default,{title:Object(p.default)("create messenger"),onPress:function(){var e;if(null!=i&&null!=(e=i.user)&&e.id&&i.groupId){var t,n={name:i.user.id!=l.id?i.user.name+", "+l.name:i.user.name,type:"messenger",owner:null==i||null==(t=i.user)?void 0:t.id,group:i.groupId,counterpart:l.id};s.direct(n).then((function(e){return Object(V.navigate)("Main",{screen:"ChatScreen",params:{id:e.id}})}))}}})):c.a.createElement(c.a.Fragment,null)},path:"modal/profile"}}},123:function(e,t,n){"use strict";n.r(t),n.d(t,"WebSocketInternalProvider",(function(){return g})),n.d(t,"WebSocketProvider",(function(){return v}));var r=n(9),a=n.n(r),o=n(0),c=n.n(o),i=n(382),u=n.n(i),l=n(170),s=n(251),d=Object(o.createContext)({lastJsonMessage:void 0,sendJsonMessage:function(){}}),f="https://blacktokki.com".split("://"),p=a()(f,2),m=p[0],b=p[1],g=function(e){var t=e.children,n=e.path,r=e.Context,i=e.useBackground,d=Object(o.useState)(null),f=a()(d,2),p=f[0],g=f[1],v=Object(o.useState)(i||"active"==s.default.currentState),h=a()(v,2),y=h[0],O=h[1],w=u()(("https"==m?"wss":"ws")+"://"+b+"/"+n,{shouldReconnect:function(e){return!0},protocols:p?["Authorization",p]:void 0,onOpen:function(e){console.log("success websocket connection("+n+")")},onClose:function(e){console.log("closed websocket connection("+n+")")}},y&&null!=p),E=w.lastJsonMessage,j=w.sendJsonMessage;return Object(o.useEffect)((function(){l.default.getItem("Authorization").then(g);var e=function(e){return O(i||"active"==e)};return s.default.addEventListener("change",e),function(){return s.default.removeEventListener("change",e)}}),[]),null==p?c.a.createElement(c.a.Fragment,null,t):c.a.createElement(r.Provider,{value:{lastJsonMessage:E,sendJsonMessage:j}},t)},v=c.a.memo((function(e){var t=e.disable,n=e.children;return t?c.a.createElement(c.a.Fragment,null,n):c.a.createElement(g,{path:"messenger/ws/",Context:d},n)}));t.default=function(){return Object(o.useContext)(d)}},124:function(e,t,n){"use strict";n.r(t);var r=n(51),a=n.n(r),o=n(0),c=n.n(o),i=n(2),u=n(64);t.default=function(e){return c.a.createElement(u.default,a()({},e,{style:[l.style,e.style]}))};var l=i.default.create({style:{borderRadius:6,backgroundColor:"transparent",borderWidth:0}})},127:function(e,t,n){"use strict";n.r(t),n.d(t,"getNotification",(function(){return c})),n.d(t,"postNotification",(function(){return i})),n.d(t,"putNotification",(function(){return u}));var r=n(7),a=n.n(r),o=n(36),c=function(e){var t;return a.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,a.a.awrap(o.default.get("/api/v1/notifications/?type=WEB&user="+e));case 2:return t=n.sent.data,n.abrupt("return",t.length?t[0]:void 0);case 4:case"end":return n.stop()}}),null,null,null,Promise)},i=function(e){return a.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.a.awrap(o.default.post("/api/v1/notifications/",e));case 2:return t.abrupt("return",t.sent.data);case 3:case"end":return t.stop()}}),null,null,null,Promise)},u=function(e){return a.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.a.awrap(o.default.put("/api/v1/notifications/"+e.id+"/",e));case 2:return t.abrupt("return",t.sent.data);case 3:case"end":return t.stop()}}),null,null,null,Promise)}},152:function(e,t,n){"use strict";n.r(t);var r=n(8),a=n(228),o=n.n(a);t.default=function(){return o()().isMobile()||"android"==r.default.OS||"ios"==r.default.OS}},155:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return s}));var r=n(9),a=n.n(r),o=n(0),c=n(29),i=n(2),u=n(162),l=n(40);function s(e){var t=o.useState(!1),n=a()(t,2),r=(n[0],n[1]),i=o.useState(!1),l=a()(i,2),s=l[0],f=l[1];return o.createElement(u.default,{style:[d.outerContainer,e.outerContainerStyle,s?{backgroundColor:"rgb(242,242,242)"}:{}],onPressIn:function(){f(!0)},onPressOut:function(){f(!1),null==e.onPress||e.onPress()},onHoverIn:function(){return r(!0)},onHoverOut:function(){return r(!1)}},o.createElement(c.View,{style:[d.container,e.containerStyle]},o.createElement(c.View,{style:[d.bodyView,e.bodyStyle]},o.createElement(o.Fragment,null,e.children))))}var d=i.default.create({outerContainer:{width:"100%",maxWidth:1080,alignItems:"stretch"},container:{marginHorizontal:20,backgroundColor:"transparent"},bodyView:{width:"100%",padding:10,minHeight:40,alignItems:"center",justifyContent:"center",borderBottomWidth:1,borderColor:l.default.borderColor,backgroundColor:"transparent"}})},156:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return i}));var r=n(7),a=n.n(r),o=n(54),c=n(56);function i(e){return Object(o.useQuery)(["UserMembershipList",null==e?void 0:e.groupId],(function(){return a.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if(null==e||!e.groupId){t.next=6;break}return t.next=3,a.a.awrap(Object(c.getUserMembershipList)(null==e?void 0:e.groupId));case 3:t.t0=t.sent,t.next=7;break;case 6:t.t0=[];case 7:return t.abrupt("return",t.t0);case 8:case"end":return t.stop()}}),null,null,null,Promise)})).data}},164:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(275),c=function(e,t,n){return Math.floor(e%(n-t)+t)},i=function(e){var t=function(e,t){for(var n=t||0,r=0;r<e.length;r++)n=e.charCodeAt(r)+((n<<5)-n);return n=Math.abs(n),"hsl("+c(n,0,360)+", "+c(n,0,100)+"%, "+c(n,25,75)+"%)"}(e.name,e.userId);return r.createElement(o.Avatar.Text,{style:{backgroundColor:t},size:e.size,label:e.name.split(" ").map((function(e){return e[0]})).join().toUpperCase()})};t.default=function(e){return a.a.createElement(i,e)}},171:function(e,t,n){"use strict";n.r(t),n.d(t,"bottomTabs",(function(){return j})),n.d(t,"drawerTabs",(function(){return x}));var r=n(182),a=n(4),o=n.n(a),c=n(0),i=n.n(c),u=n(29),l=n(155),s=n(95),d=n(47),f=n(50);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var b=function(e){return i.a.createElement(u.View,{style:{flex:1}},e.data.map((function(e,t){return i.a.createElement(l.default,{key:t,containerStyle:{marginHorizontal:0},bodyStyle:{alignItems:"flex-start"},onPress:e.onPress},i.a.createElement(u.Text,{style:{marginLeft:20}},e.name))})))},g={Messenger:function(){var e=Object(d.default)().auth,t=Object(s.useMessengerChannelSorted)(e);return i.a.createElement(b,{data:(t||[]).map((function(e){return m(m({},e),{},{onPress:function(){return Object(f.navigate)("ChatScreen",{id:e.id})}})}))})}},v=n(510),h=n(511),y=n(28),O=n(1),w=i.a.createElement(h.default,{size:30,style:{marginBottom:-3},name:"chatbox"}),E=n(31),j={OneTab:{title:Object(E.default)("member"),component:r.default,icon:r.MemberIcon},TwoTab:{title:Object(E.default)("messenger"),component:function(){var e=Object(d.default)().auth,t=Object(s.useMessengerChannelSorted)(e),n=(new Date).toISOString().slice(0,10);return i.a.createElement(O.default,{style:{flex:1,backgroundColor:"white"}},null==t?void 0:t.map((function(e,t){var r,a,o,c=null==(r=e.last_message)?void 0:r.created.slice(0,10);return i.a.createElement(l.default,{key:t,bodyStyle:{flexDirection:"row",justifyContent:"space-between"},onPress:function(){return Object(f.navigate)("ChatScreen",{id:e.id})}},i.a.createElement(O.default,{style:{flexDirection:"row"}},i.a.createElement(v.default,{size:36,style:{marginBottom:-3,marginRight:20},name:"users"}),i.a.createElement(O.default,null,i.a.createElement(O.default,{style:{flexDirection:"row"}},i.a.createElement(y.default,{style:{fontSize:18}},e.name),i.a.createElement(y.default,{style:{fontSize:18,opacity:.4,paddingLeft:5}},e.member_count)),i.a.createElement(y.default,{style:{fontSize:16,opacity:.4}},null==(a=e.last_message)?void 0:a.content))),i.a.createElement(O.default,null,i.a.createElement(y.default,{style:{fontSize:14,opacity:.4,textAlign:"right"}},c==n?null==(o=e.last_message)?void 0:o.created.slice(11,16):c),i.a.createElement(y.default,{style:{fontSize:14,textAlign:"right"}},e.unread_count?e.unread_count:" ")))})))},icon:w}},x={TwoTab:{title:Object(E.default)("messenger"),component:g.Messenger,icon:w}}},182:function(e,t,n){"use strict";n.r(t),n.d(t,"renderMemberItem",(function(){return p})),n.d(t,"MemberIcon",(function(){return m}));var r=n(287),a=n(0),o=n.n(a),c=n(28),i=n(1),u=n(155),l=n(47),s=n(156),d=n(50),f=n(164),p=function(e,t){return o.a.createElement(u.default,{key:e.id,bodyStyle:{backgroundColor:"white",flexDirection:"row",justifyContent:"flex-start"},onPress:t},o.a.createElement(i.default,{style:{marginTop:4,marginRight:12}},o.a.createElement(f.default,{name:e.name,userId:e.id,size:44})),o.a.createElement(c.default,{style:{fontSize:20,fontWeight:"400"}},e.name))};t.default=function(){var e=Object(l.default)().auth,t=Object(s.default)(e),n=o.a.useMemo((function(){return t&&t.map((function(e){return p(e,(function(){return Object(d.navigate)("ProfileScreen",{id:e.id})}))}))}),[t]);return o.a.createElement(i.default,{style:{flex:1,backgroundColor:"white"}},n)};var m=o.a.createElement(r.default,{size:32,style:{marginBottom:-3},name:"account"})},232:function(e,t,n){"use strict";n.r(t),n.d(t,"TabViewNavigator",(function(){return j}));var r=n(51),a=n.n(r),o=n(4),c=n.n(o),i=n(23),u=n.n(i),l=n(9),s=n.n(l),d=n(183),f=n(0),p=n.n(f),m=n(1),b=n(2),g=n(253),v=n(50),h=n(233),y=n(124),O=n(40),w=n(78),E=n(171),j=function(e){var t=p.a.useState(e.index||0),n=s()(t,2),r=n[0],o=n[1],i=Object.entries(e.tabs),l=e.onTab,d=Object.assign.apply(Object,[{}].concat(u()(i.map((function(e){var t=s()(e,2),n=t[0],r=t[1];return c()({},n,r.icon)})))));return p.a.createElement(g.TabView,{renderTabBar:function(e){return p.a.createElement(g.TabBar,a()({},e,{indicatorStyle:{backgroundColor:"#2196F3"},style:{backgroundColor:"white"},activeColor:"black",inactiveColor:"black",renderIcon:function(e){return d[e.route.key]},onTabPress:function(e){return null==l?void 0:l(i.findIndex((function(t){var n=s()(t,2),r=n[0];n[1];return r==e.route.key})))}}))},navigationState:{index:r,routes:i.map((function(e){var t=s()(e,2);return{key:t[0],title:t[1].title}}))},onIndexChange:o,renderScene:Object(g.SceneMap)(Object.assign.apply(Object,[{}].concat(u()(i.map((function(e){var t=s()(e,2),n=t[0],r=t[1];return c()({},n,r.component)})))))),tabBarPosition:e.tabBarPosition})},x=[function(){return Object(v.navigate)("ChannelEditScreen",{type:"messenger"})},function(){return Object(v.navigate)("ChannelEditScreen",{type:"board"})}];t.default=p.a.memo((function(e){var t=e.user,n=Object(d.default)().colors,r=Object(w.default)(),a=Object(f.useState)(0),o=s()(a,2),c=o[0],i=o[1];return"landscape"==r?p.a.createElement(m.default,{style:[S.tabBar,{backgroundColor:n.card,borderTopColor:n.border}],pointerEvents:"auto"},p.a.createElement(h.default,{userId:t.id,username:t.username,name:t.name}),p.a.createElement(m.default,{style:{flexDirection:"row-reverse"}},p.a.createElement(y.default,{title:"+",textStyle:{fontSize:20},style:{borderRadius:20},onPress:x[c]})),p.a.createElement(m.default,{accessibilityRole:"tablist",style:S.content},Object.keys(E.drawerTabs).length>1?p.a.createElement(j,{tabs:E.drawerTabs,tabBarPosition:"top",onTab:i}):p.a.createElement(m.default,{style:{borderTopWidth:1,flex:1,borderColor:n.border}},Object.values(E.drawerTabs).map((function(e){var t=e.component;return p.a.createElement(t,{key:e.title})}))))):p.a.createElement(m.default,{style:{width:0}})}));var S=b.default.create({tabBar:{width:240,elevation:8,borderRightWidth:1,borderColor:O.default.borderColor},content:{flex:1,flexDirection:"row"},tab:{flex:1,alignItems:"center"},label:{textAlign:"center",backgroundColor:"transparent"}})},233:function(e,t,n){"use strict";n.r(t);var r=n(51),a=n.n(r),o=n(9),c=n.n(o),i=n(0),u=n.n(i),l=n(1),s=n(29),d=n(164),f=n(124),p=n(234),m=n(56),b=n(47);t.default=function(e){var t,n=u.a.useState(),r=c()(n,2),o=r[0],i=r[1],g=Object(b.default)(),v=g.auth,h=g.dispatch,y=(null==(t=v.user)?void 0:t.id)==e.userId,O=function(){y&&Object(m.patchUser)({id:e.userId,name:o||""}).finally((function(){i(void 0),h({type:"REFRESH"})}))};return u.a.createElement(l.default,{style:{width:"100%",height:135,justifyContent:"space-evenly",alignItems:"center"}},u.a.createElement(d.default,a()({},e,{size:75})),void 0===o?u.a.createElement(f.default,{textStyle:{fontWeight:"bold",fontSize:15},onPress:function(){return y&&i(e.name)},title:e.name,disabled:!y}):u.a.createElement(p.default,{value:o,style:{textAlign:"center"},setValue:i,onBlur:O,onEndEditing:O}),u.a.createElement(s.Text,{style:{fontWeight:"normal",fontSize:14}},e.username))}},234:function(e,t,n){"use strict";n.r(t);var r=n(9),a=n.n(r),o=n(0),c=n.n(o),i=n(48),u=n(40),l=n(84);t.default=function(e){var t=Object(o.useState)(),n=a()(t,2),r=n[0],s=n[1],d=e.minHeight||30,f=Object(l.default)();return c.a.createElement(i.default,{style:[{borderColor:"#d0d7de",fontSize:16,borderWidth:1,borderRadius:6,paddingHorizontal:10,paddingVertical:3,backgroundColor:u.default[f].background,color:u.default[f].text,height:e.multiline?r:d},e.style],editable:!e.disabled,value:e.value,onChangeText:e.setValue,onContentSizeChange:e.multiline?function(e){return s(Math.max(e.nativeEvent.contentSize.height,d)+2)}:void 0,onBlur:function(){return null==e.onBlur?void 0:e.onBlur(e.value)},onEndEditing:function(){return null==e.onEndEditing?void 0:e.onEndEditing(e.value)},multiline:e.multiline})}},29:function(e,t,n){"use strict";n.r(t),n.d(t,"useThemeColor",(function(){return m})),n.d(t,"Text",(function(){return b})),n.d(t,"View",(function(){return g}));var r=n(51),a=n.n(r),o=n(5),c=n.n(o),i=n(0),u=n(28),l=n(1),s=n(40),d=n(84),f=["style","lightColor","darkColor"],p=["style","lightColor","darkColor"];function m(e,t){var n=Object(d.default)(),r=e[n];return r||s.default[n][t]}function b(e){var t=e.style,n=e.lightColor,r=e.darkColor,o=c()(e,f),l=m({light:n,dark:r},"text");return i.createElement(u.default,a()({style:[{color:l},t]},o))}function g(e){var t=e.style,n=e.lightColor,r=e.darkColor,o=c()(e,p),u=m({light:n,dark:r},"background");return i.createElement(l.default,a()({style:[{backgroundColor:u},t]},o))}},31:function(e,t,n){"use strict";n.r(t);var r,a=n(500),o=n(58),c=n(22),i=n(354),u={ko:n(445)},l=null!=(r=i.findBestLanguageTag(Object.keys(u)))?r:{languageTag:"en",isRTL:!1},s=l.languageTag,d=l.isRTL;c.default.forceRTL(d);var f=Object(a.createIntl)({defaultLocale:"en",locale:s,messages:u[s]},Object(o.createIntlCache)());t.default=function(e,t){return f.formatMessage({id:e,defaultMessage:e},t).toString()}},346:function(e,t,n){"use strict";n.r(t);var r=n(4),a=n.n(r),o=n(404),c=n(114);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}Object.values(c.modal).forEach((function(e){return e.path="tokki-tok/"+e.path})),t.default={prefixes:[o.makeUrl("/")],config:{screens:u({Main:{screens:u(u(u({},c.main),c.login),{},{NotFound:"*"}),path:"tokki-tok"}},c.modal)}}},36:function(e,t,n){"use strict";n.r(t),n.d(t,"accountURL",(function(){return i})),n.d(t,"setToken",(function(){return s})),n.d(t,"getToken",(function(){return d}));var r=n(7),a=n.n(r),o=n(402),c=n(170),i="https://blacktokki.com/account/",u={baseURL:"https://blacktokki.com/messenger/",withCredentials:!0,headers:{}},l=o.default.create(u);l.interceptors.request.use((function(e){return e}),(function(e){return Promise.reject(e)})),l.interceptors.response.use((function(e){return e}),(function(e){return 401===e.response.status&&d().then((function(e){var t;return a.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,a.a.awrap(l.post("/api/v1/user/sso/refresh/",{token:e},{headers:{Authorization:""},baseURL:i}));case 2:200==(t=n.sent).status&&""!==t.data&&s(t.data);case 4:case"end":return n.stop()}}),null,null,null,Promise)})),Promise.reject(e)}));var s=function(e){return a.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if(l.defaults.headers.Authorization="JWT "+e,!e){t.next=6;break}return t.next=4,a.a.awrap(c.default.setItem("Authorization",e));case 4:t.next=7;break;case 6:c.default.removeItem("Authorization");case 7:case"end":return t.stop()}}),null,null,null,Promise)},d=function(){var e;return a.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.a.awrap(c.default.getItem("Authorization"));case 2:return e=t.sent,l.defaults.headers.Authorization=e?"JWT "+e:null,t.abrupt("return",e);case 5:case"end":return t.stop()}}),null,null,null,Promise)};t.default=l},40:function(e,t,n){"use strict";n.r(t);t.default={light:{text:"#000",background:"#fff",tint:"#2f95dc",tabIconDefault:"#ccc",tabIconSelected:"#2f95dc",header:"#24292f",buttonColor:"rgb(242,242,242)",buttonBackgroundColor:"#f6f8fa"},dark:{text:"#fff",background:"#000",tint:"#fff",tabIconDefault:"#ccc",tabIconSelected:"#fff",header:"#dbd6d1",buttonColor:"rgb(14,14,14)",buttonBackgroundColor:"#080604"},button:{borderColor:"rgba(27,31,36,0.15)"},borderColor:"#d0d7de",focus:"#0065A4"}},406:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return q}));var r=n(9),a=n.n(r),o=n(323),c=n(291),i=n(0),u=n.n(i),l=n(1),s=n(54),d=n(511),f=n(78),p=n(2),m=n(28),b=n(109),g=n(31);function v(e){var t=e.navigation;return i.createElement(l.default,{style:h.container},i.createElement(m.default,{style:h.title},Object(g.default)("This screen doesn't exist.")),i.createElement(b.default,{onPress:function(){return t.replace("HomeScreen")},style:h.link},i.createElement(m.default,{style:h.linkText},Object(g.default)("Go to home screen!"))))}var h=p.default.create({container:{flex:1,backgroundColor:"#fff",alignItems:"center",justifyContent:"center",padding:20},title:{fontSize:20,fontWeight:"bold"},link:{marginTop:15,paddingVertical:15},linkText:{fontSize:14,color:"#2e78b7"}}),y=n(114),O=n(232),w=n(47),E=n(123),j=n(112),x=n(40),S=n(111),C=n(4),k=n.n(C),P=n(7),M=n.n(P),T=n(288),_=(n(497),n(127));function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){k()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var R=n(488),L=R.messagingSenderId,z="AIzaSyAN2ydKUtznjBlg8DUAPrUPGIVbqdPzv88".split("").map((function(e,t){return(e.charCodeAt(0)^L.charCodeAt(t)).toString(16).padStart(2,"0")})).join(""),B=T.default.initializeApp(I(I({},R),{},{apiKey:"AIzaSyAN2ydKUtznjBlg8DUAPrUPGIVbqdPzv88"})),V=T.default.messaging(B);V.onMessage((function(e){if("Notification"in window){if("granted"===Notification.permission){var t=JSON.parse(e.data.message_set)[0];new Notification(e.data.channel_name,{body:e.data.name+": "+t.content})}}else alert("This browser does not support desktop notification")}));var W=Object(i.createContext)({enable:!1,setEnable:function(){}}),A=function(e){var t=e.children,n=e.user,r=Object(i.useRef)(),o=Object(i.useState)(),c=a()(o,2),l=c[0],s=c[1],d=Object(i.useMemo)((function(){return!(null!=l&&l.token)}),[l]);return Object(i.useEffect)((function(){var e=!0,t=function(t){e&&s(t)};return n?function(){var e,t;return M.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,M.a.awrap(Notification.requestPermission());case 2:if("granted"!==n.sent){n.next=14;break}return n.next=6,M.a.awrap(navigator.serviceWorker.register("/tokki-tok/firebase-messaging-sw.js?"+z));case 6:return e=n.sent,console.log("[SW]: SCOPE: ",e.scope),n.next=10,M.a.awrap(V.getToken({serviceWorkerRegistration:e,vapidKey:"BCCi7wopGYI8EhmFxMwIuB5L0hJOBkWh3Wx7VmilJYMhzd5y75JeNEQY1kdw9_n_WIawgmirphxOr4kmBp9-FnQ"}));case 10:if(t=n.sent,window.addEventListener("beforeunload",(function(t){t.preventDefault(),e.unregister()})),!t){n.next=14;break}return n.abrupt("return",t);case 14:return n.abrupt("return",void 0);case 15:case"end":return n.stop()}}),null,null,null,Promise)}().then((function(e){r.current=e,Object(_.getNotification)(n.id).then((function(r){var a=void 0==e?null:e;void 0==r?Object(_.postNotification)({user:n.id,type:"WEB",token:a}).then(t):Object(_.putNotification)(I(I({},r),{},{token:a})).then(t)}))})):t(void 0),function(){e=!1}}),[n]),n?u.a.createElement(W.Provider,{value:{enable:d,setEnable:function(e){n&&l&&Object(_.putNotification)(I(I({},l),{},{token:e||void 0==r.current?null:r.current})).then((function(e){s(e)}))}}},t):u.a.createElement(u.a.Fragment,null,t)},U=n(152),N=n(41),H=n(8),F=function(e){var t=Object(U.default)(),n=Object(i.useState)(window.innerHeight+1),r=a()(n,2),o=r[0],c=r[1];return Object(i.useEffect)((function(){if(t&&"web"==H.default.OS){var e=function(e){c(window.innerHeight+1)};return N.default.addEventListener("change",e),function(){return N.default.removeEventListener("change",e)}}}),[t]),u.a.createElement(l.default,{style:{height:t&&"web"==H.default.OS?o:"100%"}},e.children)},G=n(84),Q=Object(o.default)(),J=new s.QueryClient;function q(){var e=Object(f.default)();return u.a.createElement(F,{windowType:e},u.a.createElement(w.AuthProvider,null,u.a.createElement(s.QueryClientProvider,{client:J},u.a.createElement(Q.Navigator,{mode:"modal",headerMode:"screen",screenOptions:{cardStyle:{backgroundColor:"white"},animationEnabled:!0,cardStyleInterpolator:c.CardStyleInterpolators.forVerticalIOS}},u.a.createElement(Q.Screen,{name:"Main",component:Y,options:{headerShown:!1}}),Object.entries(y.modal).map((function(t){var n=a()(t,2),r=n[0],o=n[1];return u.a.createElement(Q.Screen,{key:r,name:r,component:o.component,options:{title:o.title,gestureDirection:"landscape"==e?"vertical-inverted":"vertical"}})}))))))}var K=Object(o.default)();function Y(){var e=Object(f.default)(),t=Object(U.default)(),n=Object(w.default)().auth,r=Object(G.default)(),o=Object(i.useMemo)((function(){return void 0===n.user?[]:(console.log("current user: ",n.user),Object.entries(null===n.user?y.login:y.main))}),[n]);return void 0!==n.user?u.a.createElement(l.default,{style:{flexDirection:"row",flex:1}},n.user?u.a.createElement(O.default,{user:n.user}):void 0,u.a.createElement(l.default,{style:{flex:1}},u.a.createElement(A,{user:n.user},u.a.createElement(E.WebSocketProvider,{disable:null===n.user||void 0===n.user},u.a.createElement(K.Navigator,{screenOptions:function(n){var a=n.navigation,o=n.route;return{headerStyle:{backgroundColor:x.default[r].header,height:t?50:void 0},headerTitleStyle:{color:"white"},headerLeft:function(){return function(e,t,n,r){var a=-1==["HomeScreen","LoginScreen"].findIndex((function(e){return e==t.name}));return"portrait"==n&&a?u.a.createElement(S.TouchableOpacity,{onPress:function(){e.canGoBack()?e.goBack():a&&e.replace("HomeScreen")}},u.a.createElement(d.default,{size:r?20:24,style:{marginHorizontal:r?16:20},name:"arrow-back"})):null}(a,o,e,t)},headerRight:function(){return u.a.createElement(j.default,null)},headerLeftContainerStyle:{backgroundColor:"white",borderBottomWidth:1,borderColor:x.default.borderColor},cardStyle:{flexShrink:1},animationEnabled:"portrait"==e,cardStyleInterpolator:c.CardStyleInterpolators.forHorizontalIOS}}},o.map((function(e){var t=a()(e,2),n=t[0],r=t[1];return u.a.createElement(K.Screen,{key:n,name:n,component:r.component,options:{title:r.title}})})),u.a.createElement(K.Screen,{name:"NotFound",component:v,options:{title:"Oops!"}})))))):u.a.createElement(u.a.Fragment,null)}},409:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return O}));var r=n(0),a=n.n(r),o=n(403),c=n(513),i=n(50),u=n(84),l=n(4),s=n.n(l),d=n(9),f=n.n(d),p=n(7),m=n.n(p),b=n(511),g=n(294),v=n(293);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function O(){var e=function(){var e=r.useState(!1),t=f()(e,2),a=t[0],o=t[1];return r.useEffect((function(){m.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,v.preventAutoHideAsync(),e.next=4,m.a.awrap(g.loadAsync(y(y({},b.default.font),{},{"space-mono":n(495)})));case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.warn(e.t0);case 9:return e.prev=9,o(!0),v.hideAsync(),e.finish(9);case 13:case"end":return e.stop()}}),null,null,[[0,6,9,13]],Promise)}),[]),a}(),t=Object(u.default)();return e?a.a.createElement(c.SafeAreaProvider,null,a.a.createElement(i.default,{colorScheme:t}),a.a.createElement(o.StatusBar,null)):null}},413:function(e,t,n){e.exports=n(496)},428:function(e,t){},445:function(e){e.exports=JSON.parse('{"Sign in":"\ub85c\uadf8\uc778","Sign in as guest":"\uac8c\uc2a4\ud2b8\ub85c \ub85c\uadf8\uc778","home":"\ud648","chat":"\ucc44\ud305","channel":"\ucc44\ub110","Channel":"\ucc44\ub110","invite":"\ucd08\ub300","profile":"\ud504\ub85c\ud544","member":"\uba64\ubc84","messenger":"\uba54\uc2e0\uc800","Username":"\uc0ac\uc6a9\uc790\uba85","Password":"\ube44\ubc00\ubc88\ud638","Quick Start":"\ube60\ub978 \uc2dc\uc791","+ New Messenger":"+ \ucc44\ud305 \uc2dc\uc791","save":"\uc800\uc7a5","cancel":"\ucde8\uc18c","Channel Name":"\ucc44\ub110\uba85","Description":"\uc124\uba85","create messenger":"\ucc44\ud305 \uc2dc\uc791","sign out":"\ub85c\uadf8\uc544\uc6c3","leave":"\ub098\uac00\uae30","This screen doesn\'t exist.":"\ud398\uc774\uc9c0\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.","Go to home screen!":"\ub3cc\uc544\uac00\uae30","create":"\ucd94\uac00\ud558\uae30"}')},47:function(e,t,n){"use strict";n.r(t),n.d(t,"AuthProvider",(function(){return b}));var r=n(9),a=n.n(r),o=n(4),c=n.n(o),i=n(0),u=n.n(i),l=n(56),s=n(127);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var p=Object(i.createContext)({auth:{},dispatch:function(){}}),m=function(e,t){switch(t.type){case"LOGIN_REQUEST":return f(f({},e),{},{request:{username:t.username,password:t.password}});case"LOGIN_GUEST":return f(f({},e),{},{request:{username:"guest",password:"guest"}});case"LOGIN_SUCCESS":return f(f({},e),{},{user:t.user,request:void 0});case"LOGIN_FAILED":return f(f({},e),{},{request:void 0});case"LOGOUT_REQUEST":return f(f({},e),{},{request:null});case"LOGOUT_SUCCESS":return f(f({},e),{},{user:null,request:void 0});case"REFRESH":return f(f({},e),{},{user:void 0});default:throw new Error("Unhandled action type: "+t.type)}},b=function(e){var t=e.children,n=Object(i.useReducer)(m,{}),r=a()(n,2),o=r[0],c=r[1],d=Object(i.useMemo)((function(){var e,t;return{user:o.user,groupId:null==(e=o.user)||null==(t=e.membership_set.find((function(e){return null==e.root_group_id})))?void 0:t.group}}),[o]);return Object(i.useEffect)((function(){void 0===o.user?Object(l.checkLogin)().then((function(e){c({type:"LOGIN_SUCCESS",user:e})})).catch((function(e){console.log(e),c({type:"LOGOUT_SUCCESS"})})):null===o.user&&o.request?Object(l.login)(o.request.username,o.request.password).then((function(e){c({type:"LOGIN_SUCCESS",user:e})})).catch((function(){c({type:"LOGIN_FAILED"})})):o.user&&null===o.request&&Object(s.getNotification)(o.user.id).then((function(e){e&&Object(s.putNotification)(f(f({},e),{},{token:""})).then((function(){Object(l.logout)().then((function(){return c({type:"LOGOUT_SUCCESS"})}))}))}))}),[o]),u.a.createElement(p.Provider,{value:{auth:d,dispatch:c}},t)};t.default=function(){return Object(i.useContext)(p)}},488:function(e,t,n){firebaseConfig={authDomain:"virtual-metrics-355712.firebaseapp.com",projectId:"virtual-metrics-355712",storageBucket:"virtual-metrics-355712.appspot.com",messagingSenderId:"76003576924",appId:"1:76003576924:web:c8c8a006d07918bbc02a99",measurementId:"G-SEL35L4N5R"},e.exports=firebaseConfig},495:function(e,t,n){e.exports=n.p+"./fonts/SpaceMono-Regular.ttf"},50:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"navigate",(function(){return f})),n.d(t,"default",(function(){return p}));var r=n(345),a=n.n(r),o=n(276),c=n(274),i=n(132),u=n(0),l=n(346),s=n(406),d=u.createRef();function f(e,t){var n,r;t&&(null==(n=d.current)||n.navigate(e,t)),null==(r=d.current)||r.navigate(e)}function p(t){var n=t.colorScheme;return u.createElement(o.default,{ref:d,documentTitle:{formatter:function(e,t){return"TOKKI TOK"}},linking:e.versions&&e.versions.electron?void 0:l.default,theme:"dark"===n?c.default:i.default},u.createElement(s.default,null))}!function(e){if(void 0!==e&&"/"===e.search[1]){var t=e.search.slice(1).split("&").map((function(e){return e.replace(/~and~/g,"&")})).join("?");window.history.replaceState(null,"",e.pathname.slice(0,-1)+t+e.hash)}}(window.location);var m=["ReactNativeFiberHostComponent"],b=a.a.clone(console);console.warn=function(e){var t=!0;e instanceof Object?t=!1:m.forEach((function(n){e.indexOf&&e.indexOf(n)<=-1&&(t=!1)})),t&&b.warn(e)}}.call(this,n(257))},56:function(e,t,n){"use strict";n.r(t),n.d(t,"login",(function(){return c})),n.d(t,"logout",(function(){return i})),n.d(t,"guestLogin",(function(){return u})),n.d(t,"checkLogin",(function(){return s})),n.d(t,"getUserList",(function(){return d})),n.d(t,"patchUser",(function(){return f})),n.d(t,"getUserMembershipList",(function(){return p})),n.d(t,"getMessengerChannelList",(function(){return h})),n.d(t,"postChannel",(function(){return y})),n.d(t,"postDirectChannel",(function(){return O})),n.d(t,"putChannel",(function(){return w})),n.d(t,"deleteChannel",(function(){return E})),n.d(t,"getMessengerMemberList",(function(){return j})),n.d(t,"postBulkMessengerMember",(function(){return x})),n.d(t,"deleteMessengerMember",(function(){return S})),n.d(t,"getMessengerContentList",(function(){return C})),n.d(t,"postMessage",(function(){return k})),n.d(t,"deleteMessengerContent",(function(){return P})),n.d(t,"accountURL",(function(){return o.accountURL})),n.d(t,"setToken",(function(){return o.setToken})),n.d(t,"getToken",(function(){return o.getToken}));var r=n(7),a=n.n(r),o=n(36),c=function(e,t){var n;return a.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return e.endsWith(".guest")&&0==t.length&&(t="guest"),r.next=3,a.a.awrap(o.default.post("/api-token-auth/",{username:e,password:t}));case 3:if(200!=(n=r.sent).status){r.next=10;break}return r.next=7,a.a.awrap(Object(o.setToken)(n.data));case 7:return r.next=9,a.a.awrap(s());case 9:return r.abrupt("return",r.sent);case 10:case"end":return r.stop()}}),null,null,null,Promise)},i=function(){return a.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.a.awrap(Object(o.setToken)(null));case 2:return e.next=4,a.a.awrap(o.default.get("/api-auth/logout/"));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),null,null,null,Promise)},u=function(){return a.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.a.awrap(c("guest","guest"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),null,null,null,Promise)},l=function(){var e,t;return a.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,a.a.awrap(o.default.get("/api/v1/users/memberships/?_self=true"));case 2:if(n.t0=e=n.sent,null!=n.t0){n.next=7;break}n.t1=void 0,n.next=8;break;case 7:n.t1=e.data;case 8:if(!(t=n.t1)||!t.length){n.next=11;break}return n.abrupt("return",t[0]);case 11:return n.abrupt("return",null);case 12:case"end":return n.stop()}}),null,null,null,Promise)},s=function(){var e,t;return a.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,a.a.awrap(Object(o.getToken)());case 2:if(null!==n.sent){n.next=5;break}return n.abrupt("return",null);case 5:return n.prev=5,n.next=8,a.a.awrap(l());case 8:return n.abrupt("return",n.sent);case 11:if(n.prev=11,n.t0=n.catch(5),e=n.t0,void 0===n.t0.response||401!=n.t0.response.status){n.next=24;break}return n.prev=15,n.next=18,a.a.awrap(l());case 18:return n.abrupt("return",n.sent);case 21:n.prev=21,n.t1=n.catch(15),e=n.t1;case 24:throw t="ERR_NETWORK"==e.code||e.message&&e.message.startsWith("Cannot read"),{error:e,isOffline:t};case 26:case"end":return n.stop()}}),null,null,[[5,11],[15,21]],Promise)},d=function(e){return a.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.a.awrap(o.default.get("/api/v1/users/?group_id="+e));case 2:return t.abrupt("return",t.sent.data);case 3:case"end":return t.stop()}}),null,null,null,Promise)},f=function(e){return a.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.a.awrap(o.default.patch("/api/v1/user/",{ids:[e.id],updated:{name:e.name}},{baseURL:o.accountURL}));case 2:case"end":return t.stop()}}),null,null,null,Promise)},p=function(e){return a.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.a.awrap(o.default.get("/api/v1/users/memberships/?group_id="+e));case 2:return t.abrupt("return",t.sent.data);case 3:case"end":return t.stop()}}),null,null,null,Promise)},m=n(4),b=n.n(m);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){b()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var h=function(e){return a.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.a.awrap(o.default.get("/api/v1/channels/messenger/?type=messenger&messenger_user_id="+e));case 2:return t.abrupt("return",t.sent.data);case 3:case"end":return t.stop()}}),null,null,null,Promise)},y=function(e){return a.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.a.awrap(o.default.post("/api/v1/channels/",e));case 2:return t.abrupt("return",t.sent.data);case 3:case"end":return t.stop()}}),null,null,null,Promise)},O=function(e){return a.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.a.awrap(o.default.post("/api/v1/channels/direct/",e));case 2:return t.abrupt("return",t.sent.data);case 3:case"end":return t.stop()}}),null,null,null,Promise)},w=function(e){return a.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.a.awrap(o.default.put("/api/v1/channels/"+e.id+"/",e));case 2:return t.abrupt("return",t.sent.data);case 3:case"end":return t.stop()}}),null,null,null,Promise)},E=function(e){return a.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.a.awrap(o.default.delete("/api/v1/channels/"+e+"/"));case 2:case"end":return t.stop()}}),null,null,null,Promise)},j=function(e){return a.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.a.awrap(o.default.get("/api/v1/messengermembers/?channel="+e));case 2:return t.abrupt("return",t.sent.data);case 3:case"end":return t.stop()}}),null,null,null,Promise)},x=function(e){return a.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.a.awrap(o.default.post("/api/v1/messengermembers/bulk/",{channel:e.channel_id,user_ids:e.user_ids}));case 2:case"end":return t.stop()}}),null,null,null,Promise)},S=function(e){return a.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.a.awrap(o.default.delete("/api/v1/messengermembers/"+e+"/"));case 2:case"end":return t.stop()}}),null,null,null,Promise)},C=function(e,t){var n;return a.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return n=t?"&id_lt="+t:"",r.next=3,a.a.awrap(o.default.get("/api/v1/messengercontents/?limit=30&channel="+e+n));case 3:return r.abrupt("return",r.sent.data.results);case 4:case"end":return r.stop()}}),null,null,null,Promise)},k=function(e){var t;return a.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(!e.newFile){n.next=8;break}return(t=new FormData).append("file",e.newFile),Object.entries(e).forEach((function(e){t.append(e[0],""+e[1])})),n.next=6,a.a.awrap(o.default.post("/api/v1/messengercontents/messages/",t,{headers:v(v({},o.default.defaults.headers),{},{"Content-Type":"multipart/form-data"})}));case 6:n.next=10;break;case 8:return n.next=10,a.a.awrap(o.default.post("/api/v1/messengercontents/messages/",e));case 10:case"end":return n.stop()}}),null,null,null,Promise)},P=function(e){return a.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.a.awrap(o.default.delete("/api/v1/messengercontents/"+e+"/"));case 2:case"end":return t.stop()}}),null,null,null,Promise)}},64:function(e,t,n){"use strict";n.r(t);var r=n(4),a=n.n(r),o=n(9),c=n.n(o),i=n(0),u=n.n(i),l=n(28),s=n(2),d=n(162),f=n(40),p=n(84);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var g=function(e){var t=Object(i.useState)(!1),n=c()(t,2),r=n[0],a=n[1];return u.a.createElement(d.default,{onPress:function(){return e.onPress()},onHoverIn:function(){return a(!0)},onHoverOut:function(){return a(!1)},style:[{paddingVertical:5,paddingHorizontal:16},e.style,r?{backgroundColor:e.color}:{}]},u.a.createElement(l.default,{selectable:!1,style:[{fontSize:14},e.textStyle]},e.title))};t.default=function(e){var t=Object(p.default)(),n=b(b({color:f.default[t].buttonColor},e),{},{style:[v.style,{backgroundColor:f.default[t].buttonBackgroundColor},e.style],textStyle:[v.text,{color:f.default[t].text},e.textStyle]});return u.a.createElement(g,n)};var v=s.default.create({style:{borderRadius:6,borderColor:f.default.button.borderColor,borderWidth:1},text:{textAlign:"center",fontWeight:"600"}})},78:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return s}));var r=n(9),a=n.n(r),o=n(0),c=n(41),i=n(228),u=n.n(i),l=function(e){return e.height>=e.width?"portrait":"landscape"};function s(){var e=u()(),t=Object(o.useState)(l(c.default.get("window"))),n=a()(t,2),r=n[0],i=n[1],s=function(){return i(l(c.default.get("window")))};return Object(o.useEffect)((function(){return c.default.addEventListener("change",s),function(){c.default.removeEventListener("change",s)}})),e.isMobile()?"portrait":r}},84:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return a}));var r=n(373);function a(){return Object(r.default)()}},95:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return b})),n.d(t,"useMessengerChannelSorted",(function(){return g})),n.d(t,"useMessengerChannelMutation",(function(){return v}));var r=n(4),a=n.n(r),o=n(23),c=n.n(o),i=n(7),u=n.n(i),l=n(0),s=n(54),d=n(56),f=n(123);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){a()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function b(e){var t=Object(s.useQueryClient)(),n=Object(f.default)().lastJsonMessage,r=Object(s.useQuery)("MessengerChannelList",(function(){var t;return u.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(null==e||null==(t=e.user)||!t.id){n.next=6;break}return n.next=3,u.a.awrap(Object(d.getMessengerChannelList)(e.user.id));case 3:n.t0=n.sent,n.next=7;break;case 6:n.t0=[];case 7:return n.abrupt("return",n.t0);case 8:case"end":return n.stop()}}),null,null,null,Promise)})).data;return Object(l.useEffect)((function(){if(null!=n&&("enter"==n.type&&t.setQueryData("MessengerChannelList",(function(e){return(null!=e&&e.find((function(e){return e.id==n.data.id}))?e:[n.data].concat(c()(e||[]))).sort((function(e,t){return e.id-t.id}))})),"next_message"==n.type)){var e=n.data;t.setQueryData("MessengerChannelList",(function(t){return(t||[]).map((function(t){var n;return t.id==e.channel?m(m({},t),{},{last_message:{content:null==(n=e.message_set[0])?void 0:n.content,created:e.created}}):t}))}))}}),[n]),r}function g(e){var t=b(e);return null==t?void 0:t.sort((function(e,t){var n,r;return((null==(n=e.last_message)?void 0:n.created)||"")<((null==(r=t.last_message)?void 0:r.created)||"")?1:-1}))}function v(){var e=Object(s.useQueryClient)(),t=Object(s.useMutation)(d.postChannel,{onSuccess:function(){return e.invalidateQueries("MessengerChannelList")}}),n=Object(s.useMutation)(d.putChannel,{onSuccess:function(){return e.invalidateQueries("MessengerChannelList")}}),r=Object(s.useMutation)(d.postDirectChannel,{onSuccess:function(){return e.invalidateQueries("MessengerChannelList")}});return{create:t.mutateAsync,update:n.mutateAsync,direct:r.mutateAsync}}}},[[413,1,2]]]);
//# sourceMappingURL=app.602f6799.chunk.js.map