{"version":3,"sources":["src/components/HeaderRight.tsx","src/screens/main/LoginScreen.tsx","src/components/CommonSection.tsx","src/hooks/lists/useMessengerContent.List.ts","src/hooks/lists/useMessengerMemberList.ts","src/components/LinkPreview.tsx","src/lib/react-native-webrtc/useWebsocketContext.tsx","src/lib/react-native-webrtc/webrtc/p2p.tsx","src/lib/react-native-webrtc/webrtc/index.ts","src/lib/react-native-webrtc/LocalCam.tsx","src/lib/react-native-webrtc/RemoteCam.tsx","src/screens/main/ChatScreen/VideoCallSection.tsx","src/screens/main/ChatScreen/index.tsx","src/screens/main/TabOneScreen.tsx","src/components/RowField.tsx","src/components/TextField.tsx","src/screens/ChannelEditScreen.tsx","src/screens/InviteScreen.tsx","src/screens/index.ts","src/screens/main/HomeScreen.tsx","src/screens/ProfileScreen.tsx","src/hooks/useWebsocketContext.tsx","src/components/TextButton.tsx","src/apis/notification.ts","src/hooks/useIsMobile.ts","src/components/CommonItem.tsx","src/hooks/lists/useUserMembershipList.ts","src/lib/react-native-paper/Avatar.tsx","src/components/Avatar.tsx","src/tabs/DrawerTab.tsx","src/tabs/MessengerTab.tsx","src/tabs/index.ts","src/tabs/MemberTab.tsx","src/navigation/DrawerNavigator.tsx","src/components/Profile.tsx","src/components/CommonTextInput.tsx","src/components/Themed.tsx","src/lang/index.ts","src/navigation/LinkingConfiguration.ts","src/apis/axios.ts","src/constants/Colors.ts","src/screens/NotFoundScreen.tsx","src/hooks/useFirebaseContext.tsx","src/components/MobileSafeAreaView.tsx","src/navigation/RootNavigator.tsx","App.tsx","src/hooks/useCachedResources.ts","src/hooks/useAuthContext.tsx","web/firebase-config.js","src/assets/fonts/SpaceMono-Regular.ttf","src/navigation/index.tsx","src/apis/account.ts","src/apis/messenger.ts","src/components/CommonButton.tsx","src/hooks/useResizeWindow.ts","src/hooks/useColorScheme.ts","src/hooks/lists/useMessengerChannelList.ts"],"names":["props","dispatch","useAuthContext","windowType","useResizeWindow","defaultButtonProps","title","lang","onPress","type","buttonProps","extra","filter","v","undefined","style","flexDirection","map","k","key","textStyle","color","Styles","StyleSheet","create","login_container","flex","backgroundColor","login_header","alignItems","paddingTop","paddingBottom","login_header_logo","width","resizeMode","login_header_text","marginTop","fontSize","login_header_text_bold","fontWeight","login_wrapper","justifyContent","paddingVertical","borderTopRightRadius","borderTopLeftRadius","form","maxWidth","form_input","height","paddingHorizontal","marginBottom","borderRadius","button","button_label","login_social","login_social_separator","login_social_separator_line","login_social_separator_text","marginHorizontal","login_social_buttons","login_social_button","borderWidth","borderColor","login_social_icon","login_social_facebook","login_footer_text","guest_footer_text","alignSelf","margin","login_footer_link","CommonSection","styles","outerContainer","outerContainerStyle","container","containerStyle","withSeparator","separator","lightColor","darkColor","titleView","titleStyle","subtitle","bodyView","bodyStyle","children","marginVertical","textAlign","padding","Colors","useMessengerContentList","channel_id","queryClient","useQueryClient","useInfiniteQuery","a","async","pageParam","getMessengerContentList","then","current","select","data","pages","length","next","getNextPageParam","lastPage","id","refetchOnReconnect","refetchOnWindowFocus","fetchNextPage","lastJsonMessage","useWebsocketContext","useEffect","setQueryData","_data","pageParams","useMessengerMemberList","useQuery","getMessengerMemberList","useMessengerMemberMutation","invite","useMutation","postBulkMessengerMember","onSuccess","invalidateQueries","leave","deleteMessengerMember","mutate","link","isMobile","hideUrl","align","Linking","openURL","url","image","Image","source","uri","maxHeight","description","WebSocketContext","createContext","sendJsonMessage","WebSocketProvider","disable","path","Context","useBackground","useContext","console","log","peerConstraints","iceServers","JSON","parse","sessionConstraints","mandatory","OfferToReceiveAudio","OfferToReceiveVideo","VoiceActivityDetection","mediaConstraints","audio","video","framerate","onICEcandidate","pc","message","_message","rtcMessage","candidate","RTCIceCandidate","addIceCandidate","sendICEcandidate","event","sendMessage","receiver","target","optimizeSdp","offerDescription","arr","sdp","split","forEach","str","i","test","RTCSessionDescription","join","createOffer","pcRefCurrent","stream","user","addStream","setLocalDescription","name","camStyle","cam","bottonContainer","position","bottom","buttonBar","label","pcRef","useRef","useState","sender","setSender","_stream","setStream","isPlay","useMemo","CustomRTCView","useCallback","React","memo","videoProps","start","mode","mediaDevices","getUserMedia","newStream","getDisplayMedia","catch","e","Object","entries","error","stop","getTracks","track","websocketOnMessage","response","channel_name","peerConnection","RTCPeerConnection","addEventListener","answerDescription","setRemoteDescription","useLocalCam","View","Text","Button","setReceiver","setUser","close","clearInterval","statsInterval","iceConnectionState","activeStream","setInterval","getStats","stats","statsOutput","framePerSecond","report","kind","keys","statName","framesPerSecond","Date","toTimeString","addTransceiver","direction","streams","getRemoteStreams","createAnswer","localDescription","useRemoteCam","TextInput","value","onChangeText","VideoView","scale","flexGrow","focusGuest","setFocusGuest","VideoCallContainer","setDisable","auth","videoMode","setVideoMode","guests","setGuests","useRtcContext","find","Math","max","ceil","sqrt","toggleVideoMode","Themed","aspectRatio","flexShrink","borderLeftWidth","borderBottomWidth","flexWrap","RemoteCam","LocalCam","CommonButton","humanFileSize","size","floor","pow","toFixed","MessengerContentPageItem","useIsMobile","nextPage","nextContent","content","index2","created","slice","date","isSystem","isFirst","isSelf","ownerId","dayChanged","message_set","marginLeft","Avatar","userId","linkDefault","wordBreak","linkStyle","selectable","file_set","file","fileIndex","LinkPreview","filename","filesize","link_set","linkIndex","Panel_Button_Text","Panel_Holder","RowField","rowStyle","TextField","CommonTextInput","field","InviteItem","selectedRef","has","item","selected","setSelected","renderMemberItem","delete","add","main","HomeScreen","component","navigation","route","theme","useColorScheme","text","options","headerRight","HeaderRight","navigate","useLayoutEffect","index","params","tab","setOptions","TextButton","paddingLeft","tabs","bottomTabs","tabBarPosition","parseInt","onTab","setParams","ChatScreen","inputRef","channel","useMessengerChannelList","memberList","member_id","messengerMemberMutation","setValue","autoFocus","setAutoFocus","postValue","contentMutation","postMessage","_delete","deleteMessengerContent","d","variables","useMessengerContentMutation","back","renderItem","canGoBack","goBack","focus","VideoCallSection","minWidth","contentContainerStyle","onScroll","nativeEvent","contentOffset","y","contentSize","onLayout","p","layout","ref","background","onSubmitEditing","blurOnSubmit","Promise","resolve","reject","Platform","OS","input","document","createElement","onchange","files","onabort","onerror","click","f","TabOneScreen","login","LoginScreen","username","setUsername","password","setPassword","_login","placeholder","autoCapitalize","keyboardType","secureTextEntry","TouchableOpacity","modal","ChannelEditScreen","channelList","channelMutation","useMessengerChannelMutation","setName","setDescription","multiline","groupId","newChannel","owner","group","update","screen","replace","InviteScreen","userList","useUserMembershipList","Set","memberSet","user_ids","ProfileScreen","Profile","counterpart","direct","SCHEMA","DOMAIN","WebSocketInternalProvider","token","setToken","AppState","currentState","isActive","setIsActive","useWebSocket","shouldReconnect","closeEvent","protocols","onOpen","onClose","AsyncStorage","getItem","onChange","nextState","removeEventListener","Provider","getNotification","user_id","axios","get","postNotification","notification","post","putNotification","put","useMobileDetect","CommonItem","setHover","press","setPress","onPressIn","onPressOut","onHoverIn","onHoverOut","minHeight","getUserMembershipList","normalizeHash","hash","min","initHash","charCodeAt","abs","stringToHSL","toUpperCase","DrawerTab","Messenger","useMessengerChannelSorted","MessengerIcon","Ionicons","OneTab","MemberTab","icon","MemberIcon","TwoTab","today","toISOString","last_message","FontAwesome","marginRight","opacity","member_count","unread_count","drawerTabs","memberItem","TabViewNavigator","setIndex","icons","assign","renderTabBar","indicatorStyle","activeColor","inactiveColor","renderIcon","scene","onTabPress","findIndex","navigationState","routes","onIndexChange","renderScene","SceneMap","onAddList","colors","useTheme","tabBar","card","borderTopColor","border","pointerEvents","accessibilityRole","borderTopWidth","values","drawerTab","Tab","elevation","borderRightWidth","patchUser","finally","disabled","onBlur","onEndEditing","contentHeight","setContentHeight","editable","onContentSizeChange","useThemeColor","colorName","colorFromProps","otherProps","light","dark","translations","ko","require","RNLocalize","languageTag","isRTL","I18nManager","forceRTL","intl","createIntl","defaultLocale","locale","messages","createIntlCache","formatMessage","defaultMessage","toString","ROOTPATH","prefixes","config","screens","Main","NotFound","accountURL","defaultOption","baseURL","withCredentials","headers","_axios","interceptors","request","use","status","getToken","r","defaults","setItem","removeItem","tint","tabIconDefault","tabIconSelected","header","buttonColor","buttonBackgroundColor","NotFoundScreen","linkText","firebaseConfig","messagingSenderId","apiKeyEncrypted","padStart","app","firebase","initializeApp","apiKey","messaging","onMessage","payload","window","Notification","permission","body","alert","FirebaseContext","enable","setEnable","FirebaseProvider","tokenRef","setNotification","isMount","setNotificationInternal","n","requestPermission","navigator","serviceWorker","register","process","serviceWorkerRegistration","scope","vapidKey","currentToken","preventDefault","unregister","requestToken","t","noti","innerHeight","setHeight","Dimensions","Root","createStackNavigator","QueryClient","RootNavigator","MobileSafeAreaView","client","Navigator","headerMode","screenOptions","cardStyle","animationEnabled","cardStyleInterpolator","CardStyleInterpolators","forVerticalIOS","Screen","MainNavigator","headerShown","gestureDirection","DrawerNavigator","headerStyle","headerTitleStyle","headerLeft","canGOBackScreen","headerLeftContainerStyle","forHorizontalIOS","App","isLoadingComplete","setLoadingComplete","SplashScreen","Font","font","warn","useCachedResources","colorScheme","StatusBar","AuthContext","authReducer","initialState","action","Error","AuthProvider","useReducer","authState","membership_set","g","root_group_id","checkLogin","logout","module","exports","navigationRef","Navigation","documentTitle","formatter","linking","versions","LinkingConfiguration","DarkTheme","DefaultTheme","l","search","decoded","s","history","replaceState","pathname","location","ignoreWarnings","_console","_","clone","indexOf","endsWith","guestLogin","checkLoginToken","isOffline","code","startsWith","getUserList","group_id","patch","ids","updated","getMessengerChannelList","postChannel","postDirectChannel","putChannel","deleteChannel","id_lt","id_lt_param","results","formData","FormData","append","content_id","DefaultButton","hover","_props","getWindowType","detectMobile","setWindowType","_useColorScheme","sort","b","mutateAsync"],"mappings":"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","file":"static/js/app.5eccf5de.chunk.js","sourcesContent":["import React from 'react'\nimport TextButton from \"./TextButton\"\nimport useAuthContext from \"../hooks/useAuthContext\"\nimport useResizeWindow from '../hooks/useResizeWindow'\nimport { View } from 'react-native'\nimport lang from '../lang'\n\ntype ButtonProps = {title:string, onPress:()=>void, windowType?:'landscape'|'portrait'}\n\nexport default (props:{extra?:ButtonProps[]})=>{\n    const {dispatch} = useAuthContext()\n    const windowType = useResizeWindow()\n    const defaultButtonProps:ButtonProps[] = [{title:lang('sign out'), onPress:()=>dispatch({type:\"LOGOUT_REQUEST\"})}]\n    const buttonProps = (props.extra?[...props.extra, ...defaultButtonProps]:defaultButtonProps).filter(v=>v.windowType==windowType || v.windowType == undefined)\n    return<View style={{flexDirection:'row'}}>\n        {buttonProps.map((v,k)=><TextButton key={k} {...v} textStyle={{color:'white'}} color='#gray'/>)}\n    </View>\n}\n  ","import React, {useLayoutEffect, useState} from 'react';\nimport {\n  Text,\n  TextInput,\n  TouchableOpacity,\n  View,\n  StyleSheet,\n} from 'react-native';\nimport { StackScreenProps } from '@react-navigation/stack';\nimport useAuthContext from '../../hooks/useAuthContext';\nimport lang from '../../lang'\n\nexport default function LoginScreen({\n  navigation, route\n}: StackScreenProps<any, 'Login'>) {\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const {dispatch} = useAuthContext()\n  const _login = ()=>dispatch({type:'LOGIN_REQUEST', username, password})\n  useLayoutEffect(() => {\n    navigation.setOptions({\n      headerRight: undefined\n    });\n  }, [navigation, route]);\n\n  return (\n    <View style={Styles.login_wrapper}>\n      <View style={Styles.form}>\n        <TextInput\n          style={Styles.form_input}\n          value={username}\n          placeholder={lang('Username')}\n          onChangeText={(text) => setUsername(text)}\n          autoCapitalize={'none'}\n          keyboardType={'email-address'}\n          onSubmitEditing={_login}\n        />\n        <TextInput\n          style={Styles.form_input}\n          value={password}\n          placeholder={lang('Password')}\n          secureTextEntry\n          onChangeText={(text) => setPassword(text)}\n          onSubmitEditing={_login}\n        />\n        <TouchableOpacity onPress={_login}>\n          <View style={Styles.button}>\n            <Text style={Styles.button_label}>{lang('Sign in')}</Text>\n          </View>\n        </TouchableOpacity>\n        <TouchableOpacity onPress={() => dispatch({type:\"LOGIN_GUEST\"})}>\n          <Text style={Styles.guest_footer_text}>\n            {lang(\"Sign in as guest\")}\n          </Text>\n        </TouchableOpacity>\n      </View>\n      <View style={Styles.login_social}>\n        <View style={Styles.login_social_separator}>\n          <View style={Styles.login_social_separator_line} />\n          <Text style={Styles.login_social_separator_text}>{'*'}</Text>\n          <View style={Styles.login_social_separator_line} />\n        </View>\n        <View style={Styles.login_social_buttons}>\n        </View>\n      </View>\n      {/* <>\n        <TouchableOpacity onPress={() => navigate(\"RegistrationScreen\")}>\n          <Text style={Styles.login_footer_text}>\n            {\"Don't have an account? \"}\n            <Text style={Styles.login_footer_link}>{'Sign up'}</Text>\n          </Text>\n        </TouchableOpacity>\n      </> */}\n    </View>\n  );\n};\n\nconst Styles = StyleSheet.create({\n    login_container: {\n      flex: 1,\n      backgroundColor: '#FFF',\n    },\n    login_header: {\n      alignItems: 'center',\n      paddingTop: 30,\n      paddingBottom: 50,\n      backgroundColor: '#208AEC',\n    },\n    login_header_logo: {\n      width: 220,\n      resizeMode: 'contain',\n    },\n    login_header_text: {\n      marginTop: 15,\n      color: '#f0f0f0',\n      fontSize: 16,\n    },\n    login_header_text_bold: {\n      color: '#fff',\n      fontWeight: 'bold',\n    },\n    login_wrapper: {\n      flex: 1,\n      justifyContent: 'space-between',\n      paddingVertical: 40,\n      borderTopRightRadius: 12,\n      borderTopLeftRadius: 12,\n      marginTop: -10,\n      backgroundColor: '#fff',\n      alignItems: 'center',\n    },\n    form: {\n      width: '100%',\n      maxWidth: 280,\n    },\n    form_input: {\n      height: 44,\n      paddingHorizontal: 20,\n      marginBottom: 20,\n      backgroundColor: '#EDF0F7',\n      borderRadius: 50,\n    },\n    button: {\n      alignItems: 'center',\n      justifyContent: 'center',\n      height: 44,\n      backgroundColor: '#0065A4',\n      borderRadius: 50,\n    },\n    button_label: {\n      color: '#fff',\n      fontSize: 16,\n    },\n    login_social: {\n      width: '100%',\n      maxWidth: 280,\n      marginTop: 20,\n    },\n    login_social_separator: {\n      flexDirection: 'row',\n      alignItems: 'center',\n    },\n    login_social_separator_line: {\n      flex: 1,\n      width: '100%',\n      height: 1,\n      backgroundColor: '#E0E0E0',\n    },\n    login_social_separator_text: {\n      marginHorizontal: 10,\n      color: '#808080',\n      fontSize: 16,\n    },\n    login_social_buttons: {\n      flexDirection: 'row',\n      justifyContent: 'center',\n      marginTop: 20,\n    },\n    login_social_button: {\n      alignItems: 'center',\n      justifyContent: 'center',\n      width: 60,\n      height: 60,\n      marginHorizontal: 12,\n      borderWidth: 1,\n      borderColor: '#E7E7E7',\n      borderRadius: 60,\n    },\n    login_social_icon: {\n      width: 38,\n      height: 38,\n      resizeMode: 'contain',\n    },\n    login_social_facebook: {\n      backgroundColor: '#4267B2',\n      borderColor: '#4267B2',\n    },\n    login_footer_text: {\n      flexDirection: 'row',\n      alignItems: 'center',\n      color: '#808080',\n      fontSize: 14,\n    },\n    guest_footer_text: {\n      flexDirection: 'row',\n      alignSelf: 'center',\n      color: '#808080',\n      fontSize: 15,\n      margin: 15\n    },\n    login_footer_link: {\n      color: '#208AEC',\n      fontSize: 15,\n      fontWeight: 'bold',\n    },\n  });\n  ","import * as React from 'react';\nimport { View, Text } from './Themed';\nimport { StyleSheet, StyleProp, ViewStyle, TextStyle } from 'react-native';\nimport Colors from '../constants/Colors';\n\nexport type SectionParamList = {\n    title?: string,\n    titleStyle?:StyleProp<TextStyle>\n    outerContainerStyle?:StyleProp<TextStyle>\n    containerStyle?:StyleProp<ViewStyle>\n    bodyStyle?:StyleProp<ViewStyle>\n    subtitle?: string\n    withSeparator?: boolean\n    children?: React.ReactNode\n}\n\nexport default function CommonSection(props:SectionParamList){\n  return (\n    <View style={[styles.outerContainer, props.outerContainerStyle]}>\n        <View style={[styles.container, props.containerStyle]}>\n            {props.withSeparator?<View style={styles.separator} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />:undefined}\n            {props.title?<View style={styles.titleView}>\n              <Text style={[styles.title, props.titleStyle]}>{props.title}</Text>\n              <Text style={styles.subtitle}>{props.subtitle}</Text>\n            </View>:undefined}\n            <View style={[styles.bodyView, props.bodyStyle]}>\n            {props.children}\n            </View>\n          </View>\n        </View>\n    )\n}\n\nconst styles = StyleSheet.create({\n  outerContainer:{\n    width:'100%',\n    maxWidth:1080,\n    alignItems:'stretch',\n    backgroundColor:'transparent'\n  },  \n  container: {\n      marginHorizontal:20,\n      marginVertical: 10,\n      backgroundColor:'transparent',\n    },\n    titleView:{\n      width: '100%',\n      flexDirection:'row',\n      backgroundColor:'transparent',\n      marginBottom:5,\n    },\n    title: {\n      flex:1,\n      fontSize: 16,\n    },\n    subtitle: {\n      flex:1,\n      fontSize: 12,\n      textAlign: 'right',\n      marginTop:4\n    },\n    separator: {\n      marginBottom: 20,\n      height: 1,\n      width: '100%',\n    },\n    bodyView:{\n      width: '100%',\n      padding: 20,\n      alignItems: 'center',\n      justifyContent: 'center',\n      borderWidth:1,\n      borderColor:Colors.borderColor,\n      borderRadius:6\n    }\n  });\n  ","import { useCallback, useEffect, useState } from \"react\"\nimport { InfiniteData, useInfiniteQuery, useMutation, useQueryClient } from \"react-query\"\nimport { getMessengerContentList, postMessage, deleteMessengerContent } from \"../../apis\"\nimport { MessengerContent } from \"../../types\"\nimport useWebsocketContext from \"../useWebsocketContext\"\n\nexport type MessengerContentPage = {\n  next?:MessengerContentPage\n  current:MessengerContent[]\n}\n\nexport default function useMessengerContentList(channel_id:number){  \n  const queryClient = useQueryClient()\n  const { data, fetchNextPage } = useInfiniteQuery<MessengerContentPage>(\n    [\"MessengerContentList\", channel_id], \n    async({pageParam})=>getMessengerContentList(channel_id, pageParam).then(current=>({current})), \n    {\n      select:data=>{\n        if(data.pages.length > 1)\n          data.pages[data.pages.length - 2].next = data.pages[data.pages.length - 1]\n        return data;\n      },\n      getNextPageParam:(lastPage)=>lastPage?.current.length?lastPage.current[lastPage.current.length - 1].id:undefined,\n      refetchOnReconnect:false,\n      refetchOnWindowFocus:false\n    }\n  )\n  const { lastJsonMessage } = useWebsocketContext()\n  useEffect(()=>{\n    if(lastJsonMessage !=null && lastJsonMessage['type']=='next_message' && lastJsonMessage['data']['channel'] == channel_id){\n      queryClient.setQueryData<InfiniteData<MessengerContentPage>>([\"MessengerContentList\", channel_id], (_data)=>{\n        if(_data?.pages[0].current && _data?.pages[0].current[0].id != lastJsonMessage['data'].id)\n          _data.pages[0].current = [lastJsonMessage['data'], ..._data?.pages[0].current]\n        return {...(_data || {pages:[], pageParams:[]})}\n      })\n    }\n  }, [lastJsonMessage])\n  return { data, fetchNextPage }\n}\n\nexport function useMessengerContentMutation(){\n  // const queryClient = useQueryClient()\n  const create = useMutation(postMessage, {\n    onSuccess: () => {\n      // queryClient.setQueryData(['MessengerContentList'], (data:any) => ({\n      //   pages: data.pages.slice(0, 1),\n      //   pageParams: data.pageParams.slice(0, 1),\n      // }))\n      // queryClient.invalidateQueries(\"MessengerContentList\")\n    }\n  });\n  const _delete = useMutation(deleteMessengerContent, {\n    onSuccess: (d, variables) => {\n      // queryClient.setQueryData(['MessengerContentList'], (data:any) => ({\n      //   pages: (data.pages as MessengerContent[][]).map(v=>v.filter(v2=>v2.id != variables)),\n      //   pageParams: data.pageParams,\n      // }))\n    }\n  })\n  return { create:create.mutate, delete:_delete.mutate }\n}","import { useMutation, useQuery, useQueryClient } from \"react-query\";\nimport { postBulkMessengerMember, deleteMessengerMember, getMessengerMemberList } from \"../../apis\";\n\nexport default function useMessengerMemberList(channel_id:number){\n  const { data } = useQuery([\"MessengerMemberList\", channel_id] , async()=>await getMessengerMemberList(channel_id))\n  return data\n}\n\n\nexport function useMessengerMemberMutation(){\n  const queryClient = useQueryClient()\n  const invite = useMutation(postBulkMessengerMember, {\n    onSuccess: ()=>{\n      queryClient.invalidateQueries(\"MessengerMemberList\")\n    }\n  })\n\n  const leave = useMutation(deleteMessengerMember, {\n    onSuccess: () => {\n      queryClient.invalidateQueries(\"MessengerChannelList\")\n      queryClient.invalidateQueries(\"MessengerMemberList\")\n    }\n  })\n  return {invite:invite.mutate, leave:leave.mutate}\n}","import React from 'react'\nimport { TouchableOpacity } from \"react-native-gesture-handler\"\nimport CommonSection from \"./CommonSection\"\nimport { Image, Linking, TextStyle } from \"react-native\"\nimport { View, Text } from \"./Themed\"\nimport { Link } from \"../types\"\n\n\n\nexport default ({link, isMobile, hideUrl, align}:{link:Link, isMobile:boolean, hideUrl?:boolean, align?:TextStyle['textAlign']})=>{\n    return <CommonSection containerStyle={{marginHorizontal:0}} bodyStyle={{padding:0}}>\n    <TouchableOpacity onPress={()=>Linking.openURL(link.url)} style={{flexDirection:'row'}} containerStyle={{width:'100%'}}>\n        {link.image && <Image source={{uri:link.image}} resizeMode=\"cover\" style={{ width:'100%', maxWidth:isMobile?120:150, maxHeight:isMobile?120:150, borderWidth:1}}/>}\n        <View style={{flex:1, marginHorizontal:20}}>\n        <Text style={{fontSize:20}}>{link.title}</Text>\n        <Text style={{fontSize:14, textAlign:align}}>{link.description}</Text>\n        {hideUrl!=true && <Text style={{fontSize:12}}>{link.url}</Text>}\n        </View>\n    </TouchableOpacity>\n    </CommonSection>\n}","import React, { createContext, useContext } from \"react\"\nimport { SendJsonMessage } from \"react-use-websocket/dist/lib/types\";\nimport { WebSocketInternalProvider } from \"../../hooks/useWebsocketContext\";\n\nconst WebSocketContext = createContext<{lastJsonMessage:any, sendJsonMessage:SendJsonMessage }>({lastJsonMessage:undefined, sendJsonMessage:()=>{}});\n\nexport const WebSocketProvider = ({disable, children}:{disable?:boolean, children:React.ReactNode})=>{\n  return disable?<></>:<WebSocketInternalProvider path={'messenger/ws/rtc/'} Context={WebSocketContext} useBackground>\n    {children}\n  </WebSocketInternalProvider>\n}\n\nexport default ()=>{\n  const webSocketContext = useContext(WebSocketContext)\n  return webSocketContext\n}\n\n","import React, { useCallback, useRef, useState, useMemo } from \"react\";\n//@ts-ignore\nimport { RTCView, mediaDevices, RTCPeerConnection, MediaStream, RTCSessionDescription, RTCIceCandidate } from \"react-native-webrtc-web-shim\";\n// @ts-ignore\nimport {TURN_SERVER} from \"@env\"\n\n\nconsole.log(TURN_SERVER?\"use turn server\": \"use stun server\")\n\nexport const peerConstraints = {\n\ticeServers: [TURN_SERVER?JSON.parse(TURN_SERVER):{urls: 'stun:stun.l.google.com:19302'}]\n};\n\nexport const sessionConstraints = {\n\tmandatory: {\n\t\tOfferToReceiveAudio: true,\n\t\tOfferToReceiveVideo: true,\n\t\tVoiceActivityDetection: true\n\t}\n};\n\nconst mediaConstraints = {audio:true, video:{framerate:30}}\n\n//@ts-ignore\nexport {MediaStream, RTCPeerConnection, RTCSessionDescription} from \"react-native-webrtc-web-shim\";\n\nconst onICEcandidate = (pc:typeof RTCPeerConnection, message:any)=>{\n\tconst _message = message.data.rtcMessage\n\t\tconst candidate = new RTCIceCandidate(_message);\n\t\tif (pc) {\n\t\t\tconsole.log(\"ICE candidate Added\");\n\t\t\tpc.addIceCandidate(candidate);\n\t\t}\n}\n\nconst sendICEcandidate = (event:any, sendMessage:(data:any)=>void, receiver:string, target:string) => {\n\t// When you find a null candidate then there are no more candidates.\n\t// Gathering of candidates has finished.\n\tif ( !event.candidate ) { return; };\n\t// Send the event.candidate onto the person you're calling.\n\t// Keeping to Trickle ICE Standards, you should send the candidates immediately.\n\tsendMessage({type:'ICEcandidate', receiver, data:{target, rtcMessage:event.candidate}})\n  }\n\nconst BAND_WIDTH = 8000\n\nconst optimizeSdp = (offerDescription:RTCSessionDescription)=>{\n\tvar arr = offerDescription.sdp.split('\\r\\n');\n\tarr.forEach((str:string, i:number) => {\n\t\tif (/^a=fmtp:\\d*/.test(str)) {\n\t\t\tarr[i] = str + `;x-google-max-bitrate=${BAND_WIDTH};x-google-min-bitrate=${BAND_WIDTH};x-google-start-bitrate=${BAND_WIDTH}`;\n\t\t} else if (/^a=mid:(0|video)/.test(str)) { // if with audio then 0=>1\n\t\t\tarr[i] += `\\r\\nb=AS:${BAND_WIDTH}`;\n\t\t}\n\t});\n  \treturn new RTCSessionDescription({\n    \ttype: offerDescription.type,\n    \tsdp: arr.join('\\r\\n'),\n  \t})\n}\n\nconst createOffer = async(pcRefCurrent:{pc?:typeof RTCPeerConnection, receiver:string}, sendMessage:(data:any)=>void, stream:typeof MediaStream, target:string, user?:{name:string})=>{\n\tstream && pcRefCurrent.pc.addStream( stream );\n\tconst offerDescription = optimizeSdp((await pcRefCurrent.pc.createOffer( sessionConstraints )));\n\tawait pcRefCurrent.pc.setLocalDescription( offerDescription );\n\tsendMessage({type:'call', receiver:pcRefCurrent.receiver, data:{target, name:user?.name, rtcMessage:offerDescription}})\n}\n\nexport const useLocalCam = (sendMessage:(data:any)=>void)=>{\n\tconst pcRef = useRef<Record<number,{pc:typeof RTCPeerConnection, receiver:string}>>({})\n\tconst [sender, setSender] = useState<string>()\n\tconst [_stream, setStream] = useState<MediaStream>()\n\tconst isPlay = useMemo(()=>_stream?true:false, [_stream])\n\tconst CustomRTCView = useCallback(React.memo(({style}:{style:any})=>(_stream?<RTCView stream={_stream} style={style} videoProps={{height:'100%'}} />:<></>)) , [_stream])\n\tconst start = useCallback(async(user:{name:string}, stream?:typeof MediaStream, mode?:'camera'|'display')=>{\n\t\tconsole.log(\"start\");\n\t\tif (!_stream || mode!==undefined) {\n\t\t\ttry {\n\t\t\t\tlet newStream:typeof MediaStream;\n\t\t\t\tif(mode == 'camera'){\n\t\t\t\t\tnewStream = await mediaDevices.getUserMedia(mediaConstraints)\n\t\t\t\t}\n\t\t\t\telse if (mode == 'display'){\n\t\t\t\t\tnewStream = await mediaDevices.getDisplayMedia(mediaConstraints)\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tnewStream = stream || await mediaDevices.getUserMedia(mediaConstraints).catch((e:any)=>mediaDevices.getDisplayMedia(mediaConstraints));\n\t\t\t\t}\n\t\t\t\tsetStream(newStream)\n\t\t\t\tObject.entries(pcRef.current).map(([k, v])=>{\n\t\t\t\t\tcreateOffer(v, sendMessage, newStream, 'guest', user)\n\t\t\t\t})\n\t\t\t} catch (e) {\n\t\t\t\tconsole.error(e);\n\t\t\t}\n\t\t}\n\t}, [_stream])\n\tconst stop = useCallback(()=>{\n\t\tconsole.log(\"stop\");\n\t\tif(_stream){\n\t\t\t_stream.getTracks().map((track:any) => track.stop());\n\t\t\tsetStream(undefined)\n\t\t}\n\t}, [_stream])\n\treturn {\n\t\tstart,\n\t\tstop,\n\t\twebsocketOnMessage: async(response:any, user:{name:string})=>{\n\t\t\tlet type = response.type;\n\t\t\tif (type == 'connection'){\n\t\t\t\tsetSender(response.data.channel_name)\n\t\t\t}\n\t\t\tif (type == 'start' && response.data.target=='host'){\n\t\t\t  console.log('1 start')\n\t\t\t  const peerConnection = new RTCPeerConnection( peerConstraints );\n\t\t\t  peerConnection.addEventListener( 'icecandidate', (event:any) => sendICEcandidate(event, sendMessage, response.sender, 'guest'));\n\t\t\t  pcRef.current[response.sender] = {pc:peerConnection, receiver: response.sender}\n\t\t\t  createOffer(pcRef.current[response.sender], sendMessage, _stream, 'guest', user)\n\t\t\t}\n\t\t\t\n\t\t\tif (type == \"answer\" && response.data.target == 'host'){\n\t\t\t  console.log('3 answer')\n\t\t\t  const peerConnection = pcRef.current[response.sender].pc\n\t\t\t  const answerDescription = new RTCSessionDescription(response.data.rtcMessage);\n\t\t\t  await peerConnection.setRemoteDescription( answerDescription );\n\t\t\t  // const streams = pcRef.current.pc.getRemoteStreams()\n\t\t\t  // setMirrorStream(streams[streams.length - 1])\n\t\t\t}\n\t\t\tif (type == \"ICEcandidate\" && response.data.target=='host'){\n\t\t\t\tconst peerConnection = pcRef.current[response.sender].pc\n\t\t\t\tonICEcandidate(peerConnection, response)\n\t\t\t}\n\t\t},\n\t\tCustomRTCView,\n\t\tisPlay,\n\t\tsender,\n\t\t// renderMirrorView,\n\t}\n}\n\nexport const useRemoteCam = (sendMessage:(data:any)=>void)=>{\n\tconst pcRef = useRef<{pc?:RTCPeerConnection, receiver?:string, statsInterval?:any}>({})\n\tconst [user, setUser] = useState<{name:string}>()\n\tconst [_stream, setStream] = useState<MediaStream>()\n\tconst CustomRTCView = useCallback(React.memo((style:any)=>_stream?<RTCView stream={_stream} style={style} videoProps={{height:'100%'}} />:<></>), [_stream])\n\tconst isPlay = useMemo(()=>_stream?true:false, [_stream])\n\tconst start = useCallback((receiver:string)=>{\n\t\tconsole.log(\"start\");\n\t\tif (!pcRef.current.pc) {\n\t\t  pcRef.current.pc = new RTCPeerConnection( peerConstraints );\n\t\t  pcRef.current.receiver = receiver\n\t\t}\n\t\tif (!_stream){\n\t\t\tsendMessage({type:'start', receiver, data:{'target': 'host'}})\n\t\t}\n\t}, [_stream])\n\tconst stop = () => {\n\t\tconsole.log(\"stop\");\n\t\tif (pcRef.current.pc) {\n\t\t  // peerConnection._unregisterEvents();\n\t\t  setStream(undefined)\n\t\t  pcRef.current.pc.close();\n\t\t  pcRef.current.pc = undefined\n\t\t  pcRef.current.receiver = undefined\n\t\t  clearInterval(pcRef.current.statsInterval)\n\t\t}\n\t}\n\treturn {\n\t\tstart,\n\t\tstop,\n\t\twebsocketOnMessage: async(response:any)=>{\n\t\t\tlet type = response.type;\n\t\t\tif (type == 'start' && response.data.target=='guest' && response.sender == pcRef.current?.receiver){\n\t\t\t\tconsole.log('(remote)1 start')\n\t\t\t\tconst peerConnection = pcRef.current.pc\n\t\t\t\tsetUser({name: response.data.name})\n\t\t\t\tpeerConnection.addEventListener('icecandidate', (event:any) => sendICEcandidate(event, sendMessage, response.sender, 'host'));\n\t\t\t\tpeerConnection.addEventListener('iceconnectionstatechange', (e:any)=>{\n\t\t\t\t\tif (pcRef.current.pc.iceConnectionState == 'connected'){\n\t\t\t\t\t\tlet activeStream = false\n\t\t\t\t\t\tpcRef.current.statsInterval = setInterval(async()=>{\n\t\t\t\t\t\t\tconst stats = await pcRef.current.pc.getStats(null)\n\t\t\t\t\t\t\tlet statsOutput = \"\";\n\t\t\t\t\t\t\tlet framePerSecond = undefined\n\t\t\t\t\t\t\tstats.forEach((report:any) => {\n\t\t\t\t\t\t\t\tif (report.type === \"inbound-rtp\" && report.kind === \"video\") {\n\t\t\t\t\t\t\t\t\tObject.keys(report).forEach((statName) => {\n\t\t\t\t\t\t\t\t\t\tstatsOutput += `${statName}: ${report[statName]}\\n`;\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tframePerSecond = report.framesPerSecond\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tconsole.log(activeStream, framePerSecond)\n\t\t\t\t\t\t\tif (framePerSecond != undefined){\n\t\t\t\t\t\t\t\tactiveStream = true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if (activeStream){\n\t\t\t\t\t\t\t\tstop()\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tconsole.log(new Date().toTimeString().split(' ')[0], statsOutput)\n\t\t\t\t\t\t}, 1000);\n\t\t\t\t\t}\n\t\t\t\t\telse if (pcRef.current.pc.iceConnectionState == 'failed'){\n\t\t\t\t\t\tstop()\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t// peerConnection.addTransceiver('audio', {\n\t\t\t\t// \tdirection: 'recvonly'\n\t\t\t\t// });\n\t\t\t\tpeerConnection.addTransceiver('video', {\n\t\t\t\t\tdirection: 'recvonly'\n\t\t\t\t});\n\t\t\t\tawait createOffer({pc:pcRef.current.pc, receiver:response.sender}, sendMessage, _stream, 'host', user)\n\t\t\t}  \n\t\t\tif (type == \"answer\" && response.data.target=='guest' && response.sender == pcRef.current?.receiver){\n\t\t\t\tconsole.log('(remote)3 answer')\n\t\t\t\tconst answerDescription = new RTCSessionDescription(response.data.rtcMessage);\n\t\t\t\tawait pcRef.current.pc.setRemoteDescription( answerDescription );\n\t\t\t\tconst streams = pcRef.current.pc.getRemoteStreams()\n\t\t\t\tsetStream(streams[streams.length - 1])\n\t\t\t\tsendMessage({type:'end', receiver:pcRef.current.receiver, data:{}})\n\t\t\t}\n\t\t\tif (type == \"call\" && response.sender == pcRef.current?.receiver){\n\t\t\t  console.log('2 call')\n\t\t\t  const peerConnection = pcRef.current.pc\n\t\t\t  setUser({name:response.data.name})\n\t\t\t  if (!peerConnection)\n\t\t\t\treturn\n\t\t\t  peerConnection.addEventListener( 'icecandidate', (event:any) => sendICEcandidate(event, sendMessage, response.sender, 'host'));\n\t\t\t  const offerDescription = new RTCSessionDescription(response.data.rtcMessage);\n\t\t\t  await peerConnection.setRemoteDescription( offerDescription );\n\t\t\t  const answerDescription = await peerConnection.createAnswer( sessionConstraints );\n\t\t\t  await peerConnection.setLocalDescription( answerDescription );\n\t\t\t  sendMessage({type:'answer', receiver:pcRef.current.receiver, data:{target:'host', rtcMessage:peerConnection.localDescription}})\n\t\t\t  // Here is a good place to process candidates.\n\t\t\t  const streams = pcRef.current.pc.getRemoteStreams()\n\t\t\t  setStream(streams[streams.length - 1])\n\t\t\t}\n\t\t\tif (type == \"ICEcandidate\" && response.data.target=='guest' && response.sender == pcRef.current?.receiver)\n\t\t\t  onICEcandidate(pcRef.current.pc, response)\n\t\t},\n\t\tCustomRTCView,\n\t\tuser,\n\t\tisPlay\n\t}\n}","import {StyleSheet} from \"react-native\";\nexport {useLocalCam, useRemoteCam} from \"./p2p\"\n\nexport const camStyle = StyleSheet.create({\n\tcontainer:{ flex: 1},\n\tcam:{ flex: 1, height:'100%'},\n\tbottonContainer: {position:\"absolute\", bottom:0, justifyContent:'flex-end'},\n\tbuttonBar: { flexDirection: \"row\", justifyContent: \"space-around\" },\n\tlabel: {backgroundColor:'#0008', color:'white', paddingHorizontal:5},\n})","import React, { useEffect } from \"react\";\nimport {Button, View, Text} from \"react-native\";\nimport useWebsocketContext from \"./useWebsocketContext\";\nimport { useLocalCam, camStyle} from \"./webrtc\";\n\n\nexport default (props:{user?:{name:string}|null, mode?:'camera'|'display'|null})=>{\n  const {lastJsonMessage, sendJsonMessage} = useWebsocketContext()\n  const {start, stop, websocketOnMessage, CustomRTCView, isPlay} = useLocalCam(sendJsonMessage)\n  useEffect(()=>{\n    props.user && lastJsonMessage && websocketOnMessage(lastJsonMessage, props.user)\n  }, [lastJsonMessage, props.user])\n  useEffect(()=>{\n    if(props.mode && !isPlay){\n      props.user && start(props.user, undefined, props.mode)\n    }\n    else if(props.mode===null && isPlay){\n      stop()\n    }\n    return ()=>{isPlay && stop()}\n  }, [isPlay, props.user, props.mode])\n  return (\n    <View style={camStyle.container}>\n      <CustomRTCView style={camStyle.cam}/>\n      <View style={camStyle.bottonContainer}>\n        <View style={camStyle.buttonBar}>  \n        </View>\n        <View style={{flexDirection:'row'}}><Text style={camStyle.label}>{props.user?.name}</Text></View>\n        <View style={camStyle.buttonBar}>\n          {props.mode === undefined && !isPlay && <Button title=\"Start\" onPress={()=>props.user && start(props.user)} />}\n          {props.mode === undefined && isPlay && <Button title=\"Stop\" onPress={stop} />}\n        </View>\n      </View>\n    </View>\n  );\n}\n","import React, { useState, useEffect, } from \"react\";\nimport {Button,Text, TextInput, View} from \"react-native\";\nimport useWebsocketContext from \"./useWebsocketContext\";\nimport { useRemoteCam, camStyle} from \"./webrtc\";\n\nexport default (props:{receiver?:string})=>{\n  const [receiver, setReceiver] = useState('')\n  const {lastJsonMessage, sendJsonMessage} = useWebsocketContext()\n  const {start, stop, websocketOnMessage, CustomRTCView, isPlay, user} = useRemoteCam(sendJsonMessage)\n  useEffect(()=>{\n    lastJsonMessage && websocketOnMessage(lastJsonMessage)\n  }, [lastJsonMessage])\n  useEffect(()=>{\n    if(props.receiver){\n      start(props.receiver)\n    }\n    return ()=>stop()\n  }, [props.receiver])\n  return (\n    <View style={camStyle.container}>\n      <CustomRTCView style={camStyle.cam}/>\n      <View style={camStyle.bottonContainer}>\n        <View style={camStyle.buttonBar}>\n        </View>\n        <View style={{flexDirection:'row'}}>{\n          (props.receiver || isPlay)?\n          <Text style={camStyle.label}>{user?.name || 'loading...'}</Text>:\n          <>\n            <Text style={{borderWidth:1}}>Receiver:&nbsp;</Text>\n            <TextInput style={{borderWidth:1, flex:1}} value={receiver} onChangeText={setReceiver}/>\n          </> \n        }</View>\n        <View style={camStyle.buttonBar}>\n          {props.receiver === undefined && !isPlay && <Button title=\"Start\" onPress={()=>start(receiver)} />}\n          {props.receiver === undefined && isPlay && <Button title=\"Stop\" onPress={stop} />}\n        </View>\n      </View>\n    </View>\n  );\n}\n\n","import React, {useEffect, useState} from 'react';\nimport { StyleSheet, View } from 'react-native';\nimport { View as ThemedView } from '../../../components/Themed' \nimport Colors from '../../../constants/Colors';\nimport {default as useRtcContext, WebSocketProvider as RtcProvider} from \"../../../lib/react-native-webrtc/useWebsocketContext\";\nimport LocalCam from '../../../lib/react-native-webrtc/LocalCam';\nimport RemoteCam from '../../../lib/react-native-webrtc/RemoteCam';\nimport useResizeWindow from '../../../hooks/useResizeWindow';\nimport useAuthContext from '../../../hooks/useAuthContext';\nimport { TouchableOpacity } from 'react-native-gesture-handler';\nimport CommonButton from '../../../components/CommonButton';\n\ntype VideoType = 'camera'|'display'|null\ntype VideoCallProps = {channel_id:number, setDisable:(disable:boolean)=>void, disable?:boolean}\n\n\nconst VideoView = (props:{\n  scale:string,\n  focusGuest?:string,\n  setFocusGuest:(focusGuest?:string)=>void\n  receiver?:string\n  children:React.ReactNode\n})=>{\n  return <View style={[{maxWidth:props.scale, maxHeight:props.scale, borderWidth:1, borderColor:Colors.borderColor, backgroundColor:'gray', flexDirection:'row', flexGrow:1}, (props.focusGuest == undefined || props.focusGuest == props.receiver)?{}:{width:0, height:0}]}>\n    <TouchableOpacity style={{flex:1}} containerStyle={{flex:1, justifyContent:'center'}} onPress={()=>props.setFocusGuest(props.focusGuest?undefined:props.receiver)}>\n    {props.children}\n    </TouchableOpacity>\n  </View>\n    \n  \n}\n\nconst VideoCallContainer = ({channel_id, disable, setDisable}:VideoCallProps)=>{\n  const {auth} = useAuthContext()\n  const [videoMode, setVideoMode] = useState<VideoType>(null)\n  const [guests, setGuests] = useState<string[]>([])\n  const [focusGuest, setFocusGuest] = useState<string>()\n  const windowType = useResizeWindow()\n  const { lastJsonMessage, sendJsonMessage } = useRtcContext()\n  useEffect(()=>{\n    if(lastJsonMessage !=null){\n      if(lastJsonMessage['type']=='connection'){\n        sendJsonMessage({'type':'broadcast', 'data':{'channel_id':channel_id}})\n      }\n      if(lastJsonMessage['type']=='broadcast_guest' || lastJsonMessage['type']=='broadcast_host'){\n        setGuests([...guests, lastJsonMessage['sender']])\n      }\n      if(lastJsonMessage['type']=='broadcast_disconnect'){\n        const channel_name = lastJsonMessage['sender']\n        const exist = guests.find(v=>v == channel_name)\n        exist && setGuests(guests.filter(v=>v != channel_name))\n      }\n    }\n  }, [lastJsonMessage])\n  const scale = focusGuest?'100%':`${100 / Math.max(2, Math.ceil(Math.sqrt(guests.length + 1)))}%`\n  const toggleVideoMode = (mode:VideoType)=>{\n    setVideoMode(videoMode!=mode?mode:null)\n  }\n  return lastJsonMessage !==undefined ?\n    <ThemedView style={[\n      {aspectRatio:!disable?16/9:0, borderColor:Colors.borderColor, borderRadius:10},\n      windowType=='landscape'?{flexShrink:0.5, height:'100%', borderLeftWidth:1, paddingBottom:65}:{maxHeight:'36%', width:'100%', borderBottomWidth:1}\n    ]}>\n      <View style={{aspectRatio:16/9, backgroundColor:'white', flexWrap:'wrap', flexDirection:'row', width:'100%', height:'100%'}}>\n        {guests.map((receiver, i)=><VideoView scale={scale} focusGuest={focusGuest} setFocusGuest={setFocusGuest} receiver={receiver}>\n          <RemoteCam receiver={receiver}/>\n        </VideoView>\n        )}\n        <VideoView scale={scale} focusGuest={focusGuest} setFocusGuest={setFocusGuest} receiver={auth.user?.name}>\n          <LocalCam user={auth.user} mode={videoMode}/>\n        </VideoView>\n      </View>\n      <ThemedView style={[\n          {position:'absolute', alignItems:'center', justifyContent:'flex-end', width:'100%',flexDirection:'row'},\n          windowType=='landscape'?{bottom:0, paddingVertical:15, paddingHorizontal:19}:{backgroundColor:'transparent'}\n        ]}>\n        <CommonButton title={'⏺️'} onPress={()=>toggleVideoMode('camera')}/>\n        <CommonButton title={'🖥️'} onPress={()=>toggleVideoMode('display')}/>\n        <CommonButton title={'📹'} onPress={()=>setDisable(true)}/>\n      </ThemedView>\n    </ThemedView>:\n  <></>\n  }\n  \nexport default React.memo(({channel_id, disable, setDisable}:VideoCallProps)=>{\n  return <RtcProvider disable={disable}>\n    <VideoCallContainer channel_id={channel_id} disable={disable} setDisable={setDisable}/>\n  </RtcProvider>\n})\n","import React, {useCallback, useEffect, useLayoutEffect, useMemo, useRef, useState} from 'react';\nimport { StackScreenProps } from '@react-navigation/stack';\nimport { Platform, StyleSheet, View } from 'react-native';\nimport CommonSection from '../../../components/CommonSection';\nimport { FlatList, TextInput } from 'react-native-gesture-handler';\nimport CommonButton from '../../../components/CommonButton';\nimport useMessengerContentList, { MessengerContentPage, useMessengerContentMutation } from '../../../hooks/lists/useMessengerContent.List';\nimport useAuthContext from '../../../hooks/useAuthContext';\nimport HeaderRight from '../../../components/HeaderRight';\nimport useMessengerMemberList, { useMessengerMemberMutation } from '../../../hooks/lists/useMessengerMemberList';\nimport { navigate } from '../../../navigation';\nimport Colors from '../../../constants/Colors';\nimport useColorScheme from '../../../hooks/useColorScheme';\nimport { Text, View as ThemedView } from '../../../components/Themed' \nimport Hyperlink from 'react-native-hyperlink'\nimport useMessengerChannelList from '../../../hooks/lists/useMessengerChannelList';\nimport useIsMobile from '../../../hooks/useIsMobile';\nimport LinkPreview from '../../../components/LinkPreview';\nimport lang from '../../../lang'\nimport Avatar from '../../../components/Avatar';\nimport VideoCallSection from './VideoCallSection';\nimport useResizeWindow from '../../../hooks/useResizeWindow';\n\nfunction humanFileSize(size:number) {\n  var i = size == 0 ? 0 : Math.floor(Math.log(size) / Math.log(1024));\n  return (size / Math.pow(1024, i)).toFixed(2) + ' ' + ['B', 'kB', 'MB', 'GB', 'TB'][i];\n}\n\nfunction uploadFile(){\n  return new Promise<Blob|undefined>((resolve, reject)=>{\n    if (Platform.OS == 'web'){\n      var input = document.createElement('input');\n      input.type = 'file';\n      input.onchange = e => { \n        resolve((e.target as any).files[0])\n      }\n      input.onabort = reject\n      input.onerror = reject\n      input.click();\n    }\n    else\n      resolve(undefined)\n  })\n}\n\nconst MessengerContentPageItem = React.memo((props:MessengerContentPage & {ownerId?:number})=>{\n  const isMobile = useIsMobile()\n  let nextPage = props.next;\n    while(nextPage?.next && nextPage.current.length==0){\n      nextPage = nextPage.next\n    }\n    const nextContent = nextPage?.current[0]\n    return <View style={{flexDirection: 'column-reverse'}}>\n      \n      {props.current.map((content, index2)=>{\n        const next = index2 + 1 < props.current.length?props.current[index2+1]:nextContent\n        const created:string = content.created.slice(0, 16)\n        const date = created.slice(0, 10)\n        const isSystem = content.user == null\n        const isFirst = next==undefined || (content.user != next.user || created != next.created.slice(0, 16))\n        const isSelf = props.ownerId == content.user\n        const dayChanged = next==undefined || date != next.created.slice(0, 10)\n        const message = content.message_set[0]\n        if (isSystem)\n          return <View key={content.id} style={{flexDirection:'row', justifyContent:'center', width:'100%', marginVertical:5}}>\n            <Text>{message.content}</Text>\n          </View>\n        return <View key={content.id}>\n          {dayChanged?<View style={{flexDirection:'row', justifyContent:'center', width:'100%'}}><Text>{date}</Text></View>:undefined}\n          <View key={content.id} style={{flexDirection:'row', justifyContent:isSelf?'space-between':'flex-start', width:'100%'}}>\n            {isFirst && !isSelf? <View style={{marginTop:3, marginLeft:12}}><Avatar name={content.name} userId={content.user} size={36}/></View>:<View style={{width:48}}/>}\n            <CommonSection outerContainerStyle={{width:undefined, maxWidth:'90%'}} title={isFirst?content.name:undefined} titleStyle={{flex:undefined}} bodyStyle={{padding:10}} subtitle={`${created.slice(11)}`}>\n              {/* @ts-ignore */}\n              <Hyperlink linkDefault={ true } style={{wordBreak:\"break-word\"}} linkStyle={{color: '#12b886'}}>\n                <Text selectable>{message.content}</Text>\n              </Hyperlink>\n              {content.file_set.map((file, fileIndex)=><LinkPreview key={fileIndex} link={{title:`📥 ${file.filename}`, url:file.file, description:humanFileSize(file.filesize), image:null}} hideUrl align='right' isMobile={isMobile}/>)}\n              {content.link_set.map((link, linkIndex)=><LinkPreview key={linkIndex} link={link} isMobile={isMobile}/>)}              \n            </CommonSection>\n          </View>\n        </View>\n      })}\n    </View>\n\n})\n\nexport default function ChatScreen({navigation, route}: StackScreenProps<any, 'Chat'>) {\n  const channel_id = route?.params?.id\n  const height = useRef(0)\n  const inputRef = useRef<TextInput>(null)\n  const {auth} = useAuthContext()\n  const channel = useMessengerChannelList(auth)?.find(v=>v.id==parseInt(channel_id))\n  const {data, fetchNextPage } = useMessengerContentList(channel_id)\n  const memberList = useMessengerMemberList(channel_id)\n  const member_id = useMemo(()=>memberList?.find(v=>v.user == auth.user?.id)?.id, [auth, memberList])\n  const windowType = useResizeWindow()\n  const messengerMemberMutation = useMessengerMemberMutation()\n  const [value, setValue] = useState('')\n  const [autoFocus, setAutoFocus] = useState(true)\n  const [videoMode, setVideoMode] = useState<boolean>(false)\n  const theme = useColorScheme()\n  const postValue = ()=>{\n    if (value.length>0){\n      contentMutation.create({channel:channel_id, user:auth.user?.id, content:value})\n      setValue('')\n      setAutoFocus(true)\n    }\n  }\n  const contentMutation = useMessengerContentMutation()\n\n  useLayoutEffect(() => {\n    navigation.setOptions({\n      headerRight: ()=> <HeaderRight extra={[\n        {title:lang('invite'), onPress:()=>{navigate(\"InviteScreen\", {id:channel_id})}},\n        {title:lang('leave'), onPress:()=>{member_id && messengerMemberMutation.leave(member_id);back()}}\n      ]}/>,\n      title: channel?.name\n    });\n  }, [navigation, route, member_id]);\n\n  const renderItem = useCallback(({item, index}:{item:MessengerContentPage, index:number})=><MessengerContentPageItem {...item} ownerId={auth.user?.id}/>, [auth])\n  \n  const back = ()=>{\n    if(navigation.canGoBack())\n        navigation.goBack()\n      else{\n        navigation.navigate('HomeScreen', {tab:2})\n      }\n  }\n  useEffect(()=>{\n    if (!(channel_id))\n      back()\n  }, [])\n  useEffect(()=>{\n    if(autoFocus){\n      (inputRef.current as any).focus()\n      setAutoFocus(false)\n    }\n  }, [autoFocus])\n\n  return <View style={{flex:1, alignItems:'center', flexDirection:windowType=='landscape'?'row-reverse':'column'}}>\n    <VideoCallSection channel_id={channel_id} setDisable={(d)=>setVideoMode(!d)} disable={!videoMode}/>\n    <View style={[{flex:videoMode?undefined:1, flexShrink:1}, windowType=='landscape'?{minWidth:320, height:'100%'}:{width:'100%'}]}>\n      <FlatList\n        style={{flexDirection: 'column-reverse'}}\n        contentContainerStyle={{padding:10, flexGrow:1, flexDirection: 'column-reverse'}}\n        data={data?.pages}\n        renderItem={renderItem}\n        onScroll={(e)=>{\n          if (e.nativeEvent.contentOffset.y + e.nativeEvent.contentSize.height - height.current < 1)\n            fetchNextPage()\n        }}\n        onLayout={(p)=>{height.current = p.nativeEvent.layout.height}}\n      />\n      <ThemedView style={{bottom:0, alignItems:'center', width:'100%',flexDirection:'row', paddingTop:15, paddingBottom:10, paddingHorizontal:19}}>\n        <TextInput ref={inputRef} value={value} onChangeText={setValue} style={{\n          flex:1, borderWidth:1, height:40, borderRadius:6, borderColor:Colors.borderColor, backgroundColor:Colors[theme].background, color:Colors[theme].text\n        }} onSubmitEditing={postValue} blurOnSubmit={true}/>\n        <CommonButton title={'💬'} onPress={postValue}/>\n        <CommonButton title={'📤'} onPress={()=>uploadFile().then(f=>{\n          contentMutation.create({channel:channel_id, user:auth.user?.id, content:'', file:f})\n        })}/>\n        {!videoMode && <CommonButton title={'📹'} onPress={()=>setVideoMode(!videoMode)}/>}\n      </ThemedView>\n    </View>\n  </View>\n}","import React, {useCallback, useRef} from 'react';\nimport { StackScreenProps } from '@react-navigation/stack';\nimport { StyleSheet, Text, Button, View} from 'react-native';\n\n\nexport default function TabOneScreen({\n  navigation\n}: StackScreenProps<any, 'TabOne'>) {\n  return <View style={{padding:10}}>\n    \n  </View>\n}\n\nconst styles = StyleSheet.create({\n  Panel_Button_Text: {\n    textAlign: 'center',\n    color: '#fff',\n    fontSize: 21\n  },\n  Panel_Holder: {\n    borderWidth: 1,\n    borderColor: '#888',\n    marginVertical: 5\n  }\n})","import React, { useMemo } from 'react';\n\nimport { TextProps, StyleProp } from 'react-native';\nimport {View, Text } from './Themed'\nimport useResizeWindow from '../hooks/useResizeWindow';\n\ntype Props = {\n  name: string,\n  width?:number,\n  children: React.ReactNode\n  textStyle?: StyleProp<TextProps>\n}\n\nexport default function RowField(props:Props) {\n  const windowType = useResizeWindow()\n  const rowStyle = useMemo(()=>windowType=='landscape'?\n    {flexDirection:'row', alignItems: 'center', justifyContent:'space-between'}:\n    {flexDirection:'column', alignItems:'flex-start'} as any\n  , [windowType])\n  return (\n    <View style={[{paddingVertical:5, width:'100%'}, rowStyle]}>\n        <Text style={[windowType=='landscape'?{flex:1}:{width:'100%'},{paddingHorizontal: 15, fontSize:16}, props.textStyle]}>{props.name}</Text>\n        <View style={[windowType=='landscape'?{flex:6}:{width:'100%'},{paddingHorizontal: 15}]}>\n          <View style={{width:props.width}}>\n            {props.children}\n          </View>\n        </View>\n    </View>\n  )\n}","import React from 'react';\nimport { StyleProp, TextStyle } from 'react-native';\nimport { CustomTextInputProps } from '../types';\nimport CommonTextInput from './CommonTextInput';\nimport RowField from './RowField';\n\nexport default function TextField(props:CustomTextInputProps & {name: string, width?:any, textStyle?:StyleProp<TextStyle>}) {\n  return (\n    <RowField name={props.name} width={props.width} textStyle={props.textStyle}>\n      <CommonTextInput {...props} />\n   </RowField>\n  )\n}","import React, {useState, useEffect } from 'react';\nimport { StackScreenProps } from '@react-navigation/stack';\nimport { StyleSheet } from 'react-native';\nimport CommonSection from '../components/CommonSection';\nimport { View, Text } from '../components/Themed';\nimport CommonButton from '../components/CommonButton';\n// import useBoardChannelList, { useBoardChannelMutation } from '../hooks/lists/useBoardChannelList';\nimport useAuthContext from '../hooks/useAuthContext';\nimport { navigate } from '../navigation';\nimport { Channel } from '../types';\nimport useMessengerChannelList, { useMessengerChannelMutation } from '../hooks/lists/useMessengerChannelList';\nimport TextField from '../components/TextField';\nimport lang from '../lang'\n\nexport default function ChannelEditScreen({navigation, route}: StackScreenProps<any, 'ChannelEdit'>) {\n  const id = route?.params?.id\n  const type = route?.params?.type\n  const {auth} = useAuthContext()\n  const channelList = useMessengerChannelList(auth)\n  const channelMutation = useMessengerChannelMutation()\n  const channel = channelList?.find(v=>v.id==id)\n  const [name, setName] = useState('')\n  const [description, setDescription] = useState('')\n  const back = ()=>{\n    if(navigation.canGoBack())\n        navigation.goBack()\n      else{\n        navigation.replace('Main')\n      }\n  }\n  useEffect(()=>{\n    if (channel){\n      setName(channel.name)\n      setDescription(channel?.description || '')\n    }\n  }, [channel])\n  return <CommonSection outerContainerStyle={{alignSelf:'center'}}>\n    <View style={{justifyContent:'space-around'}}>\n    <Text style={{fontSize:20}}>{lang('Channel')}</Text>\n    </View>\n    <View style={styles.separator} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\n    <View style={{width:'100%'}}>\n      <TextField name={lang('Channel Name')} value={name} setValue={setName} width={'60%'}/>\n      <TextField name={lang('Description')} value={description} setValue={setDescription} multiline width={'60%'}/>\n    </View>\n    <View style={{width:'100%', flexDirection:'row', justifyContent:'flex-end'}}>\n      <CommonButton title={lang('save')} onPress={()=>{\n        if(auth?.user?.id && auth.groupId){\n          const newChannel:Channel = {id, name, description, type, owner:auth?.user?.id, group:auth.groupId};\n          (id?channelMutation.update(newChannel):channelMutation.create(newChannel)).then(v=>navigate(\"Main\", {\n            screen:v.type == 'messenger'?'MessengerScreen':'BoardScreen',\n            params:{id:v.id}\n          }))\n        }\n      }}/>\n      <CommonButton title={lang('cancel')} style={{marginHorizontal:5}} onPress={back}/>\n    </View>\n  </CommonSection>\n}\n\nconst styles = StyleSheet.create({\n  field:{\n    width:'50%',\n    flexDirection:'row',\n    padding:10,\n  },\n  separator: {\n    marginBottom: 20,\n    height: 1,\n    width: '100%',\n  },\n})","import React, {useRef,MutableRefObject, useMemo, useState } from 'react';\nimport { StackScreenProps } from '@react-navigation/stack';\nimport { View, Text } from '../components/Themed';\nimport CommonSection from '../components/CommonSection';\nimport useAuthContext from '../hooks/useAuthContext';\nimport useUserMembershipList from '../hooks/lists/useUserMembershipList';\nimport { UserMembership } from '../types';\nimport CommonButton from '../components/CommonButton';\nimport useMessengerMemberList, { useMessengerMemberMutation } from '../hooks/lists/useMessengerMemberList';\nimport { renderMemberItem } from '../tabs/MemberTab';\nimport { navigate } from '../navigation';\nimport lang from  '../lang'\n\nconst InviteItem = (props:{item:UserMembership, selectedRef:MutableRefObject<Set<number>>})=>{\n  const [selected, setSelected] = useState(props.selectedRef.current.has(props.item.id))\n  return <View style={selected?{borderWidth:1, borderColor:'blue'}:{}}>\n    {renderMemberItem(props.item, ()=>{\n      if (selected){\n        setSelected(false)\n        props.selectedRef.current.delete(props.item.id)\n      }\n      else{\n        setSelected(true)\n        props.selectedRef.current.add(props.item.id)\n      }\n    })}\n  </View>\n\n}\n\nexport default function InviteScreen({navigation, route}: StackScreenProps<any, 'Invite'>) {\n  const id = route?.params?.id\n  const {auth} = useAuthContext()\n  const userList = useUserMembershipList(auth)\n  const memberList = useMessengerMemberList(id)\n  const messengerMemberMutation = useMessengerMemberMutation()\n  const selectedRef = useRef<Set<number>>(new Set())\n  const data = useMemo(()=>{\n    const memberSet = new Set(memberList?.map(v=>v.user))\n    return userList?.filter(v=>!memberSet.has(v.id))\n  }, [userList, memberList])\n\n\n  const back = ()=>{\n    if(navigation.canGoBack())\n      navigation.goBack()\n    else if (id)\n      navigate(\"ChatScreen\", {id})\n    else\n      navigation.replace('Main')\n  }\n\n  return <CommonSection outerContainerStyle={{alignSelf:'center'}}>\n    <View style={{backgroundColor:'white', 'width': '50%'}}>\n    {data?.map((item, index)=><InviteItem key={index} item={item} selectedRef={selectedRef}/>)}\n    </View>\n    <View style={[{width:'50%', flexDirection:'row', padding:10,}, {justifyContent:'flex-end'}]}>\n      <CommonButton title={lang('invite')} onPress={()=>{\n        messengerMemberMutation.invite({\n          channel_id:id,\n          user_ids:[...selectedRef.current]\n        })\n        back()\n      }}/>\n      <CommonButton title={lang('cancel')} onPress={back}/>\n    </View>\n  </CommonSection>\n}\n\n","import LoginScreen from \"./main/LoginScreen\";\nimport ChatScreen from \"./main/ChatScreen\";\nimport HomeScreen from \"./main/HomeScreen\";\nimport TabOneScreen from \"./main/TabOneScreen\";\n// import BoardScreen from \"../lib/blacktokki-board/BoardScreen\";\n// import BoardEditScreen from \"../lib/blacktokki-board/BoardEditScreen\";\nimport ChannelEditScreen from \"./ChannelEditScreen\"\nimport { Screens } from \"../types\";\nimport InviteScreen from \"./InviteScreen\";\nimport ProfileScreen from \"./ProfileScreen\";\nimport lang from \"../lang\"\n\nexport const main = {\n    HomeScreen:{\n        title:lang('home'),\n        component:HomeScreen,\n        path:'home',\n    },\n    ChatScreen:{\n        title:lang('chat'),\n        component:ChatScreen,\n        path:'chat'\n    },\n    // BoardScreen:{\n    //     title:'board',\n    //     component:BoardScreen,\n    //     path:'board'\n    // },\n    TabOneScreen:{\n        title:'tab one',\n        component:TabOneScreen,\n        path:'one'\n    },\n} as Screens\n\nexport const login = {\n    LoginScreen:{\n        path: 'login',\n        title: lang('Sign in'),\n        component:LoginScreen\n    },\n} as Screens\n\nexport const modal = {\n    // BoardEditScreen:{\n    //     title:'board',\n    //     component:BoardEditScreen,\n    //     path:'modal/board'\n    // },\n    ChannelEditScreen:{\n        title:lang('channel'),\n        component:ChannelEditScreen,\n        path:'modal/channel'\n    },\n    InviteScreen:{\n        title:lang('invite'),\n        component:InviteScreen,\n        path:'modal/invite'\n    },\n    ProfileScreen:{\n        title:lang('profile'),\n        component:ProfileScreen,\n        path:'modal/profile'\n    }\n} as Screens","import React, {useLayoutEffect} from 'react';\nimport { StackScreenProps } from '@react-navigation/stack';\nimport { StyleSheet, Text, Button, View} from 'react-native';\nimport { Text as StyledText } from 'react-native-paper';\nimport {TabViewNavigator} from '../../navigation/DrawerNavigator';\nimport useResizeWindow from '../../hooks/useResizeWindow';\nimport { bottomTabs } from '../../tabs';\nimport { navigate } from '../../navigation';\nimport HeaderRight from '../../components/HeaderRight';\nimport TextButton from '../../components/TextButton';\nimport Colors from '../../constants/Colors';\nimport useColorScheme from '../../hooks/useColorScheme';\nimport lang from '../../lang'\n\n// navigate(\"BoardEditScreen\", {channel_id:item.channel, id:item.id})\n// deleteBoardContent(item.id).then(()=>navigate('BoardScreen', {id:item.channel}))\n\nexport default function HomeScreen({navigation, route}: StackScreenProps<any, 'Home'>) {\n  const windowType = useResizeWindow();\n  const theme = useColorScheme()\n  const color = Colors[theme].text\n  const options = [\n    {title:lang('member'), headerRight:()=><HeaderRight/>},\n    {title:lang('messenger'), headerRight:()=><HeaderRight extra={[{title:lang('create'), onPress:()=>navigate(\"ChannelEditScreen\", {type:\"messenger\"})}]}/>},\n    // {title:'board', headerRight:()=><HeaderRight extra={[{title:'create', onPress:()=>navigate(\"ChannelEditScreen\", {type:\"board\"})}]}/>},\n    {title:'config', headerRight:()=><HeaderRight/>}\n  ]\n  \n  useLayoutEffect(() => {\n    const index = route?.params?.tab | 0\n    navigation.setOptions(windowType == 'portrait'?options[index]:{\n      title: lang('home'),\n      headerRight: ()=><HeaderRight/>\n    });\n  }, [navigation, route, windowType]);\n  return <>\n    {windowType == 'landscape'?\n      <View style={{flex:1, justifyContent:'center', alignItems:'center'}}>\n        <View style={{width:'80%', height:'80%'}}>\n          <StyledText style={{fontSize:32, color}}>Tokki Tok</StyledText>\n          <View style={{backgroundColor:Colors.borderColor, height:1, width:'100%'}}/>\n          <View style={{flex:1, alignItems:'flex-start'}}>\n            {/* <Text style={{fontSize:20, color:'gray'}}>Welcome! This is a messenger for teams.</Text>*/}\n            <Text style={{fontSize:24}}> </Text>\n            <Text style={{fontSize:24, fontWeight:'500', color}}>{lang('Quick Start')}</Text>\n            <TextButton title={lang('+ New Messenger')} textStyle={{fontSize:20, color}} style={{paddingLeft:0, borderRadius:20}} onPress={()=>navigate(\"ChannelEditScreen\", {type:\"messenger\"})}/>\n            {/* <TextButton title='+ New Board' textStyle={{fontSize:20}} style={{paddingLeft:0, borderRadius:20}} onPress={()=>navigate(\"ChannelEditScreen\", {type:\"board\"})}/> */}\n          </View>\n        </View>\n      </View>:<></>}\n      <View style={windowType == 'portrait'?{flex:1}:{width:0, flex:0}}>\n        <TabViewNavigator tabs={bottomTabs} tabBarPosition=\"bottom\" index={parseInt(route.params?.['tab'] || 0)} onTab={(index)=>{navigation.setParams({tab:index})}}/>\n      </View>\n  </>\n}\n\n","import React, { useEffect } from 'react';\nimport { StackScreenProps } from '@react-navigation/stack';\nimport { View} from '../components/Themed';\nimport Profile from '../components/Profile';\nimport useAuthContext from '../hooks/useAuthContext';\nimport useUserMembershipList from '../hooks/lists/useUserMembershipList';\nimport { useMessengerChannelMutation } from '../hooks/lists/useMessengerChannelList';\nimport CommonButton from '../components/CommonButton';\nimport { DirectChannel } from '../types';\nimport { navigate } from '../navigation';\nimport lang from '../lang'\n\nexport default function ProfileScreen({\n  navigation, route\n}: StackScreenProps<any, 'Profile'>) {\n  const id = route?.params?.id\n  const {auth} = useAuthContext()\n  const userList = useUserMembershipList(auth)\n  const user = userList?.find(v=>v.id==id)\n  const channelMutation = useMessengerChannelMutation()\n  const back = ()=>{\n    if(navigation.canGoBack())\n        navigation.goBack()\n      else{\n        navigation.replace('Main')\n      }\n  }\n  useEffect(()=>{\n    if (!(id && user) && userList)\n      back()\n  }, [userList])\n  return user?<View style={{padding:10}}>\n    \n    <Profile username={user.username} name={user.name} userId={user.id} />\n    <CommonButton title={lang('create messenger')} onPress={()=>{\n      if(auth?.user?.id && auth.groupId){\n        const newChannel:DirectChannel = {name:auth.user.id!=user.id?`${auth.user.name}, ${user.name}`:auth.user.name, type:'messenger', owner:auth?.user?.id, group:auth.groupId, counterpart:user.id};\n        channelMutation.direct(newChannel).then(v=>navigate(\"Main\", {screen:\"ChatScreen\", params: {id:v.id}}))\n      }\n    }}/>\n  </View>:<></>\n}\n","import React, { Context, createContext,  useContext, useEffect, useState } from \"react\"\nimport useWebSocket from \"react-use-websocket\"\nimport { SendJsonMessage } from \"react-use-websocket/dist/lib/types\"\n// @ts-ignore\nimport {API_URL} from \"@env\"\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\nimport { AppState, AppStateStatus } from \"react-native\";\n\ntype WebsocketContextType = {lastJsonMessage:any, sendJsonMessage:SendJsonMessage }\nconst WebSocketContext = createContext<WebsocketContextType>({lastJsonMessage:undefined, sendJsonMessage:()=>{}});\nconst [SCHEMA, DOMAIN] = `${API_URL}`.split('://')\n\nexport const WebSocketInternalProvider = ({children, path, Context, useBackground}:{children:React.ReactNode, path:string, Context:Context<WebsocketContextType>, useBackground?:boolean})=>{\n  const [token, setToken] = useState<string|null>(null)\n  const [isActive, setIsActive] = useState<boolean>(useBackground || AppState.currentState == 'active')\n  const { lastJsonMessage, sendJsonMessage } = useWebSocket(`${SCHEMA=='https'?'wss':'ws'}://${DOMAIN}/${path}`,{\n    shouldReconnect: (closeEvent) => true,\n    protocols: token?['Authorization',  token]:undefined,\n    onOpen: (e)=>{console.log(`success websocket connection(${path})`)},\n    onClose: (e)=> {console.log(`closed websocket connection(${path})`)},\n  }, isActive && token!=null)\n  useEffect(()=>{\n    AsyncStorage.getItem('Authorization').then(setToken)\n    const onChange = (nextState:AppStateStatus)=>setIsActive(useBackground || nextState == 'active')\n    AppState.addEventListener(\"change\", onChange)\n    return ()=>AppState.removeEventListener(\"change\", onChange)\n  }, [])\n  return (token==null)?<>{children}</>:<Context.Provider value={{lastJsonMessage, sendJsonMessage}}>\n      {children}\n    </Context.Provider>\n}\n\nexport const WebSocketProvider = React.memo(({disable, children}:{disable?:boolean, children:React.ReactNode})=>{\n  return disable?<>{children}</>:<WebSocketInternalProvider path={'messenger/ws/'} Context={WebSocketContext}>\n    {children}\n  </WebSocketInternalProvider>\n})\n\nexport default ()=>{\n  const webSocketContext = useContext(WebSocketContext)\n  return webSocketContext\n}\n\n","import React, { useState } from 'react';\nimport { StyleSheet} from 'react-native';\nimport { CustomButtonProps } from '../types';\nimport CommonButton from './CommonButton';\n\nexport default (props:CustomButtonProps)=>{\n    return <CommonButton {...props} style={[styles.style, props.style]}/>\n}\n\nconst styles = StyleSheet.create({\n    style:{\n        borderRadius:6, \n        backgroundColor: 'transparent',\n        borderWidth:0\n    },\n});\n","import { Notification } from '../types';\nimport axios from './axios';\n\nexport const getNotification = async (user_id:number)=>{\n    const data = (await axios.get(`/api/v1/notifications/?type=WEB&user=${user_id}`) ).data as Notification[]\n    return data.length?data[0]:undefined\n}\n\nexport const postNotification = async(notification:Notification)=>{\n    return (await axios.post(`/api/v1/notifications/`, notification)).data as Notification\n}\n\nexport const putNotification = async(notification:Notification)=>{\n    return (await axios.put(`/api/v1/notifications/${notification.id}/`, notification)).data as Notification\n}","import { Platform } from 'react-native';\n//@ts-ignore\nimport useMobileDetect from 'use-mobile-detect-hook';\n\nexport default ()=>{\n    const detectMobile = useMobileDetect();\n    return (detectMobile.isMobile() || Platform.OS == 'android' || Platform.OS == 'ios') as boolean\n}","import * as React from 'react';\nimport { View } from './Themed';\nimport { StyleSheet, StyleProp, ViewStyle, TextStyle, Pressable } from 'react-native';\nimport Colors from '../constants/Colors';\n\nexport type ItemParamList = {\n    outerContainerStyle?:StyleProp<TextStyle>\n    containerStyle?:StyleProp<ViewStyle>\n    bodyStyle?:StyleProp<ViewStyle>\n    children?: React.ReactNode\n    onPress?: ()=>void\n}\n\nexport default function CommonItem(props:ItemParamList){\n  const [hover, setHover] = React.useState(false)\n  const [press, setPress] = React.useState(false)\n  return (\n    <Pressable\n      style={[styles.outerContainer ,props.outerContainerStyle, (press)?{backgroundColor:'rgb(242,242,242)'}:{}]}\n      onPressIn={()=>{setPress(true)}}\n      onPressOut={()=>{setPress(false);props.onPress?.()}}\n       //@ts-ignore\n       onHoverIn={()=>setHover(true)}\n       onHoverOut={()=>setHover(false)}\n    >\n        <View style={[styles.container ,props.containerStyle]}>\n            <View style={[styles.bodyView, props.bodyStyle]}>\n                <>{props.children}</>\n            </View>\n      </View>\n    </Pressable>\n    )\n}\n\nconst styles = StyleSheet.create({\n  outerContainer:{\n    width:'100%',\n    maxWidth:1080,\n    alignItems:'stretch',\n  },  \n  container: {\n      marginHorizontal:20,\n      backgroundColor:'transparent'\n    },\n    bodyView:{\n      width: '100%',\n      padding: 10,\n      minHeight: 40,\n      alignItems: 'center',\n      justifyContent: 'center',\n      borderBottomWidth:1,\n      borderColor:Colors.borderColor,\n      backgroundColor:'transparent'\n    }\n  });\n  ","import { useQuery } from \"react-query\";\nimport { getUserMembershipList } from \"../../apis\";\nimport { Auth } from \"../useAuthContext\";\n\nexport default function useUserMembershipList(auth?:Auth){\n  const { data } = useQuery([\"UserMembershipList\", auth?.groupId] , async()=>auth?.groupId?(await getUserMembershipList(auth?.groupId)):[])\n  return data\n}","import * as React from 'react';\nimport { Avatar } from 'react-native-paper';\nimport { AvatarProps } from '../../types';\n\nconst normalizeHash = (hash: number, min: number, max: number) => {\n    return Math.floor((hash % (max - min)) + min);\n};\n\nconst stringToHSL = (str: string, initHash?:number) => {\n    let hash = initHash || 0;\n    for (let i = 0; i < str.length; i++) {\n      hash = str.charCodeAt(i) + ((hash << 5) - hash);\n    }\n    hash = Math.abs(hash);\n    return `hsl(${normalizeHash(hash, 0, 360)}, ${normalizeHash(hash, 0, 100)}%, ${normalizeHash(hash, 25, 75)}%)`;\n};\n\nexport default (props:AvatarProps) => {\n    const backgroundColor = stringToHSL(props.name, props.userId)\n    return <Avatar.Text style={{backgroundColor}} size={props.size} label={props.name.split(' ').map(v=>v[0]).join().toUpperCase()} />\n};","import React from 'react';\n// import { MaterialIcons } from \"@expo/vector-icons\"\nimport Avatar from '../lib/react-native-paper/Avatar';\nimport { AvatarProps } from '../types';\n\nexport default (props:AvatarProps)=>{\n    // return <MaterialIcons size={38} style={{ marginBottom: -3, marginRight:10 }} name='account-circle'/>\n    return <Avatar {...props}/>\n}\n\n","import React from \"react\"\nimport { View, Text } from \"../components/Themed\"\nimport CommonItem from \"../components/CommonItem\"\n// import useBoardChannelList from \"../lib/blacktokki-board/useBoardChannelList\"\nimport { useMessengerChannelSorted } from \"../hooks/lists/useMessengerChannelList\"\nimport useAuthContext from \"../hooks/useAuthContext\"\nimport { navigate } from \"../navigation\"\n\nconst DrawerTab = (props:{data:{name:string, onPress?:()=>void}[]})=><View style={{flex:1}}>\n    {props.data.map((item, index)=><CommonItem key={index} containerStyle={{marginHorizontal:0}} bodyStyle={{alignItems:'flex-start'}} onPress={item.onPress}>\n        <Text style={{marginLeft:20}}>{item.name}</Text>\n    </CommonItem>\n    )}\n</View>\n\nexport default {\n    Messenger:()=>{\n        const {auth} = useAuthContext()\n        const channelList = useMessengerChannelSorted(auth);\n        return <DrawerTab data={(channelList || []).map(item=>({...item, onPress:()=>navigate(\"ChatScreen\", {id:item.id})}))}/>\n    },\n    // Board:()=>{\n    //     const {auth} = useAuthContext()\n    //     const channelList = useBoardChannelList(auth);\n    //     return <DrawerTab data={(channelList || []).map(item=>({...item, onPress:()=>navigate(\"BoardScreen\", {id:item.id})}))}/>\n    // },\n}","import { Ionicons, FontAwesome } from \"@expo/vector-icons\"\nimport React from \"react\"\nimport { Text, View } from \"react-native\"\nimport CommonItem from \"../components/CommonItem\"\nimport useAuthContext from \"../hooks/useAuthContext\"\nimport { useMessengerChannelSorted } from \"../hooks/lists/useMessengerChannelList\"\nimport { navigate } from \"../navigation\"\n\nexport default ()=>{\n    const {auth} = useAuthContext()\n    const channelList = useMessengerChannelSorted(auth)\n    const today = (new Date()).toISOString().slice(0, 10)\n    return <View style={{flex:1, backgroundColor:'white'}}>\n        {channelList?.map((item, index)=>{\n            const date = item.last_message?.created.slice(0,10)\n            return <CommonItem key={index} bodyStyle={{flexDirection:'row', justifyContent:'space-between'}} onPress={()=>navigate(\"ChatScreen\", {id:item.id})}>\n                <View style={{flexDirection:'row'}}>\n                    <FontAwesome size={36} style={{ marginBottom: -3, marginRight:20 }} name='users'/>\n                    <View>\n                        <View style={{flexDirection:'row'}}>\n                            <Text style={{fontSize:18}}>{item.name}</Text>\n                            <Text style={{fontSize:18, opacity: 0.4, paddingLeft:5}}>{item.member_count}</Text>\n                        </View>\n                        <Text style={{fontSize:16, opacity: 0.4}}>{item.last_message?.content}</Text>\n                    </View>\n                </View>\n                <View>\n                    <Text style={{fontSize:14, opacity: 0.4, textAlign:'right'}}>{date==today?item.last_message?.created.slice(11,16):date}</Text>\n                    <Text style={{fontSize:14, textAlign:'right'}}>{item.unread_count?item.unread_count:' '}</Text>\n                </View>\n            </CommonItem>\n        })}\n    </View>\n}\n\nexport const MessengerIcon = <Ionicons size={30} style={{ marginBottom: -3 }} name='chatbox'/>","import React from \"react\";\nimport MemberTab, {MemberIcon} from \"./MemberTab\";\nimport OneTab, {ConfigIcon} from \"./OneTab\";\nimport DrawerTab  from './DrawerTab';\nimport MessengerTab, {MessengerIcon} from \"./MessengerTab\";\nimport lang from \"../lang\"\n// import BoardTab, {BoardIcon}  from \"../lib/blacktokki-board/BoardTab\";\n\nexport const bottomTabs = {\n    OneTab:{\n        title:lang('member'),\n        component:MemberTab,\n        icon:MemberIcon,\n    },\n    TwoTab:{\n        title:lang('messenger'),\n        component:MessengerTab,\n        icon:MessengerIcon\n    },\n    // ThreeTab:{\n    //     title:'board',\n    //     component:BoardTab,\n    //     icon:BoardIcon\n    // },\n    // FourTab:{\n    //     title:'config',\n    //     component:OneTab,\n    //     icon:ConfigIcon\n    // }\n} as Record<string, {title:string, component:React.ComponentType<any>, icon:JSX.Element}>\n\nexport const drawerTabs = {\n    TwoTab:{\n        title:lang('messenger'),\n        component:DrawerTab.Messenger,\n        icon:MessengerIcon\n    },\n    // ThreeTab:{\n    //     title:'board',\n    //     component:DrawerTab.Board,\n    //     icon:BoardIcon\n    // }\n} as Record<string, {title:string, component:React.ComponentType<any>, icon:JSX.Element}>","import { MaterialCommunityIcons } from \"@expo/vector-icons\"\nimport React from \"react\"\nimport { Text, View } from \"react-native\"\nimport CommonItem from \"../components/CommonItem\"\nimport useAuthContext from \"../hooks/useAuthContext\"\nimport useUserMembershipList from \"../hooks/lists/useUserMembershipList\"\nimport { UserMembership } from \"../types\"\nimport { navigate } from \"../navigation\"\nimport Avatar from \"../components/Avatar\"\n\nexport const renderMemberItem = (item:UserMembership, onPress?:()=>void)=> {\n    return <CommonItem key={item.id} bodyStyle={{backgroundColor:'white', flexDirection:'row', justifyContent:'flex-start'}} onPress={onPress}>\n        <View style={{marginTop:4, marginRight:12}}><Avatar name={item.name} userId={item.id} size={44}/></View>\n        <Text style={{fontSize:20, fontWeight:'400'}}>{item.name}</Text>\n    </CommonItem>\n}\n\nexport default ()=>{\n    const {auth} = useAuthContext()\n    const userList = useUserMembershipList(auth)\n    const memberItem = React.useMemo(\n        ()=>userList && userList.map(item=>renderMemberItem(item, ()=>navigate(\"ProfileScreen\", {id:item.id}))), [userList])\n    return <View style={{flex:1, backgroundColor:'white'}}>\n        {memberItem}\n    </View>\n}\n\nexport const MemberIcon = <MaterialCommunityIcons size={32} style={{ marginBottom: -3 }} name='account'/>","import { useTheme } from '@react-navigation/native';\nimport React, { useState } from 'react';\nimport { View, StyleSheet } from 'react-native';\nimport { TabView, SceneMap,NavigationState, SceneRendererProps, TabBar } from 'react-native-tab-view';\nimport { navigate } from '.';\nimport Profile from '../components/Profile';\nimport TextButton from '../components/TextButton';\nimport Colors from '../constants/Colors';\nimport useResizeWindow from '../hooks/useResizeWindow';\nimport { drawerTabs } from '../tabs';\nimport { UserMembership } from '../types';\n\nexport const TabViewNavigator = (props:{tabs:typeof drawerTabs, tabBarPosition:\"top\"|\"bottom\", index?:number, onTab?:(index:number)=>void})=>{\n  const [index, setIndex] = React.useState(props.index || 0);\n  const entries = Object.entries(props.tabs)\n  const onTab = props.onTab\n  const icons = Object.assign({}, ...entries.map(([k, v])=>({[k]:v.icon})))\n  return <TabView\n    renderTabBar={(props:SceneRendererProps & {navigationState: NavigationState<any>})=>{\n      return <TabBar\n        {...props}\n        indicatorStyle={{ backgroundColor: \"#2196F3\" }}\n        style={{ backgroundColor:'white' }}\n        activeColor={'black'}\n        inactiveColor={'black'}\n        renderIcon={(scene)=>icons[scene.route.key]}\n        onTabPress={(scene)=>onTab?.(entries.findIndex(([k, v])=>k == scene.route.key))}\n      />\n    }}\n    navigationState={{ index, routes: entries.map(([k, v])=>({key:k, title:v.title}))}}\n    onIndexChange={setIndex}\n    renderScene={SceneMap(Object.assign({}, ...entries.map(([k, v])=>({[k]:v.component}))))}\n    tabBarPosition={props.tabBarPosition}\n  />\n}\n\nconst onAddList = [\n  ()=>navigate(\"ChannelEditScreen\", {type:\"messenger\"}),\n  ()=>navigate(\"ChannelEditScreen\", {type:\"board\"})\n]\n\nexport default React.memo(({user}:{user:UserMembership})=> {\n  const { colors } = useTheme();\n  const windowType = useResizeWindow();\n  const [index, setIndex] = useState(0);\n  return windowType=='landscape'?<View\n      style={[\n        styles.tabBar,\n        {\n          backgroundColor: colors.card,\n          borderTopColor: colors.border,\n        },\n        // tabBarStyle,\n      ]}\n      pointerEvents={false ? 'none' : 'auto'}\n    >\n      <Profile userId={user.id} username={user.username} name={user.name}/>\n      <View style={{flexDirection:'row-reverse'}}>\n          <TextButton title='+' textStyle={{fontSize:20}} style={{borderRadius:20}} onPress={onAddList[index]}/>\n      </View>\n      <View accessibilityRole=\"tablist\" style={styles.content}>\n        {Object.keys(drawerTabs).length>1 ? \n          <TabViewNavigator tabs={drawerTabs} tabBarPosition={\"top\"} onTab={setIndex}/>: \n          <View style={{borderTopWidth:1, flex:1, borderColor:colors.border}}>            \n            {Object.values(drawerTabs).map(drawerTab=>{const Tab = drawerTab.component; return <Tab key={drawerTab.title}/>})}\n          </View>\n        }\n      </View>\n    </View>:<View style={{width:0}}></View>\n})\n\n{/*<Text style={[styles.label, { color: d.isFocused ? colors.primary : '#222' }]}></Text> */}\n\nconst styles = StyleSheet.create({\n    tabBar: {\n      width:240,\n      elevation: 8,\n      borderRightWidth:1,\n      borderColor:Colors.borderColor\n    },\n    content: {\n      flex: 1,\n      flexDirection: 'row',\n    },\n    tab: {\n        flex: 1,\n        alignItems: 'center',\n    },\n    label: {\n        textAlign: 'center',\n        backgroundColor: 'transparent',\n      },\n  });","import React from 'react';\nimport {View} from 'react-native'\nimport {Text} from './Themed';\nimport { ProfileProps } from '../types';\nimport Avatar from './Avatar';\nimport TextButton from './TextButton';\nimport CommonTextInput from './CommonTextInput';\nimport { patchUser } from '../apis';\nimport useAuthContext from '../hooks/useAuthContext';\n\nexport default (props:ProfileProps)=>{\n    const [name, setName] = React.useState<string>()\n    const { auth, dispatch } = useAuthContext()\n    const isSelf = auth.user?.id == props.userId\n    const onChange = ()=>{\n        isSelf && patchUser({id:props.userId, name:name || ''}).finally(()=>{\n            setName(undefined)\n            dispatch({type:\"REFRESH\"})\n        })\n    }\n    return <View style={{width:'100%', height:135, justifyContent:'space-evenly', alignItems:'center'}}>\n        <Avatar {...props} size={75}/>\n        {name===undefined?\n            <TextButton textStyle={{fontWeight:'bold', fontSize:15}} onPress={()=>isSelf && setName(props.name)} title={props.name} disabled={!isSelf}/>:\n            <CommonTextInput value={name} style={{textAlign:'center'}} setValue={setName} onBlur={onChange} onEndEditing={onChange} />}\n        <Text style={{fontWeight:'normal', fontSize:14}}>{props.username}</Text>\n    </View>\n}","import React, { useState } from 'react';\nimport { TextInput } from 'react-native';\nimport Colors from '../constants/Colors';\nimport useColorScheme from '../hooks/useColorScheme';\nimport { CustomTextInputProps } from '../types';\n\nexport default (props:CustomTextInputProps)=>{\n    const [contentHeight, setContentHeight] = useState<number>()\n    const minHeight = props.minHeight || 30\n    const theme = useColorScheme()\n    return <TextInput style={[{\n            borderColor:'#d0d7de', \n            fontSize:16, \n            borderWidth:1, \n            borderRadius:6, \n            paddingHorizontal:10, \n            paddingVertical:3, \n            backgroundColor:Colors[theme].background,\n            color:Colors[theme].text,\n            height:props.multiline?contentHeight:minHeight,\n        }, props.style]} \n        editable={!props.disabled} \n        value={props.value} \n        onChangeText={props.setValue}\n        onContentSizeChange={props.multiline?(e) => setContentHeight(Math.max(e.nativeEvent.contentSize.height, minHeight) + 2):undefined}\n        onBlur={()=>props.onBlur?.(props.value)}\n        onEndEditing={()=>props.onEndEditing?.(props.value)}\n        multiline={props.multiline}\n    />\n}","/**\n * Learn more about Light and Dark modes:\n * https://docs.expo.io/guides/color-schemes/\n */\n\nimport * as React from 'react';\nimport { Text as DefaultText, View as DefaultView } from 'react-native';\n\nimport Colors from '../constants/Colors'\nimport useColorScheme from '../hooks/useColorScheme';\n\nexport function useThemeColor(\n  props: { light?: string; dark?: string },\n  colorName: keyof typeof Colors.light & keyof typeof Colors.dark\n) {\n  const theme = useColorScheme();\n  const colorFromProps = props[theme];\n\n  if (colorFromProps) {\n    return colorFromProps;\n  } else {\n    return Colors[theme][colorName];\n  }\n}\n\ntype ThemeProps = {\n  lightColor?: string;\n  darkColor?: string;\n};\n\nexport type TextProps = ThemeProps & DefaultText['props'];\nexport type ViewProps = ThemeProps & DefaultView['props'];\n\nexport function Text(props: TextProps) {\n  const { style, lightColor, darkColor, ...otherProps } = props;\n  const color = useThemeColor({ light: lightColor, dark: darkColor }, 'text');\n\n  return <DefaultText style={[{ color }, style]} {...otherProps} />;\n}\n\nexport function View(props: ViewProps) {\n  const { style, lightColor, darkColor, ...otherProps } = props;\n  const backgroundColor = useThemeColor({ light: lightColor, dark: darkColor }, 'background');\n\n  return <DefaultView style={[{ backgroundColor }, style]} {...otherProps} />;\n}\n","import { createIntl, createIntlCache } from \"@formatjs/intl\";\nimport {I18nManager} from \"react-native\";\nimport * as RNLocalize from \"react-native-localize\";\n\nconst translations = {\n  ko: require(\"./ko.json\"),\n} as const;\n\ntype Translation = keyof typeof translations;\n\n// fallback if no available language fits\nconst fallback = { languageTag: \"en\", isRTL: false };\n\nconst { languageTag, isRTL } =\n  RNLocalize.findBestLanguageTag(Object.keys(translations)) ?? fallback;\n\n// update layout direction\nI18nManager.forceRTL(isRTL);\n\n// console.log(languageTag)\nconst intl = createIntl(\n  {\n    defaultLocale: \"en\",\n    locale: languageTag,\n    messages: translations[languageTag as Translation],\n  },\n  createIntlCache(),\n);\n\ntype TranslationParams = Parameters<(typeof intl)[\"formatMessage\"]>[1];\n\nexport default (key: string, params?: TranslationParams) => \n  intl\n    .formatMessage({ id: key, defaultMessage: key }, params)\n    .toString();","/**\n * Learn more about deep linking with React Navigation\n * https://reactnavigation.org/docs/deep-linking\n * https://reactnavigation.org/docs/configuring-links\n */\n\nimport { LinkingOptions } from '@react-navigation/native';\nimport * as Linking from 'expo-linking';\nimport {main, login, modal} from '../screens';\n\nconst ROOTPATH = 'tokki-tok'  // github repository name\n\nObject.values(modal).forEach(v=>v.path = ROOTPATH + '/' + v.path)\n\nexport default  {\n  prefixes: [Linking.makeUrl('/')],\n  config: {\n    screens: {\n      Main: {\n        screens:{\n          ...main,\n          ...login,\n          NotFound: '*',\n        },\n        path: ROOTPATH\n      },\n      ...modal\n    },\n  },\n} as LinkingOptions;\n","import axios, { AxiosRequestConfig } from 'axios';\n// @ts-ignore\nimport {API_URL} from \"@env\"\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nexport const accountURL =  `${API_URL}/account/`\nconst baseURL =  `${API_URL}/messenger/`\nconst defaultOption:AxiosRequestConfig = {\n    baseURL,\n    withCredentials: true,\n    headers: {}\n};\nconst _axios = axios.create(defaultOption);\n\n_axios.interceptors.request.use(\n    config => {\n        return config;\n    },\n    error => {\n        return Promise.reject(error);\n    }\n)\n\n_axios.interceptors.response.use(\n    response => {\n        // if((response.request.responseURL as string).indexOf('/task/login')>=0 && response.data.length != 0){\n        //     // redirect login\n        // }\n        return response;\n    },\n    error => {\n        if (error.response.status === 401) {\n            getToken().then(async(token)=>{\n                const r = await _axios.post(\"/api/v1/user/sso/refresh/\", {token}, {headers:{'Authorization':''}, baseURL: accountURL})\n                if (r.status == 200 && r.data !== ''){\n                    setToken(r.data)\n                }\n            })\n        }\n        return Promise.reject(error)\n    }\n)\n\nexport const setToken = async (token:string|null)=>{\n    _axios.defaults.headers['Authorization'] = `JWT ${token}`\n    if (token)\n        await AsyncStorage.setItem(\"Authorization\", token)\n    else\n        AsyncStorage.removeItem(\"Authorization\")\n}\nexport const getToken = async ()=>{\n    const token = await AsyncStorage.getItem(\"Authorization\")\n    _axios.defaults.headers['Authorization'] = token?`JWT ${token}`:null\n    return token\n}\n\nexport default _axios\n","const tintColorLight = '#2f95dc';\nconst tintColorDark = '#fff';\n\nexport default {\n  light: {\n    text: '#000',\n    background: '#fff',\n    tint: tintColorLight,\n    tabIconDefault: '#ccc',\n    tabIconSelected: tintColorLight,\n    header:'#24292f',\n    buttonColor:'rgb(242,242,242)',\n    buttonBackgroundColor: '#f6f8fa', //'rgba(9,30,66,0.08)',//rgb(242,242,242)\n  },\n  dark: {\n    text: '#fff',\n    background: '#000',\n    tint: tintColorDark,\n    tabIconDefault: '#ccc',\n    tabIconSelected: tintColorDark,\n    header:'#dbd6d1',\n    buttonColor:'rgb(14,14,14)',\n    buttonBackgroundColor: '#080604',\n  },\n  button:{\n    borderColor:'rgba(27,31,36,0.15)',\n  },\n  borderColor:'#d0d7de',\n  \n  focus:'#0065A4',\n};\n","import { StackScreenProps } from '@react-navigation/stack';\nimport * as React from 'react';\nimport { StyleSheet, Text, TouchableOpacity, View } from 'react-native';\nimport lang from '../lang'\n\nexport default function NotFoundScreen({\n  navigation,\n}: StackScreenProps<any, 'NotFound'>) {\n  return (\n    <View style={styles.container}>\n      <Text style={styles.title}>{lang(\"This screen doesn't exist.\")}</Text>\n      <TouchableOpacity onPress={() => navigation.replace('HomeScreen')} style={styles.link}>\n        <Text style={styles.linkText}>{lang(\"Go to home screen!\")}</Text>\n      </TouchableOpacity>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: '#fff',\n    alignItems: 'center',\n    justifyContent: 'center',\n    padding: 20,\n  },\n  title: {\n    fontSize: 20,\n    fontWeight: 'bold',\n  },\n  link: {\n    marginTop: 15,\n    paddingVertical: 15,\n  },\n  linkText: {\n    fontSize: 14,\n    color: '#2e78b7',\n  },\n});\n","import React, { createContext, useContext, useEffect, useMemo, useRef, useState } from \"react\"\nimport firebase from \"firebase/app\";\nimport \"firebase/messaging\";\n//@ts-ignore\nimport {FCM_PUBLIC_VAPID_KEY, FCM_API_KEY} from \"@env\"\nimport { Notification as NotificationType, UserMembership } from \"../types\";\nimport { getNotification, postNotification, putNotification } from \"../apis/notification\";\nconst firebaseConfig = require(\"../../web/firebase-config.js\")\n// Initialize Firebase\nconst key = firebaseConfig.messagingSenderId\nconst apiKeyEncrypted = (FCM_API_KEY as string).split('').map((v, i)=> (v.charCodeAt(0) ^ key.charCodeAt(i)).toString(16).padStart(2, '0')).join('')\nconst app = firebase.initializeApp({...firebaseConfig, apiKey:FCM_API_KEY});\n// const analytics = getAnalytics(app);\nconst messaging = firebase.messaging(app);\n\nmessaging.onMessage((payload) => {\n  if (!(\"Notification\" in window)) {\n    alert(\"This browser does not support desktop notification\");\n  }\n  else if (Notification.permission === \"granted\") {\n    const message_set = JSON.parse(payload.data['message_set'])[0]\n    new Notification(payload.data.channel_name, { body: `${payload.data.name}: ${message_set.content}` });\n  }\n});\n\nconst FirebaseContext = createContext<{enable:boolean, setEnable:(enable:boolean)=>void}>({enable:false, setEnable:()=>{}});\n\nconst requestToken = async()=>{\n  const permission = await Notification.requestPermission();\n  if (permission === 'granted') {\n    const serviceWorkerRegistration = await navigator.serviceWorker.register(`${process.env.PUBLIC_URL}/firebase-messaging-sw.js?${apiKeyEncrypted}`)\n    console.log('[SW]: SCOPE: ', serviceWorkerRegistration.scope);\n    const currentToken = await messaging.getToken({serviceWorkerRegistration, vapidKey: FCM_PUBLIC_VAPID_KEY })\n    window.addEventListener('beforeunload', (event:any) => {\n      event.preventDefault();\n      serviceWorkerRegistration.unregister()\n    });\n    if (currentToken)\n      return currentToken\n  }\n  return undefined\n}\n\nexport const FirebaseProvider = ({children, user}:{user?:UserMembership|null, children:React.ReactNode})=>{\n  const tokenRef = useRef<string>()\n  const [notification, setNotification] = useState<NotificationType>()\n  const enable = useMemo(()=>!(notification?.token), [notification])\n  const setEnable = (enable:boolean)=>{\n    if(user && notification){\n      putNotification({...notification, token:enable||tokenRef.current==undefined?null:tokenRef.current}).then((noti)=>{\n        setNotification(noti)\n      })\n    }\n  }\n  \n  useEffect(()=>{\n    let isMount = true;\n    const setNotificationInternal = (n?:NotificationType)=>{\n      if (isMount)setNotification(n)\n    }\n    if(user){\n      requestToken().then((t)=>{\n        tokenRef.current = t\n        getNotification(user.id).then(noti=>{\n          const token = t==undefined?null:t\n          if (noti == undefined)\n            postNotification({user:user.id, type:'WEB', token}).then(setNotificationInternal)\n          else\n            putNotification({...noti, token}).then(setNotificationInternal)\n        })\n      })\n    }\n    else{\n      setNotificationInternal(undefined)\n    }\n    return ()=>{isMount=false}\n  }, [user])\n  return !user?<>{children}</>:<FirebaseContext.Provider value={{enable, setEnable}}>\n    {children}\n  </FirebaseContext.Provider>\n}\n\nexport default ()=>{\n  const firebaseContext = useContext(FirebaseContext)\n  return firebaseContext\n}\n","import React, { useEffect, useState } from 'react'\nimport { Dimensions, Platform, View } from 'react-native'\nimport useIsMobile from '../hooks/useIsMobile'\n\ntype ViewProps = {windowType:'landscape'|'portrait', children:React.ReactNode}\n\nexport default (props:ViewProps)=>{\n    const isMobile = useIsMobile()\n    const [height, setHeight] = useState(window.innerHeight + 1)\n    useEffect(()=>{\n        if(isMobile && Platform.OS == 'web'){\n            const onChange = (e:any)=>{\n                setHeight(window.innerHeight + 1)\n            }\n            Dimensions.addEventListener(\"change\",onChange)\n            return () => Dimensions.removeEventListener(\"change\", onChange)\n            \n        }\n    },[ isMobile])\n    return <View style={{height:isMobile&&Platform.OS == 'web'?height:'100%'}}>\n        {props.children}\n    </View>\n\n}\n  ","import { CardStyleInterpolators, createStackNavigator } from '@react-navigation/stack';\nimport React, {useMemo} from 'react';\nimport { View } from 'react-native';\nimport { QueryClient, QueryClientProvider } from \"react-query\";\nimport { Ionicons } from '@expo/vector-icons';\nimport useResizeWindow from '../hooks/useResizeWindow';\nimport NotFoundScreen from '../screens/NotFoundScreen';\nimport {main, login, modal} from '../screens';\nimport DrawerNavigator from './DrawerNavigator';\nimport useAuthContext, {AuthProvider} from '../hooks/useAuthContext';\nimport { WebSocketProvider } from '../hooks/useWebsocketContext';\nimport HeaderRight from '../components/HeaderRight'\nimport Colors from '../constants/Colors';\nimport { TouchableOpacity } from 'react-native-gesture-handler';\nimport { FirebaseProvider } from '../hooks/useFirebaseContext';\nimport useIsMobile from '../hooks/useIsMobile';\nimport MobileSafeAreaView from '../components/MobileSafeAreaView';\nimport useColorScheme from '../hooks/useColorScheme';\n\nconst Root = createStackNavigator();\n\nconst queryClient = new QueryClient();\n\nexport default function RootNavigator() {\n    const windowType = useResizeWindow();\n    return (\n        <MobileSafeAreaView windowType={windowType}>\n            <AuthProvider>\n                <QueryClientProvider client={queryClient}>\n                    {/* devtools */}\n                    {/* <ReactQueryDevtools initialIsOpen={true} /> */}\n                        <Root.Navigator\n                            mode= 'modal'\n                            headerMode= 'screen'\n                            screenOptions={{\n                                cardStyle:{backgroundColor:\"white\"},\n                                animationEnabled: true,\n                                cardStyleInterpolator: CardStyleInterpolators.forVerticalIOS,\n                            }}\n                        >\n                            <Root.Screen name=\"Main\" component={MainNavigator} options={{headerShown:false}}/>\n                            {Object.entries(modal).map(([key, screen])=><Root.Screen key={key} name={key} component={screen.component} options={{\n                                title: screen.title,\n                                gestureDirection: windowType == 'landscape'?'vertical-inverted':'vertical'\n                            }} />)}\n                        </Root.Navigator>\n                </QueryClientProvider>\n            </AuthProvider>\n        </MobileSafeAreaView>\n    );\n}\n\nconst Main = createStackNavigator();\n\nfunction headerLeft(navigation:any, route:any, windowType:string, isMobile:boolean){\n    const canGOBackScreen = ['HomeScreen', 'LoginScreen'].findIndex(v=>v == route.name) == -1\n    const goBack = ()=>{\n        if (navigation.canGoBack())\n            navigation.goBack()\n        else if (canGOBackScreen)\n            navigation.replace('HomeScreen')\n    }\n    if (windowType=='portrait' && canGOBackScreen)\n        return <TouchableOpacity onPress={goBack}><Ionicons size={isMobile?20:24} style={{marginHorizontal:isMobile?16:20 }} name=\"arrow-back\"/></TouchableOpacity>\n    return null\n}\n\nfunction MainNavigator(){\n    const windowType = useResizeWindow();\n    const isMobile = useIsMobile()\n    const {auth} = useAuthContext()\n    const theme = useColorScheme()\n    const entries = useMemo(()=>{\n        if (auth.user === undefined)\n            return []\n        console.log('current user: ', auth.user)\n        return Object.entries(auth.user === null?login:main)\n    }, [auth])\n    return (auth.user!==undefined?<View style={{flexDirection:'row', flex:1}}>\n        {auth.user?<DrawerNavigator user={auth.user}/>:undefined}\n        <View style={{flex:1}}>\n            <FirebaseProvider user={auth.user}>\n                <WebSocketProvider disable={auth.user === null || auth.user === undefined}>\n                    <Main.Navigator\n                        screenOptions={({navigation, route})=>({\n                            headerStyle:{backgroundColor:Colors[theme].header, height:isMobile?50:undefined},\n                            headerTitleStyle:{color:'white'},\n                            headerLeft:()=>headerLeft(navigation, route, windowType, isMobile),\n                            headerRight:()=><HeaderRight/>,\n                            headerLeftContainerStyle:{backgroundColor:'white', borderBottomWidth:1, borderColor:Colors.borderColor},\n                            cardStyle:{flexShrink:1},\n                            animationEnabled:windowType=='portrait',\n                            cardStyleInterpolator: CardStyleInterpolators.forHorizontalIOS\n                        })}\n                    >\n                        {entries.map(([key, screen])=><Main.Screen key={key} name={key} component={screen.component} options={{ title: screen.title }} />)}\n                        <Main.Screen name=\"NotFound\" component={NotFoundScreen} options={{ title: 'Oops!' }} />\n                    </Main.Navigator>\n                </WebSocketProvider>\n            </FirebaseProvider>\n        </View>\n    </View>:<></>);\n}","import React from 'react';\nimport { StatusBar } from 'expo-status-bar';\nimport { SafeAreaProvider } from 'react-native-safe-area-context';\nimport Navigation from './src/navigation';\nimport useColorScheme from './src/hooks/useColorScheme';\nimport useCachedResources from './src/hooks/useCachedResources';\n\nexport default function App() {\n  const isLoadingComplete = useCachedResources();\n  const colorScheme = useColorScheme();\n  if (!isLoadingComplete) {\n    return null;\n  } else {\n    return (\n      <SafeAreaProvider>\n        <Navigation colorScheme={colorScheme} />\n        <StatusBar />\n      </SafeAreaProvider>\n    );\n  }\n}\n","import { Ionicons } from '@expo/vector-icons';\nimport * as Font from 'expo-font';\nimport * as SplashScreen from 'expo-splash-screen';\nimport * as React from 'react';\n\nexport default function useCachedResources() {\n  const [isLoadingComplete, setLoadingComplete] = React.useState(false);\n\n  // Load any resources or data that we need prior to rendering the app\n  React.useEffect(() => {\n    async function loadResourcesAndDataAsync() {\n      try {\n        SplashScreen.preventAutoHideAsync();\n\n        // Load fonts\n        await Font.loadAsync({\n          ...Ionicons.font,\n          'space-mono': require('../assets/fonts/SpaceMono-Regular.ttf'),\n        });\n      } catch (e) {\n        // We might want to provide this error information to an error reporting service\n        console.warn(e);\n      } finally {\n        setLoadingComplete(true);\n        SplashScreen.hideAsync();\n      }\n    }\n\n    loadResourcesAndDataAsync();\n  }, []);\n\n  return isLoadingComplete;\n}\n","import React, { createContext, useContext, useEffect, useReducer, useMemo, Dispatch } from \"react\"\nimport { checkLogin, login, logout } from \"../apis\"\nimport { getNotification, putNotification } from \"../apis/notification\"\nimport { UserMembership } from \"../types\"\n\ntype AuthAction = {type:string, username?:string, password?:string, user?:UserMembership|null}\n\nexport type Auth = {user?:UserMembership|null, groupId?:number}\n\ntype AuthState ={user?:UserMembership|null, request?:{username:string, password:string}|null}\n\nconst AuthContext = createContext<{auth:Auth, dispatch:Dispatch<AuthAction>}>({auth:{}, dispatch:()=>{}});\n\nconst authReducer =(initialState:AuthState, action:AuthAction)=>{\n  switch (action.type){\n      case 'LOGIN_REQUEST':\n        return {\n          ...initialState,\n          request:{username:action.username, password:action.password},\n        } as AuthState\n      case 'LOGIN_GUEST':\n        return {\n          ...initialState,\n          request:{username:'guest', password:'guest'},\n        } as AuthState\n      case 'LOGIN_SUCCESS':\n          return{\n              ...initialState,\n              user:action.user,\n              request:undefined\n          }\n      case 'LOGIN_FAILED':\n          return{\n              ...initialState,\n              request:undefined\n          }\n      case 'LOGOUT_REQUEST':\n          return{\n              ...initialState,\n              request:null\n          }\n      case 'LOGOUT_SUCCESS':\n          return {\n            ...initialState,\n            user:null,\n            request:undefined\n          }\n      case 'REFRESH':\n        return {\n          ...initialState,\n          user:undefined\n        }\n      default:\n          throw new Error( `Unhandled action type: ${action.type}`)\n  }\n}\n\n\nexport const AuthProvider = ({children}:{children:React.ReactNode})=>{\n  const [authState, dispatch] = useReducer(authReducer, {} as Auth)\n  const auth = useMemo(()=>({\n    user:authState.user,\n    groupId: authState.user?.membership_set.find(g=>g.root_group_id==null)?.group\n  }), [authState])\n  useEffect(()=>{\n    if(authState.user===undefined){\n      checkLogin().then((user)=>{\n        dispatch({type:\"LOGIN_SUCCESS\", user})\n      }).catch((e)=>{\n        console.log(e)\n        dispatch({type:\"LOGOUT_SUCCESS\"})\n      })\n    }\n    else if(authState.user===null && authState.request){\n      login(authState.request.username, authState.request.password).then(user=>{\n        dispatch({type:\"LOGIN_SUCCESS\", user})\n      }).catch(()=>{\n        dispatch({type:\"LOGIN_FAILED\"})\n      })\n    }\n    else if(authState.user && authState.request===null){\n      getNotification(authState.user.id).then(noti=>{\n        noti && putNotification({...noti, token:''}).then(()=>{\n          logout().then(()=>dispatch({type:\"LOGOUT_SUCCESS\"}))\n        })\n      })\n    }\n  }, [authState])\n  return <AuthContext.Provider value={{auth, dispatch}}>\n    {children}\n  </AuthContext.Provider>\n}\n\nexport default ()=>{\n  const authContext = useContext(AuthContext)\n  return authContext\n}\n","firebaseConfig = {\n    \"authDomain\": \"virtual-metrics-355712.firebaseapp.com\",\n    \"projectId\": \"virtual-metrics-355712\",\n    \"storageBucket\": \"virtual-metrics-355712.appspot.com\",\n    \"messagingSenderId\": \"76003576924\",\n    \"appId\": \"1:76003576924:web:c8c8a006d07918bbc02a99\",\n    \"measurementId\": \"G-SEL35L4N5R\"\n}\nif (typeof module !== 'undefined') {\n    module.exports = firebaseConfig\n}\n","module.exports = __webpack_public_path__ + \"./fonts/SpaceMono-Regular.ttf\";","/**\n * If you are not familiar with React Navigation, refer to the \"Fundamentals\" guide:\n * https://reactnavigation.org/docs/getting-started\n *\n */\nimport _ from 'lodash';\nimport { NavigationContainer, DefaultTheme, DarkTheme, NavigationContainerRef } from '@react-navigation/native';\nimport * as React from 'react';\nimport { ColorSchemeName } from 'react-native';\n\nimport LinkingConfiguration from './LinkingConfiguration';\nimport RootNavigator from './RootNavigator';\n\nconst navigationRef = React.createRef<NavigationContainerRef>();\n\nexport function navigate(name:string, params?:any) {\n  if (params)\n    navigationRef.current?.navigate(name, params);\n  navigationRef.current?.navigate(name);\n}\n\nexport default function Navigation({ colorScheme }: { colorScheme: ColorSchemeName }) {\n  return (\n    <NavigationContainer\n      ref={navigationRef}\n      documentTitle={{formatter: (options, route) => {return `TOKKI TOK`}}}\n      linking={(process.versions && process.versions['electron'])?undefined:LinkingConfiguration}\n      theme={colorScheme === 'dark' ? DarkTheme : DefaultTheme}>\n      <RootNavigator />\n    </NavigationContainer>\n  );\n}\n\n(function(l) {  // for github-page\n    if (l !== undefined && l.search[1] === '/' ) {\n        var decoded = l.search.slice(1).split('&').map(function(s) { \n        return s.replace(/~and~/g, '&')\n        }).join('?');\n        window.history.replaceState(null, '',\n            l.pathname.slice(0, -1) + decoded + l.hash\n        );\n    }\n}(window.location))\n    \nconst ignoreWarnings = ['ReactNativeFiberHostComponent'];\nconst _console = _.clone(console);\nconsole.warn = (message: string|Object) => {\n    var warn = true;\n    if (message instanceof Object)\n    warn = false;\n    else{\n    ignoreWarnings.forEach((value)=>{\n        if (message.indexOf && message.indexOf(value) <= -1) {\n            warn = false;\n        }\n    })\n    };\n    if (warn){\n        _console.warn(message);\n    }\n    else{\n        // console.log(message)\n    }\n};\n","\nimport { User, UserMembership } from '../types';\nimport axios, { getToken, setToken, accountURL as baseURL } from './axios';\n\nexport const login = async(username:string, password:string) => {\n    if(username.endsWith('.guest') && password.length == 0)\n        password = 'guest'\n    const r = await axios.post(\"/api-token-auth/\", {username, password});\n    if(r.status == 200){\n        await setToken(r.data)\n        return await checkLogin()\n    }\n}\n\nexport const logout = async() => {\n    await setToken(null)\n    return await axios.get(\"/api-auth/logout/\")\n}\n\nexport const guestLogin =  async() => {\n    return await login('guest', 'guest')\n}\n\nconst checkLoginToken = async ()=>{\n    const value = (await axios.get(\"/api/v1/users/memberships/?_self=true\"))?.data\n    if (value && value.length){\n        return value[0] as UserMembership\n    }\n    return null\n}\n\nexport const checkLogin = async() => {\n    const token = await getToken()\n    if (token === null)\n        return null\n    try{\n       return await checkLoginToken()\n    }\n    catch(e:any){\n        let error = e\n        if(e.response !== undefined && e.response.status==401){\n            try{\n                return await checkLoginToken()\n            }\n            catch(e2){\n                error = e2\n            }\n        }\n        const isOffline = ((error as any).code == \"ERR_NETWORK\" || (error as any).message && ((error as any).message as string).startsWith(\"Cannot read\"))\n        throw {error, isOffline}\n    }\n}\n\nexport const getUserList = async (group_id:number)=>{\n    return (await axios.get(`/api/v1/users/?group_id=${group_id}`) ).data as User[]\n}\n\nexport const patchUser = async (user:{id:number, name:string})=>{\n    await axios.patch(`/api/v1/user/`, {ids:[user.id], updated: {name:user.name}}, {baseURL})\n}\n\nexport const getUserMembershipList = async (group_id:number)=>{\n    return (await axios.get(`/api/v1/users/memberships/?group_id=${group_id}`) ).data as UserMembership[]\n}\n","import { Channel, MessengerMember, MessengerContent, EditMessage, MessengerChannel, DirectChannel } from '../types';\nimport axios from './axios';\n\nexport const getMessengerChannelList = async (user_id:number)=>{\n    return (await axios.get(`/api/v1/channels/messenger/?type=messenger&messenger_user_id=${user_id}`) ).data as MessengerChannel[]\n}\n\nexport const postChannel = async(channel:Channel)=>{\n    return (await axios.post(`/api/v1/channels/`, channel)).data as Channel\n}\n\nexport const postDirectChannel = async(channel:DirectChannel)=>{\n    return (await axios.post(`/api/v1/channels/direct/`, channel)).data as Channel\n}\n\nexport const putChannel = async(channel:Channel)=>{\n    return (await axios.put(`/api/v1/channels/${channel.id}/`, channel)).data as Channel\n}\n\nexport const deleteChannel = async(channel_id:number)=>{\n    await axios.delete(`/api/v1/channels/${channel_id}/`)\n}\n\nexport const getMessengerMemberList = async(channel_id:number)=>{\n    return (await axios.get(`/api/v1/messengermembers/?channel=${channel_id}`) ).data as MessengerMember[]\n}\n\nexport const postBulkMessengerMember = async(data:{channel_id:number, user_ids:number[]})=>{\n    await axios.post(`/api/v1/messengermembers/bulk/`, {channel:data.channel_id, user_ids:data.user_ids})\n}\n\nexport const deleteMessengerMember = async(member_id:number)=>{\n    await axios.delete(`/api/v1/messengermembers/${member_id}/`)\n}\n\nexport const getMessengerContentList = async (channel_id:number, id_lt?:number)=>{\n    const id_lt_param = id_lt?`&id_lt=${id_lt}`:''\n    return (await axios.get(`/api/v1/messengercontents/?limit=30&channel=${channel_id}${id_lt_param}`)).data.results as MessengerContent[]\n}\n\nexport const postMessage = async (message:EditMessage)=>{\n    if (message.file){\n        const formData = new FormData(); // formData 객체를 생성한다.\n        formData.append(\"file\", message.file)\n        Object.entries(message).forEach(value=>{\n            formData.append(value[0], `${value[1]}`)\n        })\n        await axios.post(`/api/v1/messengercontents/messages/`, formData, {headers:{\n            ...(axios.defaults.headers as any), \"Content-Type\": \"multipart/form-data\",\n        }})\n    }\n    else{\n        await axios.post(`/api/v1/messengercontents/messages/`, message)\n    }\n}\n\nexport const deleteMessengerContent = async (content_id:number)=>{\n    await axios.delete(`/api/v1/messengercontents/${content_id}/`)\n}","import React, { useState } from 'react';\nimport { Text, StyleSheet, Pressable, StyleProp, ViewStyle} from 'react-native';\nimport Colors from '../constants/Colors';\nimport useColorScheme from '../hooks/useColorScheme';\nimport { CustomButtonProps } from '../types';\n\nconst DefaultButton = (props:CustomButtonProps)=>{\n    const [hover, setHover] = useState(false)\n    return <Pressable\n        onPress={()=>props.onPress()}\n        //@ts-ignore\n        onHoverIn={()=>setHover(true)}\n        onHoverOut={()=>setHover(false)}\n        style={[\n            {\n                paddingVertical:5, \n                paddingHorizontal:16\n            },\n            props.style,\n            hover?{backgroundColor:props.color}:{}\n        ]}>\n            <Text selectable={false} style={[{fontSize:14}, props.textStyle]}>{props.title}</Text>\n        </Pressable>\n}\n\nexport default (props:CustomButtonProps)=>{\n    const theme = useColorScheme()\n    const _props = {\n        color:Colors[theme].buttonColor,\n        ...props,\n        style:[\n            styles.style,\n            {\n                backgroundColor:Colors[theme].buttonBackgroundColor\n            },\n            props.style,\n        ] as StyleProp<ViewStyle>,\n        textStyle:[\n            styles.text, \n            {color:Colors[theme].text},\n            props.textStyle\n        ]\n    }\n    return <DefaultButton {..._props}/>\n}\n\nconst styles = StyleSheet.create({\n    style:{\n        borderRadius:6, \n        borderColor:Colors.button.borderColor, \n        borderWidth:1, \n    },\n    text:{\n        textAlign:'center', \n        fontWeight:'600'\n    }\n});\n","import { useState, useEffect } from 'react';\nimport { Dimensions, ScaledSize } from 'react-native';\n//@ts-ignore\nimport useMobileDetect from 'use-mobile-detect-hook';\n\ntype WindowType = 'portrait' | 'landscape'\n\nconst getWindowType = (window:ScaledSize)=> window.height >= window.width?'portrait':'landscape' as WindowType;\n\nexport default function useResizeWindow() {\n  const detectMobile = useMobileDetect();\n  const [windowType, setWindowType] = useState(getWindowType(Dimensions.get('window')))\n  const onChange = () => setWindowType(getWindowType(Dimensions.get('window')))\n\n  useEffect(() => {\n    Dimensions.addEventListener(\"change\", onChange);\n    return () => {\n      Dimensions.removeEventListener(\"change\", onChange);\n    };\n  });\n  if (detectMobile.isMobile())\n    return 'portrait'\n  return windowType\n}","import { ColorSchemeName, useColorScheme as _useColorScheme } from 'react-native';\n\n// The useColorScheme value is always either light or dark, but the built-in\n// type suggests that it can be null. This will not happen in practice, so this\n// makes it a bit easier to work with.\nexport default function useColorScheme(): NonNullable<ColorSchemeName> {\n  return _useColorScheme() as NonNullable<ColorSchemeName>;\n}\n","import { useEffect } from \"react\";\nimport { useMutation, useQuery, useQueryClient } from \"react-query\";\nimport { getMessengerChannelList, postChannel, postDirectChannel, putChannel } from \"../../apis\";\nimport { MessengerChannel, MessengerContent } from \"../../types\";\nimport { Auth } from \"../useAuthContext\";\nimport useWebsocketContext from \"../useWebsocketContext\";\n\nexport default function useMessengerChannelList(auth?:Auth){\n  const queryClient = useQueryClient()\n  const {lastJsonMessage} = useWebsocketContext()\n  const { data } = useQuery(\"MessengerChannelList\" , async()=>auth?.user?.id?(await getMessengerChannelList(auth.user.id)):[])\n\n  useEffect(()=>{\n    if(lastJsonMessage !=null){\n      if(lastJsonMessage['type']=='enter'){\n        queryClient.setQueryData<MessengerChannel[]>(\"MessengerChannelList\", (_data)=>{\n          return (_data?.find(v=>v.id==lastJsonMessage['data']['id'])?_data:[lastJsonMessage['data'] , ...(_data|| [])]).sort((a, b)=>a.id - b.id)\n        })\n      }\n      if (lastJsonMessage['type']=='next_message'){\n        const data:MessengerContent = lastJsonMessage['data']\n        queryClient.setQueryData<MessengerChannel[]>(\"MessengerChannelList\", (_data)=>(_data || []).map(v=>{\n          if (v.id == data.channel){\n            return {...v, last_message:{content:data.message_set[0]?.content, created:data.created}}\n          }\n          return v\n        }))\n      }\n      // if(lastJsonMessage['type']=='leave'){\n      //   queryClient.setQueryData<Channel[]>(\"MessengerChannelList\", (_data)=>_data?.filter(v=>v.id!=lastJsonMessage['data']['channel_id']) || [])\n      // }\n    }\n  }, [lastJsonMessage])\n  return data\n}\n\nexport function useMessengerChannelSorted(auth?:Auth){\n  const channelList = useMessengerChannelList(auth);\n  return channelList?.sort((a, b)=>(a.last_message?.created || '') < (b.last_message?.created || '')?1:-1)\n}\nexport function useMessengerChannelMutation(){\n  const queryClient = useQueryClient()\n\n  const create = useMutation(postChannel, {\n    onSuccess: ()=>queryClient.invalidateQueries(\"MessengerChannelList\")\n  });\n\n  const update = useMutation(putChannel, {\n    onSuccess: () => queryClient.invalidateQueries(\"MessengerChannelList\")\n  })\n\n  const direct = useMutation(postDirectChannel, {\n    onSuccess: () => queryClient.invalidateQueries(\"MessengerChannelList\")\n  })\n\n  return { create:create.mutateAsync, update:update.mutateAsync, direct:direct.mutateAsync}\n}"],"sourceRoot":""}