{"version":3,"sources":["src/apis/notification.ts","src/lang/index.ts","src/hooks/useAuthContext.tsx","src/hooks/useLangContext.tsx","src/hooks/useColorScheme.ts","src/hooks/useIsMobile.ts","src/components/MobileSafeAreaView.tsx","App.tsx","src/hooks/useCachedResources.ts","src/assets/fonts/SpaceMono-Regular.ttf","src/constants/Envs.ts","src/apis/account.ts","src/apis/messenger.ts","src/apis/axios.ts"],"names":["getNotification","user_id","axios","get","data","length","undefined","postNotification","notification","post","putNotification","put","id","translations","ko","require","RNLocalize","Object","keys","languageTag","isRTL","I18nManager","forceRTL","intl","createIntl","defaultLocale","locale","messages","createIntlCache","AuthContext","createContext","auth","dispatch","authReducer","initialState","action","type","request","username","password","user","Error","AuthProvider","children","useReducer","authState","useState","error","setError","useMemo","groupId","membership_set","find","g","root_group_id","group","useEffect","checkLogin","then","catch","e","console","log","login","response","message","noti","token","logout","Provider","value","useContext","IntlContext","setLocale","IntlProvider","complete","setComplete","AsyncStorage","getItem","v","lang","key","params","formatMessage","defaultMessage","toString","setItem","useInitColorScheme","Appearance","set","colorScheme","setColorScheme","useColorScheme","dark","useTheme","useMobileDetect","isMobile","Platform","OS","props","useIsMobile","window","innerHeight","height","setHeight","onChange","Dimensions","addEventListener","removeEventListener","View","style","queryClient","QueryClient","App","isLoadingComplete","React","setLoadingComplete","SplashScreen","Font","Ionicons","font","warn","useCachedResources","isAppearenceComplete","Navigation","lazy","MobileSafeAreaView","client","fallback","StatusBar","module","exports","accountURL","baseURL","split","websockerURL","FCM_PUBLIC_VAPID_KEY","FCM_API_KEY","TURN_SERVER","endsWith","r","status","setToken","guestLogin","checkLoginToken","getToken","isOffline","code","startsWith","getUserList","group_id","patchUser","patch","ids","updated","name","getUserMembershipList","getExternalMembershipList","getMessengerChannelList","postChannel","channel","postDirectChannel","putChannel","deleteChannel","channel_id","delete","getMessengerMemberList","Promise","resolve","postBulkMessengerMember","user_ids","deleteMessengerMember","member_id","getMessengerContentList","id_lt","id_lt_param","results","getTimerMessageContentList","timer_gt","postMessage","file","formData","FormData","append","entries","forEach","headers","defaults","deleteMessengerContent","content_id","defaultOption","withCredentials","_axios","create","interceptors","use","config","reject","finally","removeItem"],"mappings":"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","file":"static/js/app.f3f14b17.chunk.js","sourcesContent":["import { Notification } from '../types';\nimport axios from './axios';\n\nexport const getNotification = async (user_id:number)=>{\n    const data = (await axios.get(`/api/v1/notifications/?type=WEB&user=${user_id}`) ).data as Notification[]\n    return data.length?data[0]:undefined\n}\n\nexport const postNotification = async(notification:Notification)=>{\n    return (await axios.post(`/api/v1/notifications/`, notification)).data as Notification\n}\n\nexport const putNotification = async(notification:Notification)=>{\n    return (await axios.put(`/api/v1/notifications/${notification.id}/`, notification)).data as Notification\n}","import { createIntl, createIntlCache } from \"@formatjs/intl\";\nimport {I18nManager} from \"react-native\";\nimport * as RNLocalize from \"react-native-localize\";\n\nexport const translations = {\n  ko: require(\"./ko.json\"),\n} as const;\n\ntype Translation = keyof typeof translations;\n\n// fallback if no available language fits\nconst fallback = { languageTag: \"en\", isRTL: false };\n\nconst { languageTag, isRTL } =\n  RNLocalize.findBestLanguageTag(Object.keys(translations)) ?? fallback;\n\n// update layout direction\nI18nManager.forceRTL(isRTL);\n\n// console.log(languageTag)\nconst intl = createIntl(\n  {\n    defaultLocale: \"en\",\n    locale: languageTag,\n    messages: translations[languageTag as Translation],\n  },\n  createIntlCache(),\n);\n\nexport default intl","import React, { createContext, useContext, useEffect, useReducer, useMemo, Dispatch, useState } from \"react\"\nimport { checkLogin, login, logout } from \"../apis\"\nimport { getNotification, putNotification } from \"../apis/notification\"\nimport { UserMembership } from \"../types\"\n\ntype AuthAction = {type:string, username?:string, password?:string, user?:UserMembership|null}\n\nexport type Auth = {user?:UserMembership|null, groupId?:number}\n\ntype AuthState ={user?:UserMembership|null, request?:{username:string, password:string}|null}\n\nconst AuthContext = createContext<{auth:Auth, error?:string, dispatch:Dispatch<AuthAction>}>({auth:{}, dispatch:()=>{}});\n\nconst authReducer =(initialState:AuthState, action:AuthAction)=>{\n  switch (action.type){\n      case 'LOGIN_REQUEST':\n        return {\n          ...initialState,\n          request:{username:action.username, password:action.password},\n        } as AuthState\n      case 'LOGIN_GUEST':\n        return {\n          ...initialState,\n          request:{username:'guest', password:'guest'},\n        } as AuthState\n      case 'LOGIN_SUCCESS':\n          return{\n              ...initialState,\n              user:action.user,\n              request:undefined\n          }\n      case 'LOGIN_FAILED':\n          return{\n              ...initialState,\n              request:undefined\n          }\n      case 'LOGOUT_REQUEST':\n          return{\n              ...initialState,\n              request:null\n          }\n      case 'LOGOUT_SUCCESS':\n          return {\n            ...initialState,\n            user:null,\n            request:undefined\n          }\n      case 'REFRESH':\n        return {\n          ...initialState,\n          user:undefined\n        }\n      default:\n          throw new Error( `Unhandled action type: ${action.type}`)\n  }\n}\n\n\nexport const AuthProvider = ({children}:{children:React.ReactNode})=>{\n  const [authState, dispatch] = useReducer(authReducer, {} as Auth)\n  const [error, setError] = useState<string>()\n  const auth = useMemo(()=>({\n    user:authState.user,\n    groupId: authState.user?.membership_set.find(g=>g.root_group_id==null)?.group\n  }), [authState])\n  useEffect(()=>{\n    if(authState.user===undefined){\n      checkLogin().then((user)=>{\n        dispatch({type:\"LOGIN_SUCCESS\", user})\n      }).catch((e)=>{\n        console.log(e)\n        dispatch({type:\"LOGOUT_SUCCESS\"})\n      })\n    }\n    else if(authState.user===null && authState.request){\n      login(authState.request.username, authState.request.password).then(user=>{\n        dispatch({type:\"LOGIN_SUCCESS\", user})\n      }).catch((data)=>{\n        dispatch({type:\"LOGIN_FAILED\"})\n        setError(data.response?.data?.message)\n      })\n    }\n    else if(authState.user && authState.request===null){\n      getNotification(authState.user.id).then(noti=>{\n        noti && putNotification({...noti, token:''}).then(()=>{\n          logout().then(()=>dispatch({type:\"LOGOUT_SUCCESS\"}))\n        })\n      })\n    }\n  }, [authState])\n  return <AuthContext.Provider value={{auth, error, dispatch}}>\n    {children}\n  </AuthContext.Provider>\n}\n\nexport default ()=>{\n  const authContext = useContext(AuthContext)\n  return authContext\n}\n","import React, { createContext, useContext, useState, useEffect } from \"react\";\nimport { IntlShape } from \"@formatjs/intl\";\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport intl, { translations } from \"../lang\";\n\nconst IntlContext = createContext<{locale?:string, setLocale:(locale:string|undefined)=>void}>({locale:'auto', setLocale:()=>{}});\n\nexport const IntlProvider = ({children}:{children:React.ReactNode})=>{\n  const [complete, setComplete] = useState(false)\n  const [locale, setLocale] = useState<string>()\n  useEffect(()=>{\n    AsyncStorage.getItem(\"locale\").then(v=>{\n      setLocale(v || 'auto')\n      setComplete(true)\n    })\n  }, [])\n  return complete?<IntlContext.Provider value={{locale, setLocale}}>\n      {children}\n    </IntlContext.Provider>:<></>\n}\n\n\n\ntype TranslationParams = Parameters<IntlShape<string>[\"formatMessage\"]>[1];\n\nexport default ()=>{\n  const { locale, setLocale } = useContext(IntlContext)\n  return {\n    lang:(key: string, params?: TranslationParams) => {\n      if (locale == 'en' || key.length==0)\n        return key\n      if (locale != undefined && locale !='auto')\n        return translations[locale as 'ko'][key]\n      return intl\n        .formatMessage({ id: key, defaultMessage: key }, params)\n        .toString()\n    },\n    locale,\n    setLocale: (locale:string)=>{AsyncStorage.setItem('locale', locale).then(()=>setLocale(locale))}\n  }\n}\n","import AsyncStorage from '@react-native-async-storage/async-storage';\nimport { useTheme } from '@react-navigation/native';\nimport { useMemo, useEffect, useState } from 'react';\nimport { ColorSchemeName } from 'react-native';\nimport { Appearance, ColorSchemeName as UserColorSchemeName } from 'react-native-appearance';\n\n// The useColorScheme value is always either light or dark, but the built-in\n// type suggests that it can be null. This will not happen in practice, so this\n// makes it a bit easier to work with.\n\nexport function useInitColorScheme(){\n  const [complete, setComplete] = useState(false)\n  useEffect(()=>{\n    if (!complete){\n      AsyncStorage.getItem(\"color\").then(v=>{\n        Appearance.set({colorScheme:(v==null)?'no-preference':(v as any)})\n        setComplete(true)\n      })\n    }\n  }, [complete])\n  return complete\n}\n\nexport function setColorScheme(colorScheme:UserColorSchemeName){\n  AsyncStorage.setItem('color',colorScheme as string).then(()=>Appearance.set({colorScheme}))\n}\n\nexport default function useColorScheme(): NonNullable<ColorSchemeName> {\n  const { dark } = useTheme()\n  const colorScheme = useMemo(()=> dark?'dark':'light', [dark]) as NonNullable<ColorSchemeName>;\n  return colorScheme\n}\n","import { Platform } from 'react-native';\n//@ts-ignore\nimport useMobileDetect from 'use-mobile-detect-hook';\n\nexport default ()=>{\n    const detectMobile = useMobileDetect();\n    return (detectMobile.isMobile() || Platform.OS == 'android' || Platform.OS == 'ios') as boolean\n}","import React, { useEffect, useState } from 'react'\nimport { Dimensions, Platform, View } from 'react-native'\nimport useIsMobile from '../hooks/useIsMobile'\n\n\nexport default (props:{children:React.ReactNode})=>{\n    const isMobile = useIsMobile()\n    const [height, setHeight] = useState(window.innerHeight + 1)\n    useEffect(()=>{\n        if(isMobile && Platform.OS == 'web'){\n            const onChange = (e:any)=>{\n                setHeight(window.innerHeight + 1)\n            }\n            Dimensions.addEventListener(\"change\",onChange)\n            return () => Dimensions.removeEventListener(\"change\", onChange)\n            \n        }\n    },[ isMobile])\n    return <View style={{height:isMobile&&Platform.OS == 'web'?height:'100%'}}>\n        {props.children}\n    </View>\n\n}\n  ","import React, { Suspense } from 'react';\nimport { StatusBar } from 'expo-status-bar';\nimport { SafeAreaProvider } from 'react-native-safe-area-context';\nimport useCachedResources from './src/hooks/useCachedResources';\nimport { useInitColorScheme } from './src/hooks/useColorScheme';\nimport MobileSafeAreaView from './src/components/MobileSafeAreaView';\nimport { AuthProvider } from './src/hooks/useAuthContext';\nimport { QueryClient, QueryClientProvider } from 'react-query';\nimport { IntlProvider } from './src/hooks/useLangContext';\n\nconst queryClient = new QueryClient();\n\nexport default function App() {\n  const isLoadingComplete = useCachedResources();\n  const isAppearenceComplete = useInitColorScheme()\n  const Navigation = React.lazy(()=> import('./src/navigation'))\n  if (!isLoadingComplete || !isAppearenceComplete) {\n    return null;\n  } else {\n    return (\n      <SafeAreaProvider>\n        <MobileSafeAreaView>\n          <AuthProvider>\n            <QueryClientProvider client={queryClient}>\n              <IntlProvider>\n                {/* devtools */}\n                {/* <ReactQueryDevtools initialIsOpen={true} /> */}\n                <Suspense fallback={<></>}>\n                  <Navigation/>\n                </Suspense>\n                <StatusBar />\n              </IntlProvider>\n            </QueryClientProvider>\n          </AuthProvider>\n        </MobileSafeAreaView>\n      </SafeAreaProvider>\n    );\n  }\n}\n","import { Ionicons } from '@expo/vector-icons';\nimport * as Font from 'expo-font';\nimport * as SplashScreen from 'expo-splash-screen';\nimport * as React from 'react';\n\nexport default function useCachedResources() {\n  const [isLoadingComplete, setLoadingComplete] = React.useState(false);\n\n  // Load any resources or data that we need prior to rendering the app\n  React.useEffect(() => {\n    async function loadResourcesAndDataAsync() {\n      try {\n        SplashScreen.preventAutoHideAsync();\n\n        // Load fonts\n        await Font.loadAsync({\n          ...Ionicons.font,\n          'space-mono': require('../assets/fonts/SpaceMono-Regular.ttf'),\n        });\n      } catch (e) {\n        // We might want to provide this error information to an error reporting service\n        console.warn(e);\n      } finally {\n        setLoadingComplete(true);\n        SplashScreen.hideAsync();\n      }\n    }\n\n    loadResourcesAndDataAsync();\n  }, []);\n\n  return isLoadingComplete;\n}\n","module.exports = __webpack_public_path__ + \"./fonts/SpaceMono-Regular.ttf\";","// @ts-ignore\nimport {API_URL, FCM_PUBLIC_VAPID_KEY as fcm1, FCM_API_KEY as fcm2, TURN_SERVER as turn1 } from \"@env\"\nexport const accountURL =  `${API_URL}/account/`\nexport const baseURL =  `${API_URL}/messenger/`\nconst [SCHEMA, DOMAIN] = `${API_URL}`.split('://')\nexport const websockerURL = `${SCHEMA=='https'?'wss':'ws'}://${DOMAIN}`\nexport const FCM_PUBLIC_VAPID_KEY = fcm1\nexport const FCM_API_KEY = fcm2\nexport const TURN_SERVER = turn1","\nimport { User, UserMembership } from '../types';\nimport axios, { getToken, setToken } from './axios';\nimport {accountURL as baseURL} from '../constants/Envs'\n\nexport const login = async(username:string, password:string) => {\n    if(username.endsWith('.guest') && password.length == 0)\n        password = 'guest'\n    const r = await axios.post(\"/api-token-auth/\", {username, password});\n    if(r.status == 200){\n        await setToken(r.data)\n        return await checkLogin()\n    }\n}\n\nexport const logout = async() => {\n    await setToken(null)\n    return await axios.get(\"/api-auth/logout/\")\n}\n\nexport const guestLogin =  async() => {\n    return await login('guest', 'guest')\n}\n\nconst checkLoginToken = async ()=>{\n    const value = (await axios.get(\"/api/v1/users/memberships/?_self=true\"))?.data\n    if (value && value.length){\n        return value[0] as UserMembership\n    }\n    return null\n}\n\nexport const checkLogin = async() => {\n    const token = await getToken()\n    if (token === null)\n        return null\n    try{\n       return await checkLoginToken()\n    }\n    catch(e:any){\n        let error = e\n        if(e.response !== undefined && e.response.status==401){\n            try{\n                return await checkLoginToken()\n            }\n            catch(e2){\n                error = e2\n            }\n        }\n        const isOffline = ((error as any).code == \"ERR_NETWORK\" || (error as any).message && ((error as any).message as string).startsWith(\"Cannot read\"))\n        throw {error, isOffline}\n    }\n}\n\nexport const getUserList = async (group_id:number)=>{\n    return (await axios.get(`/api/v1/users/?group_id=${group_id}`) ).data as User[]\n}\n\nexport const patchUser = async (user:{id:number, name:string})=>{\n    await axios.patch(`/api/v1/user/`, {ids:[user.id], updated: {name:user.name}}, {baseURL})\n}\n\nexport const getUserMembershipList = async (group_id:number)=>{\n    return (await axios.get(`/api/v1/users/memberships/?group_id=${group_id}`) ).data as UserMembership[]\n}\n\nexport const getExternalMembershipList = async (username:string)=>{\n    return (await axios.get(`/api/v1/users/memberships/?username=${username}`) ).data as UserMembership[]\n}","import { Channel, MessengerMember, MessengerContent, EditMessage, MessengerChannel } from '../types';\nimport axios from './axios';\n\nexport const getMessengerChannelList = async (user_id:number)=>{\n    return (await axios.get(`/api/v1/channels/messenger/?type=messenger&messenger_user_id=${user_id}`) ).data as MessengerChannel[]\n}\n\nexport const postChannel = async(channel:Channel)=>{\n    return (await axios.post(`/api/v1/channels/`, channel)).data as Channel\n}\n\nexport const postDirectChannel = async(channel:Channel)=>{\n    return (await axios.post(`/api/v1/channels/direct/`, channel)).data as Channel\n}\n\nexport const putChannel = async(channel:Channel)=>{\n    return (await axios.put(`/api/v1/channels/${channel.id}/`, channel)).data as Channel\n}\n\nexport const deleteChannel = async(channel_id:number)=>{\n    await axios.delete(`/api/v1/channels/${channel_id}/`)\n}\n\nexport const getMessengerMemberList = async(channel_id:number)=>{\n    try{\n        return (await axios.get(`/api/v1/messengermembers/?channel=${channel_id}`) ).data as MessengerMember[]\n    }\n    catch(e){\n        return Promise.resolve(null)\n    }\n}\n\nexport const postBulkMessengerMember = async(data:{channel_id:number, user_ids:number[]})=>{\n    await axios.post(`/api/v1/messengermembers/bulk/`, {channel:data.channel_id, user_ids:data.user_ids})\n}\n\nexport const deleteMessengerMember = async(member_id:number)=>{\n    await axios.delete(`/api/v1/messengermembers/${member_id}/`)\n}\n\nexport const getMessengerContentList = async (channel_id:number, id_lt?:number)=>{\n    const id_lt_param = id_lt?`&id_lt=${id_lt}`:''\n    return (await axios.get(`/api/v1/messengercontents/?limit=30&channel=${channel_id}${id_lt_param}`)).data.results as MessengerContent[]\n}\n\nexport const getTimerMessageContentList = async (channel_id:number, timer_gt:string)=>{\n    return (await axios.get(`/api/v1/messengercontents/?channel=${channel_id}&timer_gt=${timer_gt}`)).data as MessengerContent[]\n}\n\nexport const postMessage = async (message:EditMessage)=>{\n    if (message.file){\n        const formData = new FormData(); // formData 객체를 생성한다.\n        formData.append(\"file\", message.file)\n        Object.entries(message).forEach(value=>{\n            formData.append(value[0], `${value[1]}`)\n        })\n        await axios.post(`/api/v1/messengercontents/messages/`, formData, {headers:{\n            ...(axios.defaults.headers as any), \"Content-Type\": \"multipart/form-data\",\n        }})\n    }\n    else{\n        await axios.post(`/api/v1/messengercontents/messages/`, message)\n    }\n}\n\nexport const deleteMessengerContent = async (content_id:number)=>{\n    await axios.delete(`/api/v1/messengercontents/${content_id}/`)\n}","import axios, { AxiosRequestConfig } from 'axios';\nimport {accountURL, baseURL} from \"../constants/Envs\"\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nconst defaultOption:AxiosRequestConfig = {\n    baseURL,\n    withCredentials: true,\n    headers: {}\n};\nconst _axios = axios.create(defaultOption);\n\n_axios.interceptors.request.use(\n    config => {\n        return config;\n    },\n    error => {\n        return Promise.reject(error);\n    }\n)\n\n_axios.interceptors.response.use(\n    response => {\n        // if((response.request.responseURL as string).indexOf('/task/login')>=0 && response.data.length != 0){\n        //     // redirect login\n        // }\n        return response;\n    },\n    error => {\n        if (error.response.status === 401) {\n            return getToken().then(async(token)=>{\n                if (token){\n                    const r = await _axios.post(\"/api/v1/user/sso/refresh/\", {token}, {headers:{'Authorization':''}, baseURL: accountURL})\n                    if (r.status == 200 && r.data !== ''){\n                        setToken(r.data)\n                    }\n                }\n            }).finally(()=>{\n                return Promise.reject(error)\n            })\n        }\n        return Promise.reject(error)\n    }\n)\n\nexport const setToken = async (token:string|null)=>{\n    _axios.defaults.headers['Authorization'] = `JWT ${token}`\n    if (token)\n        await AsyncStorage.setItem(\"Authorization\", token)\n    else\n        AsyncStorage.removeItem(\"Authorization\")\n}\nexport const getToken = async ()=>{\n    const token = await AsyncStorage.getItem(\"Authorization\")\n    _axios.defaults.headers['Authorization'] = token?`JWT ${token}`:null\n    return token\n}\n\nexport default _axios\n"],"sourceRoot":""}