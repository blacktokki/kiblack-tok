{"version":3,"sources":["src/components/Themed.tsx","src/constants/Colors.ts","src/hooks/useModalsContext.tsx","src/hooks/useResizeContext.tsx","src/components/CommonButton.tsx","src/lib/react-native-paper/Avatar.tsx","src/components/Avatar.tsx","src/components/CommonSection.tsx","src/components/ModalSection.tsx","src/hooks/lists/useMessengerChannelList.ts","src/hooks/useWebsocketContext.tsx","src/components/TextButton.tsx","src/navigation/index.tsx","src/hooks/lists/useMessengerMemberList.ts","src/modals/ChannelEditModal.tsx","src/components/HeaderRight.tsx","src/hooks/lists/useUserMembershipList.ts","src/components/TabView.tsx","src/components/CommonItem.tsx","src/hooks/lists/useMessengerContentList.ts","src/modals/GuestLogoutModal.tsx","src/components/CommonTextInput.tsx","src/components/MemberItem.tsx","src/modals/DateTimePickerModal.tsx","src/modals/MessageModal.tsx","src/modals/ProfileModal.tsx","src/components/Profile.tsx","src/hooks/useFirebaseContext.tsx","src/components/ContractFooter.tsx","src/screens/main/LoginScreen.tsx","src/components/LinkPreview.tsx","src/lib/react-native-webrtc/useWebsocketContext.tsx","src/lib/react-native-webrtc/webrtc/p2p.tsx","src/lib/react-native-webrtc/webrtc/index.ts","src/lib/react-native-webrtc/LocalCam.tsx","src/lib/react-native-webrtc/RemoteCam.tsx","src/screens/main/ChatScreen/VideoCallSection.tsx","src/components/FilePreview.tsx","src/screens/main/ChatScreen/TimerTags.tsx","src/hooks/lists/useTimerMessageContent.ts","src/screens/main/ChatScreen/index.tsx","src/screens/main/HomeScreen/ConfigSections.tsx","src/screens/main/HomeScreen/index.tsx","src/screens/main/InviteeScreen.tsx","src/screens/index.ts","src/hooks/useLocalSearch.ts","src/modals/InviteModal.tsx","src/hooks/lists/useExternalMembershipList.ts","src/components/RowField.tsx","src/components/TextField.tsx","src/navigation/LinkingConfiguration.ts","web/firebase-config.js","src/screens/NotFoundScreen.tsx","src/navigation/DrawerNavigator.tsx","src/modals/index.ts","src/navigation/RootNavigator.tsx"],"names":["useThemeColor","props","colorName","theme","useColorScheme","colorFromProps","Colors","Text","style","lightColor","darkColor","otherProps","_objectWithoutProperties","_excluded","color","light","dark","React","DefaultText","_extends","View","_excluded2","backgroundColor","DefaultView","text","background","tint","tabIconDefault","tabIconSelected","header","buttonColor","buttonBackgroundColor","buttonBorderColor","iconColor","borderColor","focus","ModalsContext","createContext","setModal","ModalsProvider","_ref","children","allModals","modals","_useState","useState","_useState2","_slicedToArray","setModals","windowType","useResizeContext","_useState3","_useState4","animationType","setAnimationType","useEffect","filter","v","visible","length","map","Component","createElement","Provider","value","newModals","m","_objectSpread","modal","index","Modal","key","transparent","useContext","getWindowType","window","height","width","ResizeContextContext","Dimensions","get","ResizeContextProvider","detectMobile","useMobileDetect","_useWindowDimensions","useWindowDimensions","setWindowType","isMobile","DefaultButton","hover","setHover","Pressable","onPress","onHoverIn","onHoverOut","disabled","paddingVertical","paddingHorizontal","selectable","fontSize","textStyle","title","_props","styles","StyleSheet","create","borderRadius","borderWidth","textAlign","fontWeight","normalizeHash","hash","min","max","Math","floor","str","initHash","i","charCodeAt","abs","stringToHSL","name","userId","Avatar","size","label","split","join","toUpperCase","avatarFromChannel","item","user","avatar","member_count","id","subowner","owner","CommonSection","outerContainer","outerContainerStyle","container","containerStyle","withSeparator","separator","undefined","titleView","titleStyle","subtitle","bodyView","bodyStyle","maxWidth","alignItems","marginHorizontal","marginVertical","flexDirection","marginBottom","flex","marginTop","padding","justifyContent","alignSelf","flexShrink","margin","BottomSheet","useMessengerChannelList","auth","queryClient","useQueryClient","lastJsonMessage","useWebsocketContext","data","useQuery","_auth$user","_regeneratorRuntime","async","_context","prev","next","awrap","getMessengerChannelList","t0","sent","abrupt","stop","Promise","setQueryData","_data","find","concat","_toConsumableArray","sort","a","b","_data2$message_set$","channel","last_message","content","message_set","created","useMessengerChannelSorted","channelList","_a$last_message","_b$last_message","useMessengerChannelMutation","useMutation","postChannel","onSuccess","invalidateQueries","update","putChannel","direct","postDirectChannel","mutateAsync","defaultContext","sendJsonMessage","WebSocketContext","WebSocketInternalProvider","path","Context","useBackground","token","setToken","AppState","currentState","isActive","setIsActive","_useWebSocket","useWebSocket","websockerURL","shouldReconnect","closeEvent","protocols","onOpen","e","console","log","onClose","AsyncStorage","getItem","then","onChange","nextState","addEventListener","removeEventListener","WebSocketProvider","_ref2","disable","Fragment","CommonButton","navigationRef","navigate","params","_navigationRef$curren","_navigationRef$curren2","current","Navigation","defaultColorScheme","useDefaultColorScheme","userColorScheme","colorScheme","NavigationContainer","ref","documentTitle","formatter","options","route","linking","process","versions","LinkingConfiguration","DarkTheme","DefaultTheme","RootNavigator","l","search","decoded","slice","s","replace","history","replaceState","pathname","location","ignoreWarnings","_console","_","clone","warn","message","Object","forEach","indexOf","useMessengerMemberList","channel_id","getMessengerMemberList","useMessengerMemberMutation","invite","postBulkMessengerMember","leave","deleteMessengerMember","ChannelEditModal","member_id","type","lang","useLangContext","useAuthContext","useModalsContext","channelMutation","messengerMemberMutation","setName","description","setDescription","back","_name","ModalSection","TextField","setValue","multiline","groupId","_auth$user2","newChannel","group","screen","field","_useAuthContext","dispatch","defaultButtonProps","username","endsWith","GuestLogoutModal","buttonProps","extra","k","TextButton","useUserMembershipList","getUserMembershipList","_React$useState","_React$useState2","setIndex","entries","tabs","onTab","icons","assign","apply","_defineProperty","icon","TabView","renderTabBar","TabBar","indicatorStyle","activeColor","inactiveColor","renderIcon","scene","onTabPress","findIndex","_ref4","_ref5","navigationState","routes","_ref6","_ref7","onIndexChange","renderScene","SceneMap","_ref8","_ref9","component","tabBarPosition","CommonItem","_React$useState3","_React$useState4","press","setPress","onPressIn","onPressOut","minHeight","borderBottomWidth","useMessengerContentList","_useInfiniteQuery","useInfiniteQuery","pageParam","getMessengerContentList","select","pages","getNextPageParam","lastPage","refetchOnReconnect","refetchOnWindowFocus","fetchNextPage","pageParams","page","timer","len","newCurrent","useMessengerContentMutation","channelId","postMessage","_patch","patchMessengerContent","_delete","deleteMessengerContent","d","variables","mutate","patch","delete","contentHeight","setContentHeight","TextInput","editable","onChangeText","onContentSizeChange","nativeEvent","contentSize","onBlur","onEndEditing","member","marginRight","dayTypes","hours","Array","keys","toString","padStart","minutes","getDisableDays","date","startDate","startOf","add","endDate","endOf","today","dayjs","result","push","format","Calendar","lazy","CommonPicker","DateTimePickerModal","datetime","callback","_dayjs","restMinute","parseInt","defaultDayjs","_useLangContext","locale","setDate","dayType","setDayType","_useState5","_useState6","hour","setHour","_useState7","_useState8","minute","setMinute","_useState9","_useState10","disableDays","setDisableDays","TouchableOpacity","Ionicons","Suspense","fallback","disableAllTouchEventsForDisabledDays","onMonthChange","dateString","markedDates","reduce","p","c","selected","values","toISOString","MessageModal","isOwner","isTimer","contentMutation","Clipboard","setString","ProfileModal","userList","isSelf","Profile","_auth$user3","patchUser","finally","CommonTextInput","firebaseConfig","require","messagingSenderId","apiKeyEncrypted","FCM_API_KEY","app","firebase","initializeApp","apiKey","messaging","onMessage","payload","Notification","permission","JSON","parse","channel_name","body","alert","noti","requestToken","serviceWorkerRegistration","currentToken","_context2","requestPermission","navigator","serviceWorker","register","scope","getToken","vapidKey","FCM_PUBLIC_VAPID_KEY","catch","event","preventDefault","unregister","notiListener","enable","setEnable","_context4","getNotification","postNotification","_context3","putNotification","_noti","_noti2","_enable","_noti3","_context5","changeEnable","openURL","Platform","OS","url","href","Linking","Styles","footer_buttons","footer_button","AntDesign","paddingBottom","paddingRight","login_container","login_header","paddingTop","login_header_logo","resizeMode","login_header_text","login_header_text_bold","login_wrapper","borderTopRightRadius","borderTopLeftRadius","form","form_error","form_error_text","textAlignVertical","form_input","button","button_label","login_social","login_social_separator","login_social_separator_line","login_social_separator_text","login_social_buttons","login_social_button","login_social_icon","login_social_facebook","login_footer_text","guest_footer_text","login_footer_link","link","onLongPress","image","Image","source","uri","maxHeight","TURN_SERVER","peerConstraints","iceServers","urls","sessionConstraints","mandatory","OfferToReceiveAudio","OfferToReceiveVideo","VoiceActivityDetection","mediaConstraints","audio","video","framerate","onICEcandidate","pc","_message","rtcMessage","candidate","RTCIceCandidate","addIceCandidate","sendICEcandidate","sendMessage","receiver","target","optimizeSdp","offerDescription","arr","sdp","test","RTCSessionDescription","createOffer","pcRefCurrent","stream","addStream","t1","setLocalDescription","camStyle","cam","bottonContainer","position","bottom","buttonBar","_props$user","_useWebsocketContext","_useLocalCam","pcRef","useRef","sender","setSender","_stream","setStream","isPlay","useMemo","CustomRTCView","useCallback","memo","RTCView","videoProps","start","mode","newStream","mediaDevices","getUserMedia","getDisplayMedia","_ref3","error","getTracks","track","websocketOnMessage","response","peerConnection","_peerConnection","answerDescription","_peerConnection2","RTCPeerConnection","setRemoteDescription","useLocalCam","Button","setReceiver","_useRemoteCam","setUser","close","clearInterval","statsInterval","_pcRef$current","_pcRef$current2","_pcRef$current3","_pcRef$current4","streams","_peerConnection3","_answerDescription","_streams","iceConnectionState","activeStream","setInterval","stats","statsOutput","framePerSecond","getStats","report","kind","statName","framesPerSecond","Date","toTimeString","addTransceiver","direction","getRemoteStreams","createAnswer","localDescription","useRemoteCam","VideoView","scale","flexGrow","focusGuest","setFocusGuest","VideoCallContainer","setDisable","useIsMobile","videoMode","setVideoMode","guests","setGuests","_useRtcContext","useRtcContext","ceil","sqrt","toggleVideoMode","ThemedView","aspectRatio","borderLeftWidth","flexWrap","RemoteCam","LocalCam","RtcProvider","file","showBorder","FontAwesome","filename","pow","toFixed","humanFileSize","filesize","_timerFormat","now","year","month","day","timerToString","TimerTag","end","ratio","diff","setExpand","isExpand","overflow","Hyperlink","linkDefault","wordBreak","linkStyle","timerMessages","getTimerMessageContentList","sorted","_sorted$","ms","Number","MAX_VALUE","timeout","setTimeout","clearTimeout","useTimerMessageContentList","setNow","expand","MessengerContentPageItem","_nextPage2","nextPage","_nextPage","nextContent","index2","isSystem","isFirst","ownerId","dayChanged","marginLeft","file_set","fileIndex","FilePreview","link_set","linkIndex","LinkPreview","ConfigSection","setLocale","configTheme","useConfigColorScheme","_useFirebaseContext","useFirebaseContext","setNoti","n","textDecorationLine","setColorScheme","MemberTabView","memberItem","MemberItem","ScrollView","MessengerTabView","_item$last_message","_item$last_message2","_item$last_message3","_avatarFromChannel","opacity","paddingLeft","unread_count","ConfigTabView","ConfigSections","getBottomTabs","OneTab","MaterialCommunityIcons","TwoTab","FourTab","SimpleLineIcons","InviteeScreen","_route$params","navigation","enterGuest","setEnterGuest","useLayoutEffect","setOptions","headerRight","user_ids","main","HomeScreen","_route$params2","home","setHome","HeaderRight","tab","StyledText","ContractFooter","setParams","ChatScreen","_useMessengerChannelL","inputRef","channelAvatar","_useMessengerContentL","memberList","_memberList$find","setTimer","autoFocus","setAutoFocus","bottomTab","setBottomTab","postValue","InviteModal","renderItem","canGoBack","goBack","_auth$user4","minWidth","VideoCallSection","FlatList","contentContainerStyle","onScroll","contentOffset","y","onLayout","layout","TimerTags","borderBottomRightRadius","top","Entypo","onSubmitEditing","blurOnSubmit","onFocus","borderBottomLeftRadius","resolve","reject","input","document","onchange","files","onabort","onerror","click","f","_auth$user5","login","LoginScreen","setUsername","password","setPassword","_login","placeholder","autoCapitalize","keyboardType","secureTextEntry","localSearchReducer","initialState","action","keyword","active","Error","InviteItem","selectedRef","has","setSelected","GroupTabView","_useLocalSearch","compare","_useReducer","useReducer","_useReducer2","searchState","useLocalSearch","memberSet","Set","includes","dispatchKeyword","ExternalMembershipTabView","setKeyword","copied","setCopied","timeoutRef","externalMemberList","getExternalMembershipList","useExternalMembershipList","inviteLink","drawerTabs","external","RowField","rowStyle","ROOTPATH","prefixes","config","screens","Main","NotFound","module","exports","NotFoundScreen","linkText","DrawerTabView","MessengerTab","colors","useTheme","onAddList","tabBar","card","borderTopColor","border","pointerEvents","accessibilityRole","borderTopWidth","drawerTab","Tab","elevation","borderRightWidth","Root","createStackNavigator","Navigator","headerMode","screenOptions","cardStyle","animationEnabled","cardStyleInterpolator","CardStyleInterpolators","forVerticalIOS","Screen","MainNavigator","headerShown","gestureDirection","modalValues","DrawerNavigator","headerStyle","headerTitleStyle","headerLeft","canGOBackScreen","headerLeftContainerStyle","forHorizontalIOS"],"mappings":"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","file":"static/js/6.fc929e7e.chunk.js","sourcesContent":["/**\r\n * Learn more about Light and Dark modes:\r\n * https://docs.expo.io/guides/color-schemes/\r\n */\r\n\r\nimport * as React from 'react';\r\nimport { Text as DefaultText, View as DefaultView } from 'react-native';\r\n\r\nimport Colors from '../constants/Colors'\r\nimport useColorScheme from '../hooks/useColorScheme';\r\n\r\nexport function useThemeColor(\r\n  props: { light?: string; dark?: string },\r\n  colorName: keyof typeof Colors.light & keyof typeof Colors.dark\r\n) {\r\n  const theme = useColorScheme();\r\n  const colorFromProps = props[theme];\r\n\r\n  if (colorFromProps) {\r\n    return colorFromProps;\r\n  } else {\r\n    return Colors[theme][colorName];\r\n  }\r\n}\r\n\r\ntype ThemeProps = {\r\n  lightColor?: string;\r\n  darkColor?: string;\r\n};\r\n\r\nexport type TextProps = ThemeProps & DefaultText['props'];\r\nexport type ViewProps = ThemeProps & DefaultView['props'];\r\n\r\nexport function Text(props: TextProps) {\r\n  const { style, lightColor, darkColor, ...otherProps } = props;\r\n  const color = useThemeColor({ light: lightColor, dark: darkColor }, 'text');\r\n\r\n  return <DefaultText style={[{ color }, style]} {...otherProps} />;\r\n}\r\n\r\nexport function View(props: ViewProps) {\r\n  const { style, lightColor, darkColor, ...otherProps } = props;\r\n  const backgroundColor = useThemeColor({ light: lightColor, dark: darkColor }, 'background');\r\n\r\n  return <DefaultView style={[{ backgroundColor }, style]} {...otherProps} />;\r\n}\r\n","const tintColorLight = '#2f95dc';\r\nconst tintColorDark = '#fff';\r\n\r\nexport default {\r\n  light: {\r\n    text: '#000',\r\n    background: '#fff',\r\n    tint: tintColorLight,\r\n    tabIconDefault: '#ccc',\r\n    tabIconSelected: tintColorLight,\r\n    header:'#24292f',\r\n    buttonColor:'rgb(242,242,242)',\r\n    buttonBackgroundColor: '#f6f8fa', //'rgba(9,30,66,0.08)',//rgb(242,242,242)\\\r\n    buttonBorderColor:'rgba(27,31,36,0.15)',\r\n    iconColor: 'black'\r\n  },\r\n  dark: {\r\n    text: '#fff',\r\n    background: '#000',\r\n    tint: tintColorDark,\r\n    tabIconDefault: '#ccc',\r\n    tabIconSelected: tintColorDark,\r\n    header:'#161b22',\r\n    buttonColor:'rgb(1,4,9)',\r\n    buttonBackgroundColor: '#282624',\r\n    buttonBorderColor:'rgba(229,225,220,0.15)',\r\n    iconColor: 'white'\r\n  },\r\n  borderColor:'#d0d7de',\r\n  \r\n  focus:'#0065A4',\r\n};\r\n","import React, { useState, createContext, useContext, useEffect } from \"react\";\r\nimport { Modal } from \"react-native\";\r\nimport useResizeContext from \"./useResizeContext\";\r\n\r\ntype ModalProps = any\r\n\r\ntype ModalState = {\r\n  Component:React.ComponentType<ModalProps>,\r\n  props:any\r\n  visible:boolean\r\n}\r\ntype SetModal = (Component:ModalState[\"Component\"]|null, props:ModalProps|null)=>void\r\n\r\nconst ModalsContext = createContext<{setModal: SetModal}>({\r\n    setModal: () => {}\r\n});\r\n\r\nexport const ModalsProvider = ({children, modals:allModals}:{children:React.ReactNode, modals:React.ComponentType<ModalProps>[]}) => {\r\n    const [modals, setModals] = useState<ModalState[]>([]);\r\n    const windowType = useResizeContext();\r\n    const [animationType, setAnimationType] = useState('none')\r\n    const setModal:SetModal = (Component, props) => {\r\n        const newModals = modals.map(m=>{\r\n            if(Component==null){\r\n                return {\r\n                    ...m,\r\n                    visible:false\r\n                }\r\n            }\r\n            else if(m.Component == Component){\r\n                return {\r\n                    Component, \r\n                    props:props!==null?props:m.props,\r\n                    visible:props!==null\r\n                }\r\n            }\r\n            return m        \r\n        })\r\n        setModals(newModals);\r\n    }\r\n    useEffect(()=>{\r\n        if (modals.filter(v=>v.visible).length == 0)\r\n            setAnimationType(windowType == 'landscape'?'fade':'slide')\r\n    }, [windowType])\r\n    useEffect(()=>{\r\n        setModals(allModals.map((Component)=>({Component, props:null, visible:false})))\r\n    }, [allModals])\r\n    return <ModalsContext.Provider value={{setModal}}>\r\n        {children}\r\n        {modals.map((modal, index)=>{\r\n            const { Component, props, visible } = modal;\r\n            return <Modal key={index} animationType={animationType as any} visible={visible} transparent>\r\n                <Component {...props}/>\r\n            </Modal>\r\n        })}\r\n    </ModalsContext.Provider>\r\n}\r\n\r\nexport default ()=>{\r\n    const modalsContext = useContext(ModalsContext)\r\n    return modalsContext\r\n}\r\n\r\n","import React, { useState, useEffect, createContext, useContext, useMemo } from 'react';\r\nimport { Dimensions, ScaledSize, useWindowDimensions } from 'react-native';\r\n//@ts-ignore\r\nimport useMobileDetect from 'use-mobile-detect-hook';\r\n\r\ntype WindowType = 'portrait' | 'landscape'\r\n\r\nconst getWindowType = (window:{width:number, height:number})=> window.height >= window.width?'portrait':'landscape' as WindowType;\r\n\r\nconst ResizeContextContext = createContext<WindowType>(getWindowType(Dimensions.get('window')));\r\n\r\nexport const ResizeContextProvider = ({children}:{children:React.ReactNode})=>{\r\n  const detectMobile = useMobileDetect();\r\n  const {width, height} = useWindowDimensions()\r\n  const [windowType, setWindowType] = useState(getWindowType({width, height}))\r\n  useEffect(()=>{\r\n    setWindowType(getWindowType({width, height}))\r\n  }, [width, height])\r\n  return <ResizeContextContext.Provider value={detectMobile.isMobile()?'portrait':windowType}>\r\n    {children}\r\n  </ResizeContextContext.Provider>\r\n}\r\n\r\nexport default function useResizeContext() {\r\n  const windowType = useContext(ResizeContextContext)\r\n  return windowType\r\n}","import React, { useState } from 'react';\r\nimport { Text, StyleSheet, Pressable, StyleProp, ViewStyle} from 'react-native';\r\nimport Colors from '../constants/Colors';\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport { CustomButtonProps } from '../types';\r\n\r\nconst DefaultButton = (props:CustomButtonProps)=>{\r\n    const [hover, setHover] = useState(false)\r\n    return <Pressable\r\n        onPress={()=>props.onPress()}\r\n        //@ts-ignore\r\n        onHoverIn={()=>setHover(true)}\r\n        onHoverOut={()=>setHover(false)}\r\n        disabled={props.disabled}\r\n        style={[\r\n            {\r\n                paddingVertical:5, \r\n                paddingHorizontal:16\r\n            },\r\n            props.style,\r\n            (hover || props.disabled)?{backgroundColor:props.color}:{}\r\n        ]}>\r\n            {props.children?props.children:\r\n            <Text selectable={false} style={[{fontSize:14}, props.textStyle]}>{props.title}</Text>}\r\n        </Pressable>\r\n}\r\n\r\nexport default (props:CustomButtonProps)=>{\r\n    const theme = useColorScheme()\r\n    const _props = {\r\n        color:Colors[theme].buttonColor,\r\n        ...props,\r\n        style:[\r\n            styles.style,\r\n            {\r\n                backgroundColor:Colors[theme].buttonBackgroundColor,\r\n                borderColor:Colors[theme].buttonBorderColor\r\n            },\r\n            props.style,\r\n        ] as StyleProp<ViewStyle>,\r\n        textStyle:[\r\n            styles.text, \r\n            {color:Colors[theme].text},\r\n            props.textStyle\r\n        ]\r\n    }\r\n    return <DefaultButton {..._props}/>\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n    style:{\r\n        borderRadius:6, \r\n        borderWidth:1, \r\n    },\r\n    text:{\r\n        textAlign:'center', \r\n        fontWeight:'600'\r\n    }\r\n});\r\n","import * as React from 'react';\r\nimport { Avatar } from 'react-native-paper';\r\nimport { AvatarProps } from '../../types';\r\n\r\nconst normalizeHash = (hash: number, min: number, max: number) => {\r\n    return Math.floor((hash % (max - min)) + min);\r\n};\r\n\r\nconst stringToHSL = (str: string, initHash?:number) => {\r\n    let hash = initHash || 0;\r\n    for (let i = 0; i < str.length; i++) {\r\n      hash = str.charCodeAt(i) + ((hash << 5) - hash);\r\n    }\r\n    hash = Math.abs(hash);\r\n    return `hsl(${normalizeHash(hash, 0, 360)}, ${normalizeHash(hash, 0, 100)}%, ${normalizeHash(hash, 25, 75)}%)`;\r\n};\r\n\r\nexport default (props:AvatarProps) => {\r\n    const backgroundColor = stringToHSL(props.name, props.userId)\r\n    return <Avatar.Text style={{backgroundColor}} size={props.size} label={props.name.split(' ').map(v=>v[0]).join().toUpperCase()} />\r\n};","import React from 'react';\r\nimport Avatar from '../lib/react-native-paper/Avatar';\r\nimport { AvatarProps, MessengerChannel, User } from '../types';\r\n\r\nexport function avatarFromChannel(item:MessengerChannel, user?:User|null){\r\n    let avatar;\r\n    let name = item.name\r\n    if (item.member_count<3){\r\n        avatar = (item.member_count==1 || user?.id == item.subowner.id)?item.owner:item.subowner\r\n        name = name.length>0?name:avatar.name \r\n    }\r\n    return {avatar, name}\r\n}\r\n\r\nexport default (props:AvatarProps)=>{\r\n    return <Avatar {...props}/>\r\n}\r\n\r\n","import * as React from 'react';\r\nimport { View, Text } from './Themed';\r\nimport { StyleSheet, StyleProp, ViewStyle, TextStyle } from 'react-native';\r\nimport Colors from '../constants/Colors';\r\n\r\nexport type SectionParamList = {\r\n    title?: string,\r\n    titleStyle?:StyleProp<TextStyle>\r\n    outerContainerStyle?:StyleProp<TextStyle>\r\n    containerStyle?:StyleProp<ViewStyle>\r\n    bodyStyle?:StyleProp<ViewStyle>\r\n    subtitle?: string\r\n    withSeparator?: boolean\r\n    children?: React.ReactNode\r\n}\r\n\r\nexport default function CommonSection(props:SectionParamList){\r\n  return (\r\n    <View style={[styles.outerContainer, props.outerContainerStyle]}>\r\n        <View style={[styles.container, props.containerStyle]}>\r\n            {props.withSeparator?<View style={styles.separator} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />:undefined}\r\n            {props.title?<View style={styles.titleView}>\r\n              <Text style={[styles.title, props.titleStyle]}>{props.title}</Text>\r\n              <Text style={styles.subtitle}>{props.subtitle}</Text>\r\n            </View>:undefined}\r\n            <View style={[styles.bodyView, props.bodyStyle]}>\r\n            {props.children}\r\n            </View>\r\n          </View>\r\n        </View>\r\n    )\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  outerContainer:{\r\n    width:'100%',\r\n    maxWidth:1080,\r\n    alignItems:'stretch',\r\n    backgroundColor:'transparent'\r\n  },  \r\n  container: {\r\n      marginHorizontal:20,\r\n      marginVertical: 10,\r\n      backgroundColor:'transparent',\r\n    },\r\n    titleView:{\r\n      width: '100%',\r\n      flexDirection:'row',\r\n      backgroundColor:'transparent',\r\n      marginBottom:5,\r\n    },\r\n    title: {\r\n      flex:1,\r\n      fontSize: 16,\r\n    },\r\n    subtitle: {\r\n      flex:1,\r\n      fontSize: 12,\r\n      textAlign: 'right',\r\n      marginTop:4\r\n    },\r\n    separator: {\r\n      marginBottom: 20,\r\n      height: 1,\r\n      width: '100%',\r\n    },\r\n    bodyView:{\r\n      width: '100%',\r\n      padding: 20,\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n      borderWidth:1,\r\n      borderColor:Colors.borderColor,\r\n      borderRadius:6\r\n    }\r\n  });\r\n  ","import React from 'react'\r\nimport CommonSection from \"./CommonSection\";\r\nimport useResizeContext from '../hooks/useResizeContext';\r\n\r\nexport default (props:{children?: React.ReactNode})=>{\r\n    const windowType = useResizeContext();\r\n    return <CommonSection\r\n        outerContainerStyle={{flex:1, alignSelf:'center', backgroundColor:'#8888', maxWidth:undefined, flexShrink:1}}\r\n        containerStyle={{flex:1, margin:0, justifyContent:'center', alignItems:'center'}}\r\n        bodyStyle={windowType=='landscape'?{width:'90%', height:'90%', padding:'5%'}:{width:'100%', height:'100%', maxWidth:1080}}\r\n    >\r\n        {props.children}\r\n    </CommonSection>\r\n}\r\n\r\nexport const BottomSheet = (props:{children?: React.ReactNode})=><CommonSection\r\n    outerContainerStyle={{flex:1, alignSelf:'center', backgroundColor:'#8888', maxWidth:undefined}}\r\n    containerStyle={{flex:1, margin:0, justifyContent:'flex-end'}}\r\n>\r\n    {props.children}\r\n</CommonSection>","import { useEffect } from \"react\";\r\nimport { useMutation, useQuery, useQueryClient } from \"react-query\";\r\nimport { getMessengerChannelList, postChannel, postDirectChannel, putChannel } from \"../../apis\";\r\nimport { MessengerChannel, MessengerContent } from \"../../types\";\r\nimport { Auth } from \"../useAuthContext\";\r\nimport useWebsocketContext from \"../useWebsocketContext\";\r\n\r\nexport default function useMessengerChannelList(auth?:Auth){\r\n  const queryClient = useQueryClient()\r\n  const {lastJsonMessage} = useWebsocketContext()\r\n  const { data } = useQuery(\"MessengerChannelList\" , async()=>auth?.user?.id?(await getMessengerChannelList(auth.user.id)):[])\r\n\r\n  useEffect(()=>{\r\n    if(lastJsonMessage !=null){\r\n      if(lastJsonMessage['type']=='enter'){\r\n        queryClient.setQueryData<MessengerChannel[]>(\"MessengerChannelList\", (_data)=>{\r\n          return (_data?.find(v=>v.id==lastJsonMessage['data']['id'])?_data:[lastJsonMessage['data'] , ...(_data|| [])]).sort((a, b)=>a.id - b.id)\r\n        })\r\n      }\r\n      if (lastJsonMessage['type']=='next_message'){\r\n        const data:MessengerContent = lastJsonMessage['data']\r\n        queryClient.setQueryData<MessengerChannel[]>(\"MessengerChannelList\", (_data)=>(_data || []).map(v=>{\r\n          if (v.id == data.channel){\r\n            return {...v, last_message:{content:data.message_set[0]?.content, created:data.created}}\r\n          }\r\n          return v\r\n        }))\r\n      }\r\n      // if(lastJsonMessage['type']=='leave'){\r\n      //   queryClient.setQueryData<Channel[]>(\"MessengerChannelList\", (_data)=>_data?.filter(v=>v.id!=lastJsonMessage['data']['channel_id']) || [])\r\n      // }\r\n    }\r\n  }, [lastJsonMessage])\r\n  return data\r\n}\r\n\r\nexport function useMessengerChannelSorted(auth?:Auth){\r\n  const channelList = useMessengerChannelList(auth);\r\n  return channelList?.sort((a, b)=>(a.last_message?.created || '') < (b.last_message?.created || '')?1:-1)\r\n}\r\nexport function useMessengerChannelMutation(){\r\n  const queryClient = useQueryClient()\r\n\r\n  const create = useMutation(postChannel, {\r\n    onSuccess: ()=>queryClient.invalidateQueries(\"MessengerChannelList\")\r\n  });\r\n\r\n  const update = useMutation(putChannel, {\r\n    onSuccess: () => queryClient.invalidateQueries(\"MessengerChannelList\")\r\n  })\r\n\r\n  const direct = useMutation(postDirectChannel, {\r\n    onSuccess: () => queryClient.invalidateQueries(\"MessengerChannelList\")\r\n  })\r\n\r\n  return { create:create.mutateAsync, update:update.mutateAsync, direct:direct.mutateAsync}\r\n}","import React, { Context, createContext,  useContext, useEffect, useState } from \"react\"\r\nimport useWebSocket from \"react-use-websocket\"\r\nimport { SendJsonMessage } from \"react-use-websocket/dist/lib/types\"\r\nimport {websockerURL } from \"../constants/Envs\"\r\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\r\nimport { AppState, AppStateStatus } from \"react-native\";\r\n\r\ntype WebsocketContextType = {lastJsonMessage:any, sendJsonMessage:SendJsonMessage }\r\nconst defaultContext = {lastJsonMessage:undefined, sendJsonMessage:()=>{}}\r\nconst WebSocketContext = createContext<WebsocketContextType>(defaultContext);\r\n\r\nexport const WebSocketInternalProvider = ({children, path, Context, useBackground}:{children:React.ReactNode, path:string, Context:Context<WebsocketContextType>, useBackground?:boolean})=>{\r\n  const [token, setToken] = useState<string|null>(null)\r\n  const [isActive, setIsActive] = useState<boolean>(useBackground || AppState.currentState == 'active')\r\n  const { lastJsonMessage, sendJsonMessage } = useWebSocket(`${websockerURL}/${path}`,{\r\n    shouldReconnect: (closeEvent) => true,\r\n    protocols: token?['Authorization',  token]:undefined,\r\n    onOpen: (e)=>{console.log(`success websocket connection(${path})`)},\r\n    onClose: (e)=> {console.log(`closed websocket connection(${path})`)},\r\n  }, isActive && token!=null)\r\n  useEffect(()=>{\r\n    AsyncStorage.getItem('Authorization').then(setToken)\r\n    const onChange = (nextState:AppStateStatus)=>setIsActive(useBackground || nextState == 'active')\r\n    AppState.addEventListener(\"change\", onChange)\r\n    return ()=>AppState.removeEventListener(\"change\", onChange)\r\n  }, [])\r\n  return <Context.Provider value={token!=null?{lastJsonMessage, sendJsonMessage}:defaultContext}>\r\n      {children}\r\n    </Context.Provider>\r\n}\r\n\r\nexport const WebSocketProvider = ({disable, children}:{disable?:boolean, children:React.ReactNode})=>{\r\n  return disable?<>{children}</>:<WebSocketInternalProvider path={'messenger/ws/'} Context={WebSocketContext}>\r\n    {children}\r\n  </WebSocketInternalProvider>\r\n}\r\n\r\nexport default ()=>{\r\n  const webSocketContext = useContext(WebSocketContext)\r\n  return webSocketContext\r\n}\r\n\r\n","import React, { useState } from 'react';\r\nimport { StyleSheet} from 'react-native';\r\nimport { CustomButtonProps } from '../types';\r\nimport CommonButton from './CommonButton';\r\n\r\nexport default (props:CustomButtonProps)=>{\r\n    return <CommonButton {...props} style={[styles.style, props.style]}/>\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n    style:{\r\n        borderRadius:6, \r\n        backgroundColor: 'transparent',\r\n        borderWidth:0\r\n    },\r\n});\r\n","/**\r\n * If you are not familiar with React Navigation, refer to the \"Fundamentals\" guide:\r\n * https://reactnavigation.org/docs/getting-started\r\n *\r\n */\r\nimport { NavigationContainer, DefaultTheme, DarkTheme, NavigationContainerRef } from '@react-navigation/native';\r\nimport * as React from 'react';\r\n\r\nimport LinkingConfiguration from './LinkingConfiguration';\r\nimport RootNavigator from './RootNavigator';\r\n\r\nimport { useColorScheme as useDefaultColorScheme } from 'react-native';\r\nimport { useColorScheme as useColorScheme } from 'react-native-appearance';\r\nimport { ResizeContextProvider } from '../hooks/useResizeContext';\r\n\r\n\r\nconst navigationRef = React.createRef<NavigationContainerRef>();\r\n\r\nexport function navigate(name:string, params?:any) {\r\n  if (params)\r\n    navigationRef.current?.navigate(name, params);\r\n  navigationRef.current?.navigate(name);\r\n}\r\n\r\nexport default function Navigation() {\r\n  const defaultColorScheme = useDefaultColorScheme()\r\n  const userColorScheme = useColorScheme()\r\n  const colorScheme = userColorScheme =='no-preference'?defaultColorScheme:userColorScheme\r\n  return <NavigationContainer\r\n    ref={navigationRef}\r\n    documentTitle={{formatter: (options, route) => {return `TOKKI TOK`}}}\r\n    linking={(process.versions && process.versions['electron'])?undefined:LinkingConfiguration}\r\n    theme={colorScheme === 'dark' ? DarkTheme : DefaultTheme}>\r\n        <ResizeContextProvider>\r\n          <RootNavigator />\r\n        </ResizeContextProvider>\r\n  </NavigationContainer>\r\n}\r\n\r\n(function(l) {  // for github-page\r\n    if (l !== undefined && l.search[1] === '/' ) {\r\n        var decoded = l.search.slice(1).split('&').map(function(s) { \r\n        return s.replace(/~and~/g, '&')\r\n        }).join('?');\r\n        window.history.replaceState(null, '',\r\n            l.pathname.slice(0, -1) + decoded + l.hash\r\n        );\r\n    }\r\n}(window.location))\r\n    \r\nconst ignoreWarnings = ['ReactNativeFiberHostComponent'];\r\nlet _console:any = ()=>{}\r\nimport('lodash').then(_=>{\r\n  _console = _.clone(console);\r\n})\r\nconsole.warn = (message: string|Object) => {\r\n    var warn = true;\r\n    if (message instanceof Object)\r\n    warn = false;\r\n    else{\r\n    ignoreWarnings.forEach((value)=>{\r\n        if (message.indexOf && message.indexOf(value) <= -1) {\r\n            warn = false;\r\n        }\r\n    })\r\n    };\r\n    if (warn){\r\n        _console.warn(message);\r\n    }\r\n    else{\r\n        // console.log(message)\r\n    }\r\n};\r\n","import { useMutation, useQuery, useQueryClient } from \"react-query\";\r\nimport { postBulkMessengerMember, deleteMessengerMember, getMessengerMemberList } from \"../../apis\";\r\n\r\nexport default function useMessengerMemberList(channel_id:number){\r\n  const { data } = useQuery([\"MessengerMemberList\", channel_id] , async()=>await getMessengerMemberList(channel_id))\r\n  return data\r\n}\r\n\r\n\r\nexport function useMessengerMemberMutation(){\r\n  const queryClient = useQueryClient()\r\n  const invite = useMutation(postBulkMessengerMember, {\r\n    onSuccess: ()=>{\r\n      queryClient.invalidateQueries(\"MessengerMemberList\")\r\n    }\r\n  })\r\n\r\n  const leave = useMutation(deleteMessengerMember, {\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries(\"MessengerChannelList\")\r\n      queryClient.invalidateQueries(\"MessengerMemberList\")\r\n    }\r\n  })\r\n  return {invite:invite.mutateAsync, leave:leave.mutateAsync}\r\n}","import React, {useState, useEffect } from 'react';\r\nimport { StyleSheet } from 'react-native';\r\nimport { View, Text } from '../components/Themed';\r\nimport CommonButton from '../components/CommonButton';\r\n// import useBoardChannelList, { useBoardChannelMutation } from '../hooks/lists/useBoardChannelList';\r\nimport useAuthContext from '../hooks/useAuthContext';\r\nimport { navigate } from '../navigation';\r\nimport { Channel } from '../types';\r\nimport useMessengerChannelList, { useMessengerChannelMutation } from '../hooks/lists/useMessengerChannelList';\r\nimport TextField from '../components/TextField';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport ModalSection from '../components/ModalSection';\r\nimport { useMessengerMemberMutation } from '../hooks/lists/useMessengerMemberList';\r\nimport { avatarFromChannel } from '../components/Avatar';\r\n\r\nexport default function ChannelEditModal({id, member_id, type}: {id?:number, member_id?:number, type:string}) {\r\n  const { lang } = useLangContext()\r\n  const {auth} = useAuthContext()\r\n  const { setModal } = useModalsContext()\r\n  const channelList = useMessengerChannelList(auth)\r\n  const channelMutation = useMessengerChannelMutation()\r\n  const messengerMemberMutation = useMessengerMemberMutation()\r\n  const channel = channelList?.find(v=>v.id==id)\r\n  const [name, setName] = useState('')\r\n  const [description, setDescription] = useState('')\r\n  const back = ()=>{\r\n    setModal(ChannelEditModal, null)\r\n  }\r\n\r\n  useEffect(()=>{\r\n    if (channel){\r\n      const {name:_name} = avatarFromChannel(channel, auth.user)\r\n      setName(_name)\r\n      setDescription(channel?.description || '')\r\n    }\r\n  }, [channel])\r\n  return <ModalSection>\r\n    <View style={{justifyContent:'space-between', flex:1, width:'100%'}}>\r\n      <View style={{width:'100%'}}>\r\n        <Text style={{fontSize:20}}>{id?lang('Chat Setting'):lang('New chat')}</Text>\r\n        <View style={styles.separator} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\r\n        <TextField name={lang('Channel Name')} value={name} setValue={setName} width={'60%'}/>\r\n        <TextField name={lang('Description')} value={description} setValue={setDescription} multiline width={'60%'}/>\r\n      </View>\r\n      <View style={{width:'100%', flexDirection:'row'}}>\r\n        {member_id &&<View style={{flexDirection:'row', justifyContent:'flex-start'}}>\r\n          <CommonButton title={lang('leave')} style={{marginHorizontal:5}} onPress={()=>messengerMemberMutation.leave(member_id).then(back)}/>\r\n        </View>}\r\n        <View style={{flex:1, flexDirection:'row', justifyContent:'flex-end'}}>\r\n          <CommonButton title={lang('save')} onPress={()=>{\r\n            if(auth?.user?.id && auth.groupId){\r\n              const newChannel:Channel = {id, name, description, type, owner:auth?.user?.id, group:auth.groupId};\r\n              (id?channelMutation.update(newChannel):channelMutation.create(newChannel)).then(v=>navigate(\"Main\", {\r\n                screen:v.type == 'messenger'?'ChatScreen':'BoardScreen',\r\n                params:{id:v.id}\r\n              }))\r\n            }\r\n          }}/>\r\n          <CommonButton title={lang('cancel')} style={{marginHorizontal:5}} onPress={back}/>\r\n        </View>\r\n      </View>\r\n    </View>\r\n  </ModalSection>\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  field:{\r\n    width:'50%',\r\n    flexDirection:'row',\r\n    padding:10,\r\n  },\r\n  separator: {\r\n    marginBottom: 20,\r\n    height: 1,\r\n    width: '100%',\r\n  },\r\n})","import React from 'react'\r\nimport TextButton from \"./TextButton\"\r\nimport useAuthContext from \"../hooks/useAuthContext\"\r\nimport useResizeContext from '../hooks/useResizeContext'\r\nimport { View } from 'react-native'\r\nimport useModalsContext from '../hooks/useModalsContext'\r\nimport GuestLogoutModal from '../modals/GuestLogoutModal'\r\nimport useLangContext from '../hooks/useLangContext'\r\n\r\ntype ButtonProps = {title:string, onPress:()=>void, windowType?:'landscape'|'portrait'}\r\n\r\nexport default (props:{extra?:ButtonProps[]})=>{\r\n    const { lang } = useLangContext()\r\n    const {auth, dispatch} = useAuthContext()\r\n    const { setModal } = useModalsContext()\r\n    const windowType = useResizeContext()\r\n    const defaultButtonProps:ButtonProps[] = [{title:lang('sign out'), onPress:()=>{\r\n        if (auth?.user?.username.endsWith(\".guest\")){\r\n            setModal(GuestLogoutModal, {})\r\n        }\r\n        else{\r\n            dispatch({type:\"LOGOUT_REQUEST\"})\r\n        }\r\n    }}]\r\n    const buttonProps = (props.extra?[...props.extra, ...defaultButtonProps]:defaultButtonProps).filter(v=>v.windowType==windowType || v.windowType == undefined)\r\n    return<View style={{flexDirection:'row'}}>\r\n        {buttonProps.map((v,k)=><TextButton key={k} {...v} textStyle={{color:'white'}} color='#gray'/>)}\r\n    </View>\r\n}\r\n  ","import { useQuery } from \"react-query\";\r\nimport { getUserMembershipList } from \"../../apis\";\r\nimport { Auth } from \"../useAuthContext\";\r\n\r\nexport default function useUserMembershipList(auth?:Auth){\r\n  const { data } = useQuery([\"UserMembershipList\", auth?.groupId] , async()=>auth?.groupId?(await getUserMembershipList(auth?.groupId)):[])\r\n  return data\r\n}","import React from 'react';\r\nimport { TabView, SceneMap,NavigationState, SceneRendererProps, TabBar } from 'react-native-tab-view';\r\nimport Colors from '../constants/Colors';\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport { TabViewRecord } from '../types';\r\n\r\n\r\nexport default (props:{tabs:TabViewRecord, tabBarPosition:\"top\"|\"bottom\", index?:number, onTab?:(index:number)=>void})=>{\r\n  const { lang } = useLangContext()\r\n  const [index, setIndex] = React.useState(props.index || 0);\r\n  const theme = useColorScheme()\r\n  const entries = Object.entries(props.tabs)\r\n  const onTab = props.onTab\r\n  const icons = Object.assign({}, ...entries.map(([k, v])=>({[k]:v.icon})))\r\n  return <TabView\r\n    renderTabBar={(props:SceneRendererProps & {navigationState: NavigationState<any>})=>{\r\n      return <TabBar\r\n        {...props}\r\n        indicatorStyle={{ backgroundColor: \"#2196F3\" }}\r\n        style={{ backgroundColor:Colors[theme].background }}\r\n        activeColor={Colors[theme].text}\r\n        inactiveColor={Colors[theme].text}\r\n        renderIcon={(scene)=>icons[scene.route.key]}\r\n        onTabPress={(scene)=>onTab?.(entries.findIndex(([k, v])=>k == scene.route.key))}\r\n      />\r\n    }}\r\n    navigationState={{ index, routes: entries.map(([k, v])=>({key:k, title:lang(v.title)}))}}\r\n    onIndexChange={setIndex}\r\n    renderScene={SceneMap(Object.assign({}, ...entries.map(([k, v])=>({[k]:v.component}))))}\r\n    tabBarPosition={props.tabBarPosition}\r\n  />\r\n}\r\n\r\n","import * as React from 'react';\r\nimport { View } from './Themed';\r\nimport { StyleSheet, StyleProp, ViewStyle, TextStyle, Pressable } from 'react-native';\r\nimport Colors from '../constants/Colors';\r\n\r\nexport type ItemParamList = {\r\n    outerContainerStyle?:StyleProp<TextStyle>\r\n    containerStyle?:StyleProp<ViewStyle>\r\n    bodyStyle?:StyleProp<ViewStyle>\r\n    children?: React.ReactNode\r\n    onPress?: ()=>void\r\n}\r\n\r\nexport default function CommonItem(props:ItemParamList){\r\n  const [hover, setHover] = React.useState(false)\r\n  const [press, setPress] = React.useState(false)\r\n  return (\r\n    <Pressable\r\n      style={[styles.outerContainer ,props.outerContainerStyle, (press)?{backgroundColor:'rgb(242,242,242)'}:{}]}\r\n      onPressIn={()=>{setPress(true)}}\r\n      onPressOut={()=>{setPress(false);props.onPress?.()}}\r\n       //@ts-ignore\r\n       onHoverIn={()=>setHover(true)}\r\n       onHoverOut={()=>setHover(false)}\r\n    >\r\n        <View style={[styles.container ,props.containerStyle]}>\r\n            <View style={[styles.bodyView, props.bodyStyle]}>\r\n                <>{props.children}</>\r\n            </View>\r\n      </View>\r\n    </Pressable>\r\n    )\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  outerContainer:{\r\n    width:'100%',\r\n    maxWidth:1080,\r\n    alignItems:'stretch',\r\n  },  \r\n  container: {\r\n      marginHorizontal:20,\r\n      backgroundColor:'transparent'\r\n    },\r\n    bodyView:{\r\n      width: '100%',\r\n      padding: 10,\r\n      minHeight: 40,\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n      borderBottomWidth:1,\r\n      borderColor:Colors.borderColor,\r\n      backgroundColor:'transparent'\r\n    }\r\n  });\r\n  ","import { useEffect } from \"react\"\r\nimport { InfiniteData, useInfiniteQuery, useMutation, useQueryClient } from \"react-query\"\r\nimport { getMessengerContentList, postMessage, deleteMessengerContent, patchMessengerContent } from \"../../apis\"\r\nimport { MessengerContent } from \"../../types\"\r\nimport useWebsocketContext from \"../useWebsocketContext\"\r\n\r\nexport type MessengerContentPage = {\r\n  next?:MessengerContentPage\r\n  current:MessengerContent[]\r\n}\r\n\r\nexport default function useMessengerContentList(channel_id:number){  \r\n  const queryClient = useQueryClient()\r\n  const { data, fetchNextPage } = useInfiniteQuery<MessengerContentPage>(\r\n    [\"MessengerContentList\", channel_id], \r\n    async({pageParam})=>getMessengerContentList(channel_id, pageParam).then(current=>({current})), \r\n    {\r\n      select:data=>{\r\n        if(data.pages.length > 1)\r\n          data.pages[data.pages.length - 2].next = data.pages[data.pages.length - 1]\r\n        return data;\r\n      },\r\n      getNextPageParam:(lastPage)=>lastPage?.current.length?lastPage.current[lastPage.current.length - 1].id:undefined,\r\n      refetchOnReconnect:false,\r\n      refetchOnWindowFocus:true\r\n    }\r\n  )\r\n  const { lastJsonMessage } = useWebsocketContext()\r\n  useEffect(()=>{\r\n    if(lastJsonMessage !=null && lastJsonMessage['data']['channel'] == channel_id){\r\n      if(lastJsonMessage['type']=='next_message'){\r\n        queryClient.setQueryData<InfiniteData<MessengerContentPage>>([\"MessengerContentList\", channel_id], (_data)=>{\r\n          if(_data?.pages[0].current && _data?.pages[0].current[0].id != lastJsonMessage['data'].id)\r\n            _data.pages[0].current = [lastJsonMessage['data'], ..._data?.pages[0].current]\r\n          return {...(_data || {pages:[], pageParams:[]})}\r\n        })\r\n      }\r\n      if(lastJsonMessage['type']=='update_message'){\r\n        queryClient.setQueryData<InfiniteData<MessengerContentPage>>([\"MessengerContentList\", channel_id], (_data)=>{\r\n          _data?.pages.forEach(page=>{\r\n            page.current.forEach(v=>{\r\n              if (v.id==lastJsonMessage['data'].id){\r\n                v.timer = lastJsonMessage['data'].timer\r\n              }\r\n            })\r\n          })\r\n          return {...(_data || {pages:[], pageParams:[]})}\r\n        })\r\n      }\r\n      if(lastJsonMessage['type']=='delete_message'){\r\n        queryClient.setQueryData<InfiniteData<MessengerContentPage>>([\"MessengerContentList\", channel_id], (_data)=>{\r\n          _data?.pages.forEach(page=>{\r\n            const len = page.current.length\r\n            const newCurrent = page.current.filter(v=>v.id!=lastJsonMessage['data'].id)\r\n            if (len != newCurrent.length){\r\n              page.current = newCurrent\r\n            }\r\n          })\r\n          return {...(_data || {pages:[], pageParams:[]})}\r\n        })\r\n      }\r\n    }\r\n  }, [lastJsonMessage])\r\n  return { data, fetchNextPage }\r\n}\r\n\r\nexport function useMessengerContentMutation(channelId?:number){\r\n  // const queryClient = useQueryClient()\r\n  const create = useMutation(postMessage, {\r\n    onSuccess: () => {\r\n      // queryClient.setQueryData(['MessengerContentList'], (data:any) => ({\r\n      //   pages: data.pages.slice(0, 1),\r\n      //   pageParams: data.pageParams.slice(0, 1),\r\n      // }))\r\n      // queryClient.invalidateQueries(\"MessengerContentList\")\r\n    }\r\n  });\r\n  const _patch = useMutation(patchMessengerContent);\r\n  const _delete = useMutation(deleteMessengerContent, {\r\n    onSuccess: (d, variables) => {\r\n      // queryClient.setQueryData(['MessengerContentList'], (data:any) => ({\r\n      //   pages: (data.pages as MessengerContent[][]).map(v=>v.filter(v2=>v2.id != variables)),\r\n      //   pageParams: data.pageParams,\r\n      // }))\r\n    }\r\n  })\r\n  return { create:create.mutate, patch:_patch.mutate, delete:_delete.mutate }\r\n}","import React from 'react';\r\nimport useAuthContext from '../hooks/useAuthContext';\r\nimport CommonButton from '../components/CommonButton';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport { Text, View } from '../components/Themed';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport { BottomSheet } from '../components/ModalSection';\r\n\r\nexport default function GuestLogoutModal({id}:{id:number}) {\r\n  const { lang } = useLangContext()\r\n  const { setModal } = useModalsContext()\r\n  const {dispatch} = useAuthContext()\r\n  const back = ()=>{\r\n    setModal(GuestLogoutModal, null)\r\n  }\r\n  return <BottomSheet>\r\n    <Text>{lang('Guest users cannot reconnect after logging out. Please create an account or log in.')}</Text>\r\n    <View style={{width:'100%', flexDirection:'row', justifyContent:'flex-end'}}>\r\n      <CommonButton title={lang('sign out')} onPress={()=>dispatch({type:\"LOGOUT_REQUEST\"})}/>\r\n      <CommonButton title={lang('cancel')} onPress={()=>back()}/>\r\n    </View>\r\n  </BottomSheet>\r\n}\r\n","import React, { useState } from 'react';\r\nimport { TextInput } from 'react-native';\r\nimport Colors from '../constants/Colors';\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport { CustomTextInputProps } from '../types';\r\n\r\nexport default (props:CustomTextInputProps)=>{\r\n    const [contentHeight, setContentHeight] = useState<number>()\r\n    const minHeight = props.minHeight || 30\r\n    const theme = useColorScheme()\r\n    return <TextInput style={[{\r\n            borderColor:'#d0d7de', \r\n            fontSize:16, \r\n            borderWidth:1, \r\n            borderRadius:6, \r\n            paddingHorizontal:10, \r\n            paddingVertical:3, \r\n            backgroundColor:Colors[theme].background,\r\n            color:Colors[theme].text,\r\n            height:props.multiline?contentHeight:minHeight,\r\n        }, props.style]} \r\n        editable={!props.disabled} \r\n        value={props.value} \r\n        onChangeText={props.setValue}\r\n        onContentSizeChange={props.multiline?(e) => setContentHeight(Math.max(e.nativeEvent.contentSize.height, minHeight) + 2):undefined}\r\n        onBlur={()=>props.onBlur?.(props.value)}\r\n        onEndEditing={()=>props.onEndEditing?.(props.value)}\r\n        multiline={props.multiline}\r\n    />\r\n}","import React from \"react\"\r\nimport CommonItem from \"./CommonItem\"\r\nimport { UserMembership } from \"../types\"\r\nimport Avatar from \"./Avatar\"\r\nimport { Text, View } from \"./Themed\"\r\n\r\nexport default ({member:item, onPress}:{member:UserMembership, onPress?:()=>void})=> {\r\n    return <CommonItem key={item.id} bodyStyle={{flexDirection:'row', justifyContent:'flex-start'}} onPress={onPress}>\r\n        <View style={{marginTop:4, marginRight:12}}><Avatar name={item.name} userId={item.id} size={44}/></View>\r\n        <Text style={{fontSize:20, fontWeight:'400'}}>{item.name}</Text>\r\n    </CommonItem>\r\n}","import React, { Suspense, useState } from 'react';\r\nimport CommonButton from '../components/CommonButton';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport { Text, View } from '../components/Themed';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport { Ionicons } from '../lib/@expo/vector-icons';\r\nimport { TouchableOpacity } from 'react-native-gesture-handler';\r\nimport Colors from '../constants/Colors';\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport { BottomSheet } from '../components/ModalSection';\r\nimport dayjs from 'dayjs';\r\n\r\nconst dayTypes = ['AM', 'PM'].map(value=>({label:value, value}))\r\nconst hours = [...Array(12).keys()].map((value, index)=>(index + 1).toString().padStart(2, '0')).map(value=>({label:value, value}))\r\nconst minutes = [...Array(12).keys()].map((value, index)=>(index * 5).toString().padStart(2, '0')).map(value=>({label:value, value}))\r\n\r\n\r\nconst getDisableDays=(date:dayjs.Dayjs)=>{\r\n  let startDate = date.clone().startOf('month').add(-1, 'month')\r\n  const endDate = date.clone().endOf('month').add(1, 'month')\r\n  const today = dayjs().startOf('day')\r\n  const result = []\r\n  while(startDate<=endDate && startDate<today){\r\n    result.push(startDate.format('YYYY-MM-DD'))\r\n    startDate = startDate.add(1, 'day')\r\n  }\r\n  return result\r\n}\r\n\r\nconst defaultDayjs = ()=>{\r\n  const m = dayjs()\r\n  const restMinute = parseInt(m.format('mm')) % 5\r\n  return m.add(5-restMinute, 'minute')\r\n}\r\n\r\nconst Calendar = React.lazy(()=> import('../components/Calendar'))\r\nconst CommonPicker = React.lazy(()=>import('../components/CommonPicker'))\r\n\r\nexport default function DateTimePickerModal({datetime, callback}:{datetime?:string, callback:(datetime?:string)=>void}) {\r\n  const _dayjs = datetime?dayjs(datetime):defaultDayjs()\r\n  const { lang, locale } = useLangContext()\r\n  const theme = useColorScheme()\r\n  const [date, setDate] = useState(_dayjs.format('YYYY-MM-DD'));\r\n  const [dayType, setDayType] = useState(_dayjs.locale('en').format('A'))\r\n  const [hour, setHour] = useState(_dayjs.format('hh'))\r\n  const [minute, setMinute] = useState(_dayjs.format('mm'))\r\n  const [disableDays, setDisableDays] = useState<string[]>(getDisableDays(_dayjs))\r\n  const { setModal } = useModalsContext()\r\n  const back = ()=>{\r\n    setModal(DateTimePickerModal, null)\r\n  }\r\n  return <BottomSheet>\r\n    <View style={{flexDirection:'row', width:'100%'}}>\r\n      <View style={{flex:1, flexDirection:'row'}}>\r\n        <TouchableOpacity onPress={back}>\r\n          <Ionicons size={20} name=\"arrow-back\" color={Colors[theme].text}/>\r\n        </TouchableOpacity>\r\n      </View>\r\n      <View style={{flex:1}}>\r\n        <Text style={{fontSize:20, textAlign:'center'}}>{lang('Date & Time')}</Text>\r\n      </View>\r\n      <View style={{flex:1}}/>\r\n    </View>\r\n    <View style={{marginBottom: 20, height: 1, width: '100%'}} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\r\n    <Suspense fallback={<></>}>\r\n      <Calendar\r\n        locale={locale}\r\n        style={undefined} \r\n        setDate={setDate}\r\n        disableAllTouchEventsForDisabledDays={true}\r\n        onMonthChange={(v)=>setDisableDays(getDisableDays(dayjs(v.dateString)))}\r\n        markedDates={{\r\n          ...disableDays.reduce((p, c)=>{p[c]={disabled:true};return p}, {} as Record<string, any>),\r\n          ...(date?[date]:[]).reduce((p, c)=>{p[c]={selected:true};return p}, {} as Record<string, any>)\r\n        }}\r\n      />\r\n      <View style={{flexDirection:'row', paddingVertical:10, width:400, height:50}}>\r\n        <CommonPicker value={dayType} setValue={setDayType} values={dayTypes}/>\r\n        <Text style={{fontSize:20}}> </Text>\r\n        <CommonPicker value={hour} setValue={setHour} values={hours}/>\r\n        <Text style={{fontSize:20}}> : </Text>\r\n        <CommonPicker value={minute} setValue={setMinute} values={minutes}/>\r\n      </View>\r\n    </Suspense>\r\n    <View style={{flexDirection:'row'}}>\r\n      <CommonButton title={lang('save')} onPress={()=>{\r\n        callback?.(dayjs(`${date} ${hour}:${minute} ${dayType}`).toISOString())\r\n        back()\r\n      }}/>\r\n      <CommonButton title={lang('cancel')} onPress={()=>{\r\n        callback?.(undefined)\r\n        back()\r\n      }}/>\r\n      \r\n    </View>\r\n  </BottomSheet>\r\n}\r\n","import React from 'react';\r\nimport Clipboard from '@react-native-clipboard/clipboard/dist';\r\nimport CommonButton from '../components/CommonButton';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport { Text, View } from '../components/Themed';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport { BottomSheet } from '../components/ModalSection';\r\nimport { TouchableOpacity } from 'react-native-gesture-handler';\r\nimport Colors from '../constants/Colors';\r\nimport { Ionicons } from '../lib/@expo/vector-icons';\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport { useMessengerContentMutation } from '../hooks/lists/useMessengerContentList';\r\n\r\nexport default function MessageModal({id,  content, isOwner, isTimer}:{id:number, content:string, isOwner:boolean, isTimer:boolean}) {\r\n  const { lang } = useLangContext()\r\n  const { setModal } = useModalsContext()\r\n  const theme = useColorScheme()\r\n  const contentMutation = useMessengerContentMutation()\r\n  const back = ()=>{\r\n    setModal(MessageModal, null)\r\n  }\r\n  return <BottomSheet>\r\n    <View style={{flexDirection:'row', width:'100%'}}>\r\n      <View style={{flex:1, flexDirection:'row'}}>\r\n        <TouchableOpacity onPress={back}>\r\n          <Ionicons size={20} name=\"arrow-back\" color={Colors[theme].text}/>\r\n        </TouchableOpacity>\r\n      </View>\r\n      <View style={{flex:1}}>\r\n        <Text style={{fontSize:20, textAlign:'center'}}>{lang('Message')}</Text>\r\n      </View>\r\n      <View style={{flex:1}}/>\r\n    </View>\r\n    <View style={{marginBottom: 20, height: 1, width: '100%'}} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\r\n      <CommonButton style={{height:40, width:'100%', maxWidth:320, justifyContent:'center'}} title={lang('copy')} onPress={()=>{Clipboard.setString(content);back()}}/>\r\n      {isOwner && isTimer && <CommonButton style={{height:40, width:'100%', maxWidth:320, justifyContent:'center'}} textStyle={{color:'red'}} title={lang('delete timer')} onPress={()=>{contentMutation.patch({id, timer:null});back()}}/>}\r\n      {isOwner && <CommonButton style={{height:40, width:'100%', maxWidth:320, justifyContent:'center'}} textStyle={{color:'red'}} title={lang('delete')} onPress={()=>{contentMutation.delete(id);back()}}/>}\r\n  </BottomSheet>\r\n}\r\n","import React, { useEffect } from 'react';\r\nimport Profile from '../components/Profile';\r\nimport useAuthContext from '../hooks/useAuthContext';\r\nimport useUserMembershipList from '../hooks/lists/useUserMembershipList';\r\nimport { useMessengerChannelMutation } from '../hooks/lists/useMessengerChannelList';\r\nimport CommonButton from '../components/CommonButton';\r\nimport { Channel } from '../types';\r\nimport { navigate } from '../navigation';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport { Text, View } from '../components/Themed';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport { Ionicons } from '../lib/@expo/vector-icons';\r\nimport { TouchableOpacity } from 'react-native-gesture-handler';\r\nimport Colors from '../constants/Colors';\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport { BottomSheet } from '../components/ModalSection';\r\n\r\nexport default function ProfileModal({id}:{id:number}) {\r\n  const { lang } = useLangContext()\r\n  const theme = useColorScheme()\r\n  const {auth} = useAuthContext()\r\n  const { setModal } = useModalsContext()\r\n  const userList = useUserMembershipList(auth)\r\n  const user = userList?.find(v=>v.id==id)\r\n  const isSelf = auth.user && user && (auth.user?.id==user?.id)\r\n  const channelMutation = useMessengerChannelMutation()\r\n  const back = ()=>{\r\n    setModal(ProfileModal, null)\r\n  }\r\n  useEffect(()=>{\r\n    if (!(id && user) && userList)\r\n      back()\r\n  }, [userList])\r\n  return user?<BottomSheet>\r\n    <View style={{flexDirection:'row', width:'100%'}}>\r\n      <View style={{flex:1, flexDirection:'row'}}>\r\n        <TouchableOpacity onPress={back}>\r\n          <Ionicons size={20} name=\"arrow-back\" color={Colors[theme].text}/>\r\n        </TouchableOpacity>\r\n      </View>\r\n      <View style={{flex:1}}>\r\n        <Text style={{fontSize:20, textAlign:'center'}}>{lang('profile')}</Text>\r\n      </View>\r\n      <View style={{flex:1}}/>\r\n    </View>\r\n    <View style={{marginBottom: 20, height: 1, width: '100%'}} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\r\n    \r\n    <Profile username={user.username} name={user.name} userId={user.id} />\r\n    <CommonButton title={lang(isSelf?'Chat with me':'1:1 Chat')} onPress={()=>{\r\n      if(auth?.user?.id && auth.groupId){\r\n        const newChannel:Channel = {name:\"\", type:'messenger', owner:auth?.user?.id, group:auth.groupId, subowner:isSelf?undefined:user.id};\r\n        channelMutation.direct(newChannel).then(v=>navigate(\"Main\", {screen:\"ChatScreen\", params: {id:v.id}}))\r\n      }\r\n    }}/>\r\n  </BottomSheet>:<></>\r\n}\r\n","import React from 'react';\r\nimport {View} from 'react-native'\r\nimport {Text} from './Themed';\r\nimport { ProfileProps } from '../types';\r\nimport Avatar from './Avatar';\r\nimport TextButton from './TextButton';\r\nimport CommonTextInput from './CommonTextInput';\r\nimport { patchUser } from '../apis';\r\nimport useAuthContext from '../hooks/useAuthContext';\r\n\r\nexport default (props:ProfileProps)=>{\r\n    const [name, setName] = React.useState<string>()\r\n    const { auth, dispatch } = useAuthContext()\r\n    const isSelf = auth.user?.id == props.userId\r\n    const onChange = ()=>{\r\n        isSelf && patchUser({id:props.userId, name:name || ''}).finally(()=>{\r\n            setName(undefined)\r\n            dispatch({type:\"REFRESH\"})\r\n        })\r\n    }\r\n    return <View style={{width:'100%', height:135, justifyContent:'space-evenly', alignItems:'center'}}>\r\n        <Avatar {...props} size={75}/>\r\n        {name===undefined?\r\n            <TextButton textStyle={{fontWeight:'bold', fontSize:15}} onPress={()=>isSelf && setName(props.name)} title={props.name} disabled={!isSelf}/>:\r\n            <CommonTextInput value={name} style={{textAlign:'center'}} setValue={setName} onBlur={onChange} onEndEditing={onChange} />}\r\n        <Text style={{fontWeight:'normal', fontSize:14}}>{props.username}</Text>\r\n    </View>\r\n}","import { useState,  useEffect } from \"react\"\r\nimport firebase from \"firebase/app\";\r\nimport \"firebase/messaging\";\r\nimport {FCM_PUBLIC_VAPID_KEY, FCM_API_KEY} from \"../constants/Envs\"\r\nimport { Notification as NotificationType, UserMembership } from \"../types\";\r\nimport { getNotification, postNotification, putNotification } from \"../apis/notification\";\r\nimport { Auth } from \"./useAuthContext\";\r\nconst firebaseConfig = require(\"../../web/firebase-config.js\")\r\n// Initialize Firebase\r\nconst key = firebaseConfig.messagingSenderId\r\nconst apiKeyEncrypted = (FCM_API_KEY as string).split('').map((v, i)=> (v.charCodeAt(0) ^ key.charCodeAt(i)).toString(16).padStart(2, '0')).join('')\r\nconst app = firebase.initializeApp({...firebaseConfig, apiKey:FCM_API_KEY});\r\n// const analytics = getAnalytics(app);\r\nconst messaging = firebase.messaging(app);\r\n\r\nmessaging.onMessage((payload) => {\r\n  if (!(\"Notification\" in window)) {\r\n    alert(\"This browser does not support desktop notification\");\r\n  }\r\n  else if (Notification.permission === \"granted\") {\r\n    const message_set = JSON.parse(payload.data['message_set'])[0]\r\n    new Notification(payload.data.channel_name, { body: `${payload.data.name}: ${message_set.content}` });\r\n  }\r\n});\r\n\r\nconst requestToken = async()=>{\r\n  const permission = await Notification.requestPermission();\r\n  if (permission === 'granted') {\r\n    const serviceWorkerRegistration = await navigator.serviceWorker.register(`${process.env.PUBLIC_URL}/firebase-messaging-sw.js?${apiKeyEncrypted}`)\r\n    console.log('[SW]: SCOPE: ', serviceWorkerRegistration.scope);\r\n    const currentToken = await messaging.getToken({serviceWorkerRegistration, vapidKey: FCM_PUBLIC_VAPID_KEY }).catch(\r\n      async()=>await messaging.getToken({serviceWorkerRegistration, vapidKey: FCM_PUBLIC_VAPID_KEY })\r\n    )\r\n    window.addEventListener('beforeunload', (event:any) => {\r\n      event.preventDefault();\r\n      serviceWorkerRegistration.unregister()\r\n    });\r\n    if (currentToken)\r\n      return currentToken\r\n  }\r\n  return undefined\r\n}\r\n\r\n\r\nlet noti:NotificationType|undefined\r\nlet notiListener:((enable:boolean)=>void)[] = []\r\n\r\nconst initEnable = async(user:UserMembership, callback:(enable:boolean)=>void)=>{\r\n  notiListener.push(callback)\r\n  if (notiListener.length == 1){  \r\n    noti = await getNotification(user.id)\r\n    if (noti === undefined){\r\n      noti = await postNotification({user:user.id, type:'WEB', token:null})\r\n    }\r\n    else if(noti.token){\r\n      requestToken().then(async token=>{\r\n        if(noti)\r\n          noti = await putNotification({...noti, token:(token||null)})\r\n        notiListener.map(c=>c(noti?.token?true:false))\r\n      })\r\n    }\r\n    notiListener.map(c=>c(noti?.token?true:false))\r\n  }\r\n}\r\n\r\nconst changeEnable = async(enable:boolean)=>{\r\n  if (noti){\r\n    if(enable){\r\n      const token = await requestToken() || null\r\n      noti = await putNotification({...noti, token})\r\n    }\r\n    else{\r\n      noti = await putNotification({...noti, token:null})\r\n    }\r\n  }\r\n  return noti?.token?true:false\r\n}\r\n\r\nexport default (auth:Auth)=>{\r\n  const [enable, setEnable] = useState<boolean|null>(null)\r\n  useEffect(()=>{\r\n    if (auth.user){\r\n      if(noti === undefined)\r\n        initEnable(auth.user, setEnable)\r\n      else{\r\n        setEnable(noti.token?true:false)\r\n        noti = undefined\r\n        notiListener = []\r\n      }\r\n    }else{\r\n      setEnable(false)\r\n    }\r\n  }, [auth.user])\r\n  return {\r\n    enable,\r\n    setEnable:(_enable:boolean)=>changeEnable(_enable).then(setEnable)\r\n  }\r\n}\r\n","import React from 'react'\r\nimport { View, StyleSheet, Linking, Platform } from 'react-native'\r\nimport { TouchableOpacity } from 'react-native-gesture-handler'\r\nimport { AntDesign } from '../lib/@expo/vector-icons'; \r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport Colors from '../constants/Colors';\r\n\r\nconst openURL = Platform.OS=='web'?(url:string)=>{location.href=url}:Linking.openURL\r\n\r\nexport default (props:{theme:'light'|'dark'})=>{\r\n    return<View style={Styles.footer_buttons}>\r\n        <TouchableOpacity style={Styles.footer_button} onPress={()=>openURL(\"https://github.com/blacktokki/tokki-tok\")}>\r\n            <AntDesign name=\"github\" size={24} color={Colors[props.theme].iconColor} />\r\n        </TouchableOpacity>\r\n        <TouchableOpacity style={Styles.footer_button} onPress={()=>Linking.openURL(\"mailto:ydh051541@naver.com\")}>\r\n            <AntDesign name=\"mail\" size={24} color={Colors[props.theme].iconColor} />\r\n        </TouchableOpacity>\r\n    </View>\r\n}\r\n\r\nconst Styles = StyleSheet.create({\r\n      footer_buttons: {\r\n        width: '100%',\r\n        flexDirection: 'row',\r\n        justifyContent: 'flex-end',\r\n        paddingBottom: 20,\r\n        paddingRight: 20,\r\n      },\r\n      footer_button: {\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        width: 38,\r\n        height: 38,\r\n        marginHorizontal: 12,\r\n        borderWidth: 1,\r\n        borderColor: '#E7E7E7',\r\n        borderRadius: 60,\r\n      },\r\n})","import React, {useLayoutEffect, useState} from 'react';\r\nimport {\r\n  Text,\r\n  TextInput,\r\n  TouchableOpacity,\r\n  View,\r\n  StyleSheet,\r\n} from 'react-native';\r\nimport { StackScreenProps } from '@react-navigation/stack';\r\nimport useAuthContext from '../../hooks/useAuthContext';\r\nimport useLangContext from '../../hooks/useLangContext';\r\nimport ContractFooter from '../../components/ContractFooter';\r\n\r\nexport default function LoginScreen({\r\n  navigation, route\r\n}: StackScreenProps<any, 'Login'>) {\r\n  const { lang } = useLangContext()\r\n  const [username, setUsername] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  const {error, dispatch} = useAuthContext()\r\n  const _login = ()=>dispatch({type:'LOGIN_REQUEST', username, password})\r\n  useLayoutEffect(() => {\r\n    navigation.setOptions({\r\n      headerRight: undefined\r\n    });\r\n  }, [navigation, route]);\r\n\r\n  return (<View style={Styles.login_container}>\r\n    <View style={Styles.login_wrapper}>\r\n      <View style={Styles.form}>\r\n        {error && <View style={Styles.form_error}>\r\n          <Text style={Styles.form_error_text}>{lang(error)}</Text>\r\n        </View>}\r\n        <TextInput\r\n          style={Styles.form_input}\r\n          value={username}\r\n          placeholder={lang('Username')}\r\n          onChangeText={(text) => setUsername(text)}\r\n          autoCapitalize={'none'}\r\n          keyboardType={'email-address'}\r\n          onSubmitEditing={_login}\r\n        />\r\n        <TextInput\r\n          style={Styles.form_input}\r\n          value={password}\r\n          placeholder={lang('Password')}\r\n          secureTextEntry\r\n          onChangeText={(text) => setPassword(text)}\r\n          onSubmitEditing={_login}\r\n        />\r\n        <TouchableOpacity onPress={_login}>\r\n          <View style={Styles.button}>\r\n            <Text style={Styles.button_label}>{lang('Sign in')}</Text>\r\n          </View>\r\n        </TouchableOpacity>\r\n        <TouchableOpacity onPress={() => dispatch({type:\"LOGIN_GUEST\"})}>\r\n          <Text style={Styles.guest_footer_text}>\r\n            {lang(\"Sign in as guest\")}\r\n          </Text>\r\n        </TouchableOpacity>\r\n      </View>\r\n      <View style={Styles.login_social}>\r\n        <View style={Styles.login_social_separator}>\r\n          <View style={Styles.login_social_separator_line} />\r\n          <Text style={Styles.login_social_separator_text}>{'*'}</Text>\r\n          <View style={Styles.login_social_separator_line} />\r\n        </View>\r\n        <View style={Styles.login_social_buttons}>\r\n        </View>\r\n      </View>\r\n      {/* <>\r\n        <TouchableOpacity onPress={() => navigate(\"RegistrationScreen\")}>\r\n          <Text style={Styles.login_footer_text}>\r\n            {\"Don't have an account? \"}\r\n            <Text style={Styles.login_footer_link}>{'Sign up'}</Text>\r\n          </Text>\r\n        </TouchableOpacity>\r\n      </> */}\r\n    </View>\r\n    <ContractFooter theme='light'/>\r\n  </View>);\r\n};\r\n\r\nconst Styles = StyleSheet.create({\r\n    login_container: {\r\n      flex: 1,\r\n      backgroundColor: '#FFF',\r\n    },\r\n    login_header: {\r\n      alignItems: 'center',\r\n      paddingTop: 30,\r\n      paddingBottom: 50,\r\n      backgroundColor: '#208AEC',\r\n    },\r\n    login_header_logo: {\r\n      width: 220,\r\n      resizeMode: 'contain',\r\n    },\r\n    login_header_text: {\r\n      marginTop: 15,\r\n      color: '#f0f0f0',\r\n      fontSize: 16,\r\n    },\r\n    login_header_text_bold: {\r\n      color: '#fff',\r\n      fontWeight: 'bold',\r\n    },\r\n    login_wrapper: {\r\n      flex: 1,\r\n      justifyContent: 'space-between',\r\n      paddingTop: 40,\r\n      borderTopRightRadius: 12,\r\n      borderTopLeftRadius: 12,\r\n      backgroundColor: '#fff',\r\n      alignItems: 'center',\r\n    },\r\n    form: {\r\n      width: '100%',\r\n      maxWidth: 320,\r\n    },\r\n    form_error: {\r\n      height: 22,\r\n      width:'100%',\r\n    },\r\n    form_error_text:{\r\n      textAlignVertical:'center',\r\n      color:'red',\r\n      fontSize:13,\r\n    },\r\n    form_input: {\r\n      height: 44,\r\n      paddingHorizontal: 20,\r\n      marginBottom: 20,\r\n      backgroundColor: '#EDF0F7',\r\n      borderRadius: 50,\r\n    },\r\n    button: {\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n      height: 44,\r\n      backgroundColor: '#0065A4',\r\n      borderRadius: 50,\r\n    },\r\n    button_label: {\r\n      color: '#fff',\r\n      fontSize: 16,\r\n    },\r\n    login_social: {\r\n      width: '100%',\r\n      maxWidth: 280,\r\n      marginTop: 20,\r\n    },\r\n    login_social_separator: {\r\n      flexDirection: 'row',\r\n      alignItems: 'center',\r\n    },\r\n    login_social_separator_line: {\r\n      flex: 1,\r\n      width: '100%',\r\n      height: 1,\r\n      backgroundColor: '#E0E0E0',\r\n    },\r\n    login_social_separator_text: {\r\n      marginHorizontal: 10,\r\n      color: '#808080',\r\n      fontSize: 16,\r\n    },\r\n    login_social_buttons: {\r\n      flexDirection: 'row',\r\n      justifyContent: 'center',\r\n      marginTop: 20,\r\n    },\r\n    login_social_button: {\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n      width: 60,\r\n      height: 60,\r\n      marginHorizontal: 12,\r\n      borderWidth: 1,\r\n      borderColor: '#E7E7E7',\r\n      borderRadius: 60,\r\n    },\r\n    login_social_icon: {\r\n      width: 38,\r\n      height: 38,\r\n      resizeMode: 'contain',\r\n    },\r\n    login_social_facebook: {\r\n      backgroundColor: '#4267B2',\r\n      borderColor: '#4267B2',\r\n    },\r\n    login_footer_text: {\r\n      flexDirection: 'row',\r\n      alignItems: 'center',\r\n      color: '#808080',\r\n      fontSize: 14,\r\n    },\r\n    guest_footer_text: {\r\n      flexDirection: 'row',\r\n      alignSelf: 'center',\r\n      color: '#808080',\r\n      fontSize: 15,\r\n      margin: 15\r\n    },\r\n    login_footer_link: {\r\n      color: '#208AEC',\r\n      fontSize: 15,\r\n      fontWeight: 'bold',\r\n    },\r\n  });\r\n  ","import React from 'react'\r\nimport { Image, Linking } from \"react-native\"\r\nimport { TouchableOpacity } from \"react-native-gesture-handler\"\r\nimport CommonSection from \"./CommonSection\"\r\nimport { View, Text } from \"./Themed\"\r\nimport { Link } from \"../types\"\r\n\r\n\r\n\r\nexport default ({link, isMobile}:{link:Link, isMobile:boolean})=>{\r\n    return <CommonSection containerStyle={{marginHorizontal:0}} bodyStyle={{padding:0}}>\r\n    <TouchableOpacity \r\n        onPress={()=>Linking.openURL(link.url)}\r\n        onLongPress={()=>{}}\r\n        style={{width:'100%', flexDirection:'row'}}\r\n    >\r\n        {link.image && <Image source={{uri:link.image}} resizeMode=\"cover\" style={{ width:'100%', maxWidth:isMobile?120:150, maxHeight:isMobile?120:150, borderWidth:1}}/>}\r\n        <View style={{flex:1, marginHorizontal:20}}>\r\n        <Text style={{fontSize:18}}>{link.title}</Text>\r\n        <Text style={{fontSize:14}}>{link.description}</Text>\r\n        <Text style={{fontSize:12}}>{link.url}</Text>\r\n        </View>\r\n    </TouchableOpacity>\r\n    </CommonSection>\r\n}","import React, { createContext, useContext } from \"react\"\r\nimport { SendJsonMessage } from \"react-use-websocket/dist/lib/types\";\r\nimport { WebSocketInternalProvider } from \"../../hooks/useWebsocketContext\";\r\n\r\nconst WebSocketContext = createContext<{lastJsonMessage:any, sendJsonMessage:SendJsonMessage }>({lastJsonMessage:undefined, sendJsonMessage:()=>{}});\r\n\r\nexport const WebSocketProvider = ({disable, children}:{disable?:boolean, children:React.ReactNode})=>{\r\n  return disable?<></>:<WebSocketInternalProvider path={'messenger/ws/rtc/'} Context={WebSocketContext} useBackground>\r\n    {children}\r\n  </WebSocketInternalProvider>\r\n}\r\n\r\nexport default ()=>{\r\n  const webSocketContext = useContext(WebSocketContext)\r\n  return webSocketContext\r\n}\r\n\r\n","import React, { useCallback, useRef, useState, useMemo } from \"react\";\r\n//@ts-ignore\r\nimport { RTCView, mediaDevices, RTCPeerConnection, MediaStream, RTCSessionDescription, RTCIceCandidate } from \"react-native-webrtc-web-shim\";\r\nimport {TURN_SERVER} from \"../../../constants/Envs\"\r\n\r\n\r\nconsole.log(TURN_SERVER?\"use turn server\": \"use stun server\")\r\n\r\nexport const peerConstraints = {\r\n\ticeServers: [TURN_SERVER?JSON.parse(TURN_SERVER):{urls: 'stun:stun.l.google.com:19302'}]\r\n};\r\n\r\nexport const sessionConstraints = {\r\n\tmandatory: {\r\n\t\tOfferToReceiveAudio: true,\r\n\t\tOfferToReceiveVideo: true,\r\n\t\tVoiceActivityDetection: true\r\n\t}\r\n};\r\n\r\nconst mediaConstraints = {audio:true, video:{framerate:30}}\r\n\r\n//@ts-ignore\r\nexport {MediaStream, RTCPeerConnection, RTCSessionDescription} from \"react-native-webrtc-web-shim\";\r\n\r\nconst onICEcandidate = (pc:typeof RTCPeerConnection, message:any)=>{\r\n\tconst _message = message.data.rtcMessage\r\n\t\tconst candidate = new RTCIceCandidate(_message);\r\n\t\tif (pc) {\r\n\t\t\tconsole.log(\"ICE candidate Added\");\r\n\t\t\tpc.addIceCandidate(candidate);\r\n\t\t}\r\n}\r\n\r\nconst sendICEcandidate = (event:any, sendMessage:(data:any)=>void, receiver:string, target:string) => {\r\n\t// When you find a null candidate then there are no more candidates.\r\n\t// Gathering of candidates has finished.\r\n\tif ( !event.candidate ) { return; };\r\n\t// Send the event.candidate onto the person you're calling.\r\n\t// Keeping to Trickle ICE Standards, you should send the candidates immediately.\r\n\tsendMessage({type:'ICEcandidate', receiver, data:{target, rtcMessage:event.candidate}})\r\n  }\r\n\r\nconst BAND_WIDTH = 8000\r\n\r\nconst optimizeSdp = (offerDescription:RTCSessionDescription)=>{\r\n\tvar arr = offerDescription.sdp.split('\\r\\n');\r\n\tarr.forEach((str:string, i:number) => {\r\n\t\tif (/^a=fmtp:\\d*/.test(str)) {\r\n\t\t\tarr[i] = str + `;x-google-max-bitrate=${BAND_WIDTH};x-google-min-bitrate=${BAND_WIDTH};x-google-start-bitrate=${BAND_WIDTH}`;\r\n\t\t} else if (/^a=mid:(0|video)/.test(str)) { // if with audio then 0=>1\r\n\t\t\tarr[i] += `\\r\\nb=AS:${BAND_WIDTH}`;\r\n\t\t}\r\n\t});\r\n  \treturn new RTCSessionDescription({\r\n    \ttype: offerDescription.type,\r\n    \tsdp: arr.join('\\r\\n'),\r\n  \t})\r\n}\r\n\r\nconst createOffer = async(pcRefCurrent:{pc?:typeof RTCPeerConnection, receiver:string}, sendMessage:(data:any)=>void, stream:typeof MediaStream, target:string, user?:{name:string})=>{\r\n\tstream && pcRefCurrent.pc.addStream( stream );\r\n\tconst offerDescription = optimizeSdp((await pcRefCurrent.pc.createOffer( sessionConstraints )));\r\n\tawait pcRefCurrent.pc.setLocalDescription( offerDescription );\r\n\tsendMessage({type:'call', receiver:pcRefCurrent.receiver, data:{target, name:user?.name, rtcMessage:offerDescription}})\r\n}\r\n\r\nexport const useLocalCam = (sendMessage:(data:any)=>void)=>{\r\n\tconst pcRef = useRef<Record<number,{pc:typeof RTCPeerConnection, receiver:string}>>({})\r\n\tconst [sender, setSender] = useState<string>()\r\n\tconst [_stream, setStream] = useState<MediaStream>()\r\n\tconst isPlay = useMemo(()=>_stream?true:false, [_stream])\r\n\tconst CustomRTCView = useCallback(React.memo(({style}:{style:any})=>(_stream?<RTCView stream={_stream} style={style} videoProps={{height:'100%'}} />:<></>)) , [_stream])\r\n\tconst start = useCallback(async(user:{name:string}, stream?:typeof MediaStream, mode?:'camera'|'display')=>{\r\n\t\tconsole.log(\"start\");\r\n\t\tif (!_stream || mode!==undefined) {\r\n\t\t\ttry {\r\n\t\t\t\tlet newStream:typeof MediaStream;\r\n\t\t\t\tif(mode == 'camera'){\r\n\t\t\t\t\tnewStream = await mediaDevices.getUserMedia(mediaConstraints)\r\n\t\t\t\t}\r\n\t\t\t\telse if (mode == 'display'){\r\n\t\t\t\t\tnewStream = await mediaDevices.getDisplayMedia(mediaConstraints)\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tnewStream = stream || await mediaDevices.getUserMedia(mediaConstraints).catch((e:any)=>mediaDevices.getDisplayMedia(mediaConstraints));\r\n\t\t\t\t}\r\n\t\t\t\tsetStream(newStream)\r\n\t\t\t\tObject.entries(pcRef.current).map(([k, v])=>{\r\n\t\t\t\t\tcreateOffer(v, sendMessage, newStream, 'guest', user)\r\n\t\t\t\t})\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.error(e);\r\n\t\t\t}\r\n\t\t}\r\n\t}, [_stream])\r\n\tconst stop = useCallback(()=>{\r\n\t\tconsole.log(\"stop\");\r\n\t\tif(_stream){\r\n\t\t\t_stream.getTracks().map((track:any) => track.stop());\r\n\t\t\tsetStream(undefined)\r\n\t\t}\r\n\t}, [_stream])\r\n\treturn {\r\n\t\tstart,\r\n\t\tstop,\r\n\t\twebsocketOnMessage: async(response:any, user:{name:string})=>{\r\n\t\t\tlet type = response.type;\r\n\t\t\tif (type == 'connection'){\r\n\t\t\t\tsetSender(response.data.channel_name)\r\n\t\t\t}\r\n\t\t\tif (type == 'start' && response.data.target=='host'){\r\n\t\t\t  console.log('1 start')\r\n\t\t\t  const peerConnection = new RTCPeerConnection( peerConstraints );\r\n\t\t\t  peerConnection.addEventListener( 'icecandidate', (event:any) => sendICEcandidate(event, sendMessage, response.sender, 'guest'));\r\n\t\t\t  pcRef.current[response.sender] = {pc:peerConnection, receiver: response.sender}\r\n\t\t\t  createOffer(pcRef.current[response.sender], sendMessage, _stream, 'guest', user)\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (type == \"answer\" && response.data.target == 'host'){\r\n\t\t\t  console.log('3 answer')\r\n\t\t\t  const peerConnection = pcRef.current[response.sender].pc\r\n\t\t\t  const answerDescription = new RTCSessionDescription(response.data.rtcMessage);\r\n\t\t\t  await peerConnection.setRemoteDescription( answerDescription );\r\n\t\t\t  // const streams = pcRef.current.pc.getRemoteStreams()\r\n\t\t\t  // setMirrorStream(streams[streams.length - 1])\r\n\t\t\t}\r\n\t\t\tif (type == \"ICEcandidate\" && response.data.target=='host'){\r\n\t\t\t\tconst peerConnection = pcRef.current[response.sender].pc\r\n\t\t\t\tonICEcandidate(peerConnection, response)\r\n\t\t\t}\r\n\t\t},\r\n\t\tCustomRTCView,\r\n\t\tisPlay,\r\n\t\tsender,\r\n\t\t// renderMirrorView,\r\n\t}\r\n}\r\n\r\nexport const useRemoteCam = (sendMessage:(data:any)=>void)=>{\r\n\tconst pcRef = useRef<{pc?:RTCPeerConnection, receiver?:string, statsInterval?:any}>({})\r\n\tconst [user, setUser] = useState<{name:string}>()\r\n\tconst [_stream, setStream] = useState<MediaStream>()\r\n\tconst CustomRTCView = useCallback(React.memo((style:any)=>_stream?<RTCView stream={_stream} style={style} videoProps={{height:'100%'}} />:<></>), [_stream])\r\n\tconst isPlay = useMemo(()=>_stream?true:false, [_stream])\r\n\tconst start = useCallback((receiver:string)=>{\r\n\t\tconsole.log(\"start\");\r\n\t\tif (!pcRef.current.pc) {\r\n\t\t  pcRef.current.pc = new RTCPeerConnection( peerConstraints );\r\n\t\t  pcRef.current.receiver = receiver\r\n\t\t}\r\n\t\tif (!_stream){\r\n\t\t\tsendMessage({type:'start', receiver, data:{'target': 'host'}})\r\n\t\t}\r\n\t}, [_stream])\r\n\tconst stop = () => {\r\n\t\tconsole.log(\"stop\");\r\n\t\tif (pcRef.current.pc) {\r\n\t\t  // peerConnection._unregisterEvents();\r\n\t\t  setStream(undefined)\r\n\t\t  pcRef.current.pc.close();\r\n\t\t  pcRef.current.pc = undefined\r\n\t\t  pcRef.current.receiver = undefined\r\n\t\t  clearInterval(pcRef.current.statsInterval)\r\n\t\t}\r\n\t}\r\n\treturn {\r\n\t\tstart,\r\n\t\tstop,\r\n\t\twebsocketOnMessage: async(response:any)=>{\r\n\t\t\tlet type = response.type;\r\n\t\t\tif (type == 'start' && response.data.target=='guest' && response.sender == pcRef.current?.receiver){\r\n\t\t\t\tconsole.log('(remote)1 start')\r\n\t\t\t\tconst peerConnection = pcRef.current.pc\r\n\t\t\t\tsetUser({name: response.data.name})\r\n\t\t\t\tpeerConnection.addEventListener('icecandidate', (event:any) => sendICEcandidate(event, sendMessage, response.sender, 'host'));\r\n\t\t\t\tpeerConnection.addEventListener('iceconnectionstatechange', (e:any)=>{\r\n\t\t\t\t\tif (pcRef.current.pc.iceConnectionState == 'connected'){\r\n\t\t\t\t\t\tlet activeStream = false\r\n\t\t\t\t\t\tpcRef.current.statsInterval = setInterval(async()=>{\r\n\t\t\t\t\t\t\tconst stats = await pcRef.current.pc.getStats(null)\r\n\t\t\t\t\t\t\tlet statsOutput = \"\";\r\n\t\t\t\t\t\t\tlet framePerSecond = undefined\r\n\t\t\t\t\t\t\tstats.forEach((report:any) => {\r\n\t\t\t\t\t\t\t\tif (report.type === \"inbound-rtp\" && report.kind === \"video\") {\r\n\t\t\t\t\t\t\t\t\tObject.keys(report).forEach((statName) => {\r\n\t\t\t\t\t\t\t\t\t\tstatsOutput += `${statName}: ${report[statName]}\\n`;\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\tframePerSecond = report.framesPerSecond\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tconsole.log(activeStream, framePerSecond)\r\n\t\t\t\t\t\t\tif (framePerSecond != undefined){\r\n\t\t\t\t\t\t\t\tactiveStream = true\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if (activeStream){\r\n\t\t\t\t\t\t\t\tstop()\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tconsole.log(new Date().toTimeString().split(' ')[0], statsOutput)\r\n\t\t\t\t\t\t}, 1000);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (pcRef.current.pc.iceConnectionState == 'failed'){\r\n\t\t\t\t\t\tstop()\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t// peerConnection.addTransceiver('audio', {\r\n\t\t\t\t// \tdirection: 'recvonly'\r\n\t\t\t\t// });\r\n\t\t\t\tpeerConnection.addTransceiver('video', {\r\n\t\t\t\t\tdirection: 'recvonly'\r\n\t\t\t\t});\r\n\t\t\t\tawait createOffer({pc:pcRef.current.pc, receiver:response.sender}, sendMessage, _stream, 'host', user)\r\n\t\t\t}  \r\n\t\t\tif (type == \"answer\" && response.data.target=='guest' && response.sender == pcRef.current?.receiver){\r\n\t\t\t\tconsole.log('(remote)3 answer')\r\n\t\t\t\tconst answerDescription = new RTCSessionDescription(response.data.rtcMessage);\r\n\t\t\t\tawait pcRef.current.pc.setRemoteDescription( answerDescription );\r\n\t\t\t\tconst streams = pcRef.current.pc.getRemoteStreams()\r\n\t\t\t\tsetStream(streams[streams.length - 1])\r\n\t\t\t\tsendMessage({type:'end', receiver:pcRef.current.receiver, data:{}})\r\n\t\t\t}\r\n\t\t\tif (type == \"call\" && response.sender == pcRef.current?.receiver){\r\n\t\t\t  console.log('2 call')\r\n\t\t\t  const peerConnection = pcRef.current.pc\r\n\t\t\t  setUser({name:response.data.name})\r\n\t\t\t  if (!peerConnection)\r\n\t\t\t\treturn\r\n\t\t\t  peerConnection.addEventListener( 'icecandidate', (event:any) => sendICEcandidate(event, sendMessage, response.sender, 'host'));\r\n\t\t\t  const offerDescription = new RTCSessionDescription(response.data.rtcMessage);\r\n\t\t\t  await peerConnection.setRemoteDescription( offerDescription );\r\n\t\t\t  const answerDescription = await peerConnection.createAnswer( sessionConstraints );\r\n\t\t\t  await peerConnection.setLocalDescription( answerDescription );\r\n\t\t\t  sendMessage({type:'answer', receiver:pcRef.current.receiver, data:{target:'host', rtcMessage:peerConnection.localDescription}})\r\n\t\t\t  // Here is a good place to process candidates.\r\n\t\t\t  const streams = pcRef.current.pc.getRemoteStreams()\r\n\t\t\t  setStream(streams[streams.length - 1])\r\n\t\t\t}\r\n\t\t\tif (type == \"ICEcandidate\" && response.data.target=='guest' && response.sender == pcRef.current?.receiver)\r\n\t\t\t  onICEcandidate(pcRef.current.pc, response)\r\n\t\t},\r\n\t\tCustomRTCView,\r\n\t\tuser,\r\n\t\tisPlay\r\n\t}\r\n}","import {StyleSheet} from \"react-native\";\r\nexport {useLocalCam, useRemoteCam} from \"./p2p\"\r\n\r\nexport const camStyle = StyleSheet.create({\r\n\tcontainer:{ flex: 1},\r\n\tcam:{ flex: 1, height:'100%'},\r\n\tbottonContainer: {position:\"absolute\", bottom:0, justifyContent:'flex-end'},\r\n\tbuttonBar: { flexDirection: \"row\", justifyContent: \"space-around\" },\r\n\tlabel: {backgroundColor:'#0008', color:'white', paddingHorizontal:5},\r\n})","import React, { useEffect } from \"react\";\r\nimport {Button, View, Text} from \"react-native\";\r\nimport useWebsocketContext from \"./useWebsocketContext\";\r\nimport { useLocalCam, camStyle} from \"./webrtc\";\r\n\r\n\r\nexport default (props:{user?:{name:string}|null, mode?:'camera'|'display'|null})=>{\r\n  const {lastJsonMessage, sendJsonMessage} = useWebsocketContext()\r\n  const {start, stop, websocketOnMessage, CustomRTCView, isPlay} = useLocalCam(sendJsonMessage)\r\n  useEffect(()=>{\r\n    props.user && lastJsonMessage && websocketOnMessage(lastJsonMessage, props.user)\r\n  }, [lastJsonMessage, props.user])\r\n  useEffect(()=>{\r\n    if(props.mode && !isPlay){\r\n      props.user && start(props.user, undefined, props.mode)\r\n    }\r\n    else if(props.mode===null && isPlay){\r\n      stop()\r\n    }\r\n    return ()=>{isPlay && stop()}\r\n  }, [isPlay, props.user, props.mode])\r\n  return (\r\n    <View style={camStyle.container}>\r\n      <CustomRTCView style={camStyle.cam}/>\r\n      <View style={camStyle.bottonContainer}>\r\n        <View style={camStyle.buttonBar}>  \r\n        </View>\r\n        <View style={{flexDirection:'row'}}><Text style={camStyle.label}>{props.user?.name}</Text></View>\r\n        <View style={camStyle.buttonBar}>\r\n          {props.mode === undefined && !isPlay && <Button title=\"Start\" onPress={()=>props.user && start(props.user)} />}\r\n          {props.mode === undefined && isPlay && <Button title=\"Stop\" onPress={stop} />}\r\n        </View>\r\n      </View>\r\n    </View>\r\n  );\r\n}\r\n","import React, { useState, useEffect, } from \"react\";\r\nimport {Button,Text, TextInput, View} from \"react-native\";\r\nimport useWebsocketContext from \"./useWebsocketContext\";\r\nimport { useRemoteCam, camStyle} from \"./webrtc\";\r\n\r\nexport default (props:{receiver?:string})=>{\r\n  const [receiver, setReceiver] = useState('')\r\n  const {lastJsonMessage, sendJsonMessage} = useWebsocketContext()\r\n  const {start, stop, websocketOnMessage, CustomRTCView, isPlay, user} = useRemoteCam(sendJsonMessage)\r\n  useEffect(()=>{\r\n    lastJsonMessage && websocketOnMessage(lastJsonMessage)\r\n  }, [lastJsonMessage])\r\n  useEffect(()=>{\r\n    if(props.receiver){\r\n      start(props.receiver)\r\n    }\r\n    return ()=>stop()\r\n  }, [props.receiver])\r\n  return (\r\n    <View style={camStyle.container}>\r\n      <CustomRTCView style={camStyle.cam}/>\r\n      <View style={camStyle.bottonContainer}>\r\n        <View style={camStyle.buttonBar}>\r\n        </View>\r\n        <View style={{flexDirection:'row'}}>{\r\n          (props.receiver || isPlay)?\r\n          <Text style={camStyle.label}>{user?.name || 'loading...'}</Text>:\r\n          <>\r\n            <Text style={{borderWidth:1}}>Receiver:&nbsp;</Text>\r\n            <TextInput style={{borderWidth:1, flex:1}} value={receiver} onChangeText={setReceiver}/>\r\n          </> \r\n        }</View>\r\n        <View style={camStyle.buttonBar}>\r\n          {props.receiver === undefined && !isPlay && <Button title=\"Start\" onPress={()=>start(receiver)} />}\r\n          {props.receiver === undefined && isPlay && <Button title=\"Stop\" onPress={stop} />}\r\n        </View>\r\n      </View>\r\n    </View>\r\n  );\r\n}\r\n\r\n","import React, {useEffect, useState} from 'react';\r\nimport { StyleSheet, View } from 'react-native';\r\nimport { View as ThemedView } from '../../../components/Themed' \r\nimport Colors from '../../../constants/Colors';\r\nimport {default as useRtcContext, WebSocketProvider as RtcProvider} from \"../../../lib/react-native-webrtc/useWebsocketContext\";\r\nimport LocalCam from '../../../lib/react-native-webrtc/LocalCam';\r\nimport RemoteCam from '../../../lib/react-native-webrtc/RemoteCam';\r\nimport useResizeContext from '../../../hooks/useResizeContext';\r\nimport useAuthContext from '../../../hooks/useAuthContext';\r\nimport { TouchableOpacity } from 'react-native-gesture-handler';\r\nimport CommonButton from '../../../components/CommonButton';\r\nimport { Ionicons } from '../../../lib/@expo/vector-icons';\r\nimport useIsMobile from '../../../hooks/useIsMobile';\r\n\r\ntype VideoType = 'camera'|'display'|null\r\ntype VideoCallProps = {channel_id:number, setDisable:(disable:boolean)=>void, disable?:boolean}\r\n\r\n\r\nconst VideoView = (props:{\r\n  scale:string,\r\n  focusGuest?:string,\r\n  setFocusGuest:(focusGuest?:string)=>void\r\n  receiver?:string\r\n  children:React.ReactNode\r\n})=>{\r\n  return <View style={[{maxWidth:props.scale, maxHeight:props.scale, borderWidth:1, borderColor:Colors.borderColor, backgroundColor:'gray', flexDirection:'row', flexGrow:1}, (props.focusGuest == undefined || props.focusGuest == props.receiver)?{height:'100%'}:{maxWidth:0, height:0}]}>\r\n    <TouchableOpacity style={{flex:1}} containerStyle={{flex:1, justifyContent:'center'}} onPress={()=>props.setFocusGuest(props.focusGuest?undefined:props.receiver)}>\r\n    {props.children}\r\n    </TouchableOpacity>\r\n  </View>\r\n    \r\n  \r\n}\r\n\r\nconst VideoCallContainer = ({channel_id, disable, setDisable}:VideoCallProps)=>{\r\n  const {auth} = useAuthContext()\r\n  const isMobile = useIsMobile()\r\n  const [videoMode, setVideoMode] = useState<VideoType>(null)\r\n  const [guests, setGuests] = useState<string[]>([])\r\n  const [focusGuest, setFocusGuest] = useState<string>()\r\n  const windowType = useResizeContext()\r\n  const { lastJsonMessage, sendJsonMessage } = useRtcContext()\r\n  useEffect(()=>{\r\n    if(lastJsonMessage !=null){\r\n      if(lastJsonMessage['type']=='connection'){\r\n        sendJsonMessage({'type':'broadcast', 'data':{'channel_id':channel_id}})\r\n      }\r\n      if(lastJsonMessage['type']=='broadcast_guest' || lastJsonMessage['type']=='broadcast_host'){\r\n        setGuests([...guests, lastJsonMessage['sender']])\r\n      }\r\n      if(lastJsonMessage['type']=='broadcast_disconnect'){\r\n        const channel_name = lastJsonMessage['sender']\r\n        const exist = guests.find(v=>v == channel_name)\r\n        exist && setGuests(guests.filter(v=>v != channel_name))\r\n      }\r\n    }\r\n  }, [lastJsonMessage])\r\n  const scale = focusGuest?'100%':`${100 / Math.max(2, Math.ceil(Math.sqrt(guests.length + 1)))}%`\r\n  const toggleVideoMode = (mode:VideoType)=>{\r\n    setVideoMode(videoMode!=mode?mode:null)\r\n  }\r\n  return lastJsonMessage !==undefined ?\r\n    <ThemedView style={[\r\n      {aspectRatio:!disable?16/9:0, borderColor:Colors.borderColor, borderRadius:10},\r\n      windowType=='landscape'?{flexShrink:1, flexGrow:0, height:'100%', borderLeftWidth:1, paddingBottom:65}:{maxHeight:'36%', width:'100%', borderBottomWidth:1}\r\n    ]}>\r\n      <View style={{aspectRatio:focusGuest?undefined:16/9, backgroundColor:'white', flexWrap:'wrap', flexDirection:'row', width:'100%', height:'100%'}}>\r\n        {guests.map((receiver, i)=><VideoView scale={scale} focusGuest={focusGuest} setFocusGuest={setFocusGuest} receiver={receiver}>\r\n          <RemoteCam receiver={receiver}/>\r\n        </VideoView>\r\n        )}\r\n        <VideoView scale={scale} focusGuest={focusGuest} setFocusGuest={setFocusGuest} receiver={auth.user?.name}>\r\n          <LocalCam user={auth.user} mode={videoMode}/>\r\n        </VideoView>\r\n      </View>\r\n      <ThemedView style={[\r\n          {position:'absolute', alignItems:'center', justifyContent:'flex-end', width:'100%',flexDirection:'row'},\r\n          windowType=='landscape'?{bottom:0, paddingTop:15, paddingBottom:10, paddingHorizontal:19}:{backgroundColor:'transparent'}\r\n        ]}>\r\n        <CommonButton title={'⏺️'} style={{height:40, paddingTop:8}} onPress={()=>toggleVideoMode('camera')}/>\r\n        {!isMobile && <CommonButton title={'🖥️'} style={{height:40, paddingTop:8}} onPress={()=>toggleVideoMode('display')}/>}\r\n        <CommonButton title={''} style={{height:40, paddingTop:8}} onPress={()=>setDisable(true)}>\r\n          <Ionicons size={20} name=\"arrow-back\" color={'deepskyblue'}/>\r\n        </CommonButton>\r\n      </ThemedView>\r\n    </ThemedView>:\r\n  <></>\r\n  }\r\n  \r\nexport default React.memo(({channel_id, disable, setDisable}:VideoCallProps)=>{\r\n  return <RtcProvider disable={disable}>\r\n    <VideoCallContainer channel_id={channel_id} disable={disable} setDisable={setDisable}/>\r\n  </RtcProvider>\r\n})\r\n","import React from 'react'\r\nimport { Linking, TextStyle } from \"react-native\"\r\nimport {TouchableOpacity} from \"react-native-gesture-handler\"\r\nimport CommonSection from \"./CommonSection\"\r\nimport { FontAwesome } from '../lib/@expo/vector-icons'; \r\nimport { View, Text } from \"./Themed\"\r\nimport { File } from \"../types\"\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport Colors from '../constants/Colors';\r\n\r\nfunction humanFileSize(size:number) {\r\n    var i = size == 0 ? 0 : Math.floor(Math.log(size) / Math.log(1024));\r\n    return (size / Math.pow(1024, i)).toFixed(2) + ' ' + ['B', 'kB', 'MB', 'GB', 'TB'][i];\r\n  }\r\n  \r\n\r\nexport default ({file, isMobile, showBorder}:{file:File, isMobile:boolean, showBorder:ConstrainBoolean})=>{\r\n    const theme = useColorScheme()\r\n    return <CommonSection containerStyle={{marginHorizontal:0}} bodyStyle={showBorder?{padding:10}:{borderWidth:0, padding:0}}>\r\n    <TouchableOpacity \r\n        onPress={()=>Linking.openURL(file.file)} \r\n        onLongPress={()=>{}}\r\n        style={{flexDirection:'row', alignItems:'flex-start', width:'100%'}} \r\n    >\r\n        <FontAwesome name=\"file-o\" size={20} color={Colors[theme].iconColor} />\r\n        <View style={{flex:1, marginHorizontal:10}}>\r\n            <Text style={{fontSize:18}}>{file.filename}</Text>\r\n            <Text style={{fontSize:14}}>{humanFileSize(file.filesize)}</Text>\r\n        </View>\r\n    </TouchableOpacity>\r\n    </CommonSection>\r\n}","import React, {useState, useEffect} from \"react\"\r\nimport dayjs from \"dayjs\";\r\nimport {View, TouchableOpacity} from 'react-native'\r\nimport { Text } from \"../../../components/Themed\";\r\nimport useTimerMessageContentList from \"../../../hooks/lists/useTimerMessageContent\";\r\nimport { MessengerContent } from \"../../../types\";\r\nimport Avatar from \"../../../components/Avatar\";\r\nimport Hyperlink from \"react-native-hyperlink\";\r\n\r\nexport function timerFormat(datetime:string){\r\n    return _timerFormat(dayjs(datetime), dayjs())\r\n}\r\n\r\nfunction _timerFormat(m:dayjs.Dayjs, now:dayjs.Dayjs){\r\n    if (m.year() != now.year()){\r\n        return m.format('YYYY.MM')\r\n    }\r\n    if(m.month()!= now.month() || m.day() != now.day()){\r\n        return m.format('MM.DD')\r\n    }\r\n    return m.format('HH:mm')\r\n  }\r\n\r\nexport function timerToString(timer:string){\r\n    return dayjs(timer).format('YYYY.MM.DD HH:mm')\r\n}\r\n\r\nconst TimerTag = (props:{data:MessengerContent, now:dayjs.Dayjs, isExpand:boolean, setExpand:(id?:number)=>void})=>{\r\n    const start = dayjs(props.data.created)\r\n    const end = dayjs(props.data.timer)\r\n    const ratio = (start.diff(props.now)/start.diff(end))\r\n    return <TouchableOpacity onPress={()=>props.setExpand(props.isExpand?undefined:props.data.id)}>\r\n        <View style={{backgroundColor:'lightgray', borderRadius:20, overflow:'hidden', margin:5}}>\r\n            <View style={{backgroundColor:'darkgray', position:'absolute', width:`${ratio*100}%`, height:'100%'}}/>\r\n            {props.isExpand?\r\n            <View style={{paddingVertical:5, paddingHorizontal:5, maxWidth:270}}>\r\n                <View style={{flexDirection:'row'}}>\r\n                    <Avatar name={props.data.name} userId={props.data.user} size={20}/>\r\n                    <View style={{paddingHorizontal:5}}><Text>{props.data.name}</Text></View>\r\n                </View>\r\n                <View style={{flexDirection:'row', alignItems:'stretch'}}>\r\n                    <Text>⌚</Text>\r\n                    <Text selectable>{timerToString(props.data.timer)}</Text>\r\n                </View>\r\n                {/* @ts-ignore */}\r\n                <Hyperlink linkDefault={ true } style={{wordBreak:\"break-word\"}} linkStyle={{color: '#12b886'}}>\r\n                    <Text selectable>{props.data.message_set[0].content}</Text>\r\n                </Hyperlink>\r\n            </View>:    \r\n            <View style={{paddingVertical:5, paddingHorizontal:5, flexDirection:'row'}}>\r\n                <Avatar name={props.data.name} userId={props.data.user} size={20}/>\r\n                <View style={{paddingHorizontal:5}}><Text>{_timerFormat(end, props.now)}</Text></View>\r\n            </View>}\r\n        </View>\r\n    </TouchableOpacity>\r\n}\r\n\r\n\r\nexport default (props:{channel_id:number})=>{\r\n    const timerMessages = useTimerMessageContentList(props.channel_id)\r\n    const [now, setNow] = useState(dayjs())\r\n    const [expand, setExpand] = useState<number>()\r\n    useEffect(()=>{\r\n        const timeout = setTimeout(()=>{\r\n            setNow(dayjs())\r\n        }, 2000)\r\n        return ()=>clearTimeout(timeout)\r\n    }, [now])\r\n    return <View style={{flexDirection:'row', paddingTop:5, paddingHorizontal:20}}>\r\n        {timerMessages?.map((v,i)=><TimerTag key={i} data={v} now={now} isExpand={v.id==expand} setExpand={setExpand}/>)}\r\n    </View>\r\n}","import { useEffect, useMemo } from \"react\"\r\nimport { useQuery, useQueryClient } from \"react-query\"\r\nimport { getTimerMessageContentList } from \"../../apis\"\r\nimport { MessengerContent } from \"../../types\"\r\nimport useWebsocketContext from \"../useWebsocketContext\"\r\nimport dayjs from \"dayjs\"\r\n\r\nexport default function useTimerMessageContentList(channel_id:number){  \r\n  const queryClient = useQueryClient()\r\n  const { data } = useQuery<MessengerContent[]>(\r\n    [\"TimerMessageContentList\", channel_id], \r\n    async()=>await getTimerMessageContentList(channel_id, dayjs().toISOString()), \r\n  )\r\n  const { lastJsonMessage } = useWebsocketContext()\r\n  useEffect(()=>{\r\n    if(lastJsonMessage !=null && lastJsonMessage['data']['channel'] == channel_id){\r\n      if(lastJsonMessage['type']=='next_message'){\r\n        if(lastJsonMessage['data']['timer'] && dayjs() < dayjs(lastJsonMessage['data']['timer']))\r\n          queryClient.setQueryData<MessengerContent[]>([\"TimerMessageContentList\", channel_id], (_data)=>{\r\n            return [...(_data || []), lastJsonMessage['data']]\r\n          })\r\n      }\r\n      if(lastJsonMessage['type']=='update_message'){\r\n        queryClient.setQueryData<MessengerContent[]>([\"TimerMessageContentList\", channel_id], (_data)=>{\r\n          return [...(_data?.filter(v=>v.id!=lastJsonMessage['data'].id || lastJsonMessage['data']['timer']!=null) || [])]\r\n        })\r\n      }\r\n      if(lastJsonMessage['type']=='delete_message'){\r\n        queryClient.setQueryData<MessengerContent[]>([\"TimerMessageContentList\", channel_id], (_data)=>{\r\n          return [...(_data?.filter(v=>v.id!=lastJsonMessage['data'].id) || [])]\r\n        })\r\n      }\r\n    }\r\n  }, [lastJsonMessage])\r\n  const sorted = useMemo(()=>data?.sort((a, b)=>(a.timer || '') > (b.timer || '')?1:-1), [data])\r\n  useEffect(()=>{\r\n    if (sorted?.[0]?.timer){\r\n      const id = sorted[0].id\r\n      const ms = Math.min(dayjs(sorted[0].timer).diff(dayjs()), Number.MAX_VALUE)\r\n      let timeout = setTimeout(()=>{\r\n        queryClient.setQueryData<MessengerContent[]>([\"TimerMessageContentList\", channel_id], (_data)=>{\r\n          return (_data || []).filter(v=>v.id!=id || dayjs(v.timer).diff(dayjs()) > 0)\r\n        })\r\n      }, ms)\r\n      return ()=>clearTimeout(timeout)\r\n    }\r\n  },[sorted])\r\n  return sorted\r\n}\r\n","import React, {useCallback, useEffect, useLayoutEffect, useMemo, useRef, useState} from 'react';\r\nimport { StackScreenProps } from '@react-navigation/stack';\r\nimport { Platform, StyleSheet, View, TouchableOpacity } from 'react-native';\r\nimport CommonSection from '../../../components/CommonSection';\r\nimport { FlatList, TextInput } from 'react-native-gesture-handler';\r\nimport CommonButton from '../../../components/CommonButton';\r\nimport useMessengerContentList, { MessengerContentPage, useMessengerContentMutation } from '../../../hooks/lists/useMessengerContentList';\r\nimport useAuthContext from '../../../hooks/useAuthContext';\r\nimport HeaderRight from '../../../components/HeaderRight';\r\nimport useMessengerMemberList from '../../../hooks/lists/useMessengerMemberList';\r\nimport Colors from '../../../constants/Colors';\r\nimport useColorScheme from '../../../hooks/useColorScheme';\r\nimport { Text, View as ThemedView } from '../../../components/Themed' \r\nimport Hyperlink from 'react-native-hyperlink'\r\nimport useMessengerChannelList from '../../../hooks/lists/useMessengerChannelList';\r\nimport useIsMobile from '../../../hooks/useIsMobile';\r\nimport LinkPreview from '../../../components/LinkPreview';\r\nimport Avatar, { avatarFromChannel } from '../../../components/Avatar';\r\nimport VideoCallSection from './VideoCallSection';\r\nimport useResizeContext from '../../../hooks/useResizeContext';\r\nimport FilePreview from '../../../components/FilePreview';\r\nimport useModalsContext from '../../../hooks/useModalsContext';\r\nimport InviteModal from '../../../modals/InviteModal';\r\nimport DateTimePickerModal from '../../../modals/DateTimePickerModal'\r\nimport useLangContext from '../../../hooks/useLangContext';\r\nimport { Entypo } from '../../../lib/@expo/vector-icons';\r\nimport TimerTags, { timerFormat, timerToString } from './TimerTags';\r\nimport MessageModal from '../../../modals/MessageModal';\r\nimport ChannelEditModal from '../../../modals/ChannelEditModal';\r\n\r\n\r\nfunction uploadFile(){\r\n  return new Promise<Blob|undefined>((resolve, reject)=>{\r\n    if (Platform.OS == 'web'){\r\n      var input = document.createElement('input');\r\n      input.type = 'file';\r\n      input.onchange = e => { \r\n        resolve((e.target as any).files[0])\r\n      }\r\n      input.onabort = reject\r\n      input.onerror = reject\r\n      input.click();\r\n    }\r\n    else\r\n      resolve(undefined)\r\n  })\r\n}\r\n\r\nconst MessengerContentPageItem = React.memo((props:MessengerContentPage & {ownerId?:number})=>{\r\n  const isMobile = useIsMobile()\r\n  const { setModal } = useModalsContext()\r\n  let nextPage = props.next;\r\n    while(nextPage?.next && nextPage.current.length==0){\r\n      nextPage = nextPage.next\r\n    }\r\n    const nextContent = nextPage?.current[0]\r\n    return <View style={{flexDirection: 'column-reverse'}}>\r\n      \r\n      {props.current.map((content, index2)=>{\r\n        const next = index2 + 1 < props.current.length?props.current[index2+1]:nextContent\r\n        const created:string = content.created.slice(0, 16)\r\n        const date = created.slice(0, 10)\r\n        const isSystem = content.user == null\r\n        const isFirst = next==undefined || (content.user != next.user || created != next.created.slice(0, 16))\r\n        const isSelf = props.ownerId == content.user\r\n        const dayChanged = next==undefined || date != next.created.slice(0, 10)\r\n        const message = content.message_set[0]\r\n        const openModal = ()=>setModal(MessageModal, {id:content.id, content:message.content, isOwner:isSelf, isTimer:content.timer?true:false})\r\n        if (isSystem)\r\n          return <View key={content.id} style={{flexDirection:'row', justifyContent:'center', width:'100%', marginVertical:5}}>\r\n            <Text>{message.content}</Text>\r\n          </View>\r\n        return <View key={content.id}>\r\n          {dayChanged?<View style={{flexDirection:'row', justifyContent:'center', width:'100%'}}><Text>{date}</Text></View>:undefined}\r\n          <View key={content.id} style={{flexDirection:'row', justifyContent:isSelf?'space-between':'flex-start', width:'100%'}}>\r\n            {isFirst && !isSelf? <View style={{marginTop:3, marginLeft:12}}><Avatar name={content.name} userId={content.user} size={36}/></View>:<View style={{width:48}}/>}\r\n            <CommonSection outerContainerStyle={{width:undefined, maxWidth:'90%'}} title={isFirst?content.name:undefined} titleStyle={{flex:undefined}} bodyStyle={{padding:10}} subtitle={`${created.slice(11)}`}>\r\n              <TouchableOpacity onLongPress={openModal}>\r\n                {content.timer && <View style={{flexDirection:'row', alignItems:'stretch'}}>\r\n                  <Text style={{fontSize:12}}>⌚</Text>\r\n                  <Text style={{fontSize:12}} selectable={!isMobile}>{timerToString(content.timer)}</Text>\r\n                </View>}\r\n                <View style={{width:\"100%\"}}>\r\n                  {/* @ts-ignore */}\r\n                  <Hyperlink linkDefault={ true } style={{wordBreak:\"break-word\"}} linkStyle={{color: '#12b886'}}>\r\n                    <Text selectable={!isMobile} style={{textAlign:isSelf?'right':'left'}}>{message.content}</Text>\r\n                  </Hyperlink>\r\n                </View>\r\n              {content.file_set.map((file, fileIndex)=><FilePreview key={fileIndex} file={file} isMobile={isMobile} showBorder={content.file_set.length>1 || message.content.length>0}/>)}\r\n              {content.link_set.map((link, linkIndex)=><LinkPreview key={linkIndex} link={link} isMobile={isMobile}/>)}\r\n              </TouchableOpacity>        \r\n            </CommonSection>\r\n          </View>\r\n        </View>\r\n      })}\r\n    </View>\r\n\r\n})\r\n\r\nexport default function ChatScreen({navigation, route}: StackScreenProps<any, 'Chat'>) {\r\n  const { lang, locale } = useLangContext()\r\n  const isMobile = useIsMobile()\r\n  const channel_id = route?.params?.id\r\n  const height = useRef(0)\r\n  const inputRef = useRef<TextInput>(null)\r\n  const {auth} = useAuthContext()\r\n  const { setModal } = useModalsContext()\r\n  const channel = useMessengerChannelList(auth)?.find(v=>v.id==parseInt(channel_id))\r\n  const channelAvatar = channel?avatarFromChannel(channel, auth.user):undefined\r\n  const {data, fetchNextPage } = useMessengerContentList(channel_id)\r\n  const memberList = useMessengerMemberList(channel_id)\r\n  const member_id = useMemo(()=>memberList?.find(v=>v.user == auth.user?.id)?.id, [auth, memberList])\r\n  const windowType = useResizeContext()\r\n  const [value, setValue] = useState('')\r\n  const [timer, setTimer] = useState<string>()\r\n  const [autoFocus, setAutoFocus] = useState<boolean|null>(null)\r\n  const [videoMode, setVideoMode] = useState<boolean>(false)\r\n  const [bottomTab, setBottomTab] = useState<boolean>(false)\r\n\r\n  const theme = useColorScheme()\r\n  const postValue = ()=>{\r\n    if (value.length>0){\r\n      contentMutation.create({channel:channel_id, user:auth.user?.id, content:value, timer})\r\n      setValue('')\r\n      setTimer(undefined)\r\n      setBottomTab(false)\r\n      setAutoFocus(true)\r\n    }\r\n  }\r\n  const contentMutation = useMessengerContentMutation()\r\n\r\n  useLayoutEffect(() => {\r\n    navigation.setOptions({\r\n      headerRight: ()=> <HeaderRight extra={[\r\n        {title:lang('invite'), onPress:()=>setModal(InviteModal, {id:channel_id})},\r\n        {title:lang('setting'), onPress:()=>setModal(ChannelEditModal, {id:channel_id, type:'messenger', member_id})}\r\n      ]}/>,\r\n      title: channelAvatar?.name\r\n    });\r\n  }, [navigation, route, member_id, locale]);\r\n\r\n  const renderItem = useCallback(({item, index}:{item:MessengerContentPage, index:number})=><MessengerContentPageItem {...item} ownerId={auth.user?.id}/>, [auth])\r\n  \r\n  const back = ()=>{\r\n    if(navigation.canGoBack())\r\n        navigation.goBack()\r\n      else{\r\n        navigation.navigate('HomeScreen', {tab:2})\r\n      }\r\n  }\r\n  useEffect(()=>{\r\n    setModal(null, null)\r\n    if (!channel_id)\r\n      back()\r\n  }, [route])\r\n  useEffect(()=>{\r\n    if (memberList===null || (memberList!=undefined && memberList.find(v=>v.user==auth.user?.id)==undefined))\r\n      back()\r\n  }, [memberList])\r\n  useEffect(()=>{\r\n    if(autoFocus){\r\n      (inputRef.current as any).focus()\r\n      setAutoFocus(false)\r\n    }\r\n  }, [autoFocus])\r\n  useEffect(()=>{\r\n    if (autoFocus==null && !isMobile){\r\n      const timeout = setTimeout(()=>setAutoFocus(true), 500)\r\n      return ()=>clearTimeout(timeout)\r\n    }\r\n  })\r\n  return <View style={[\r\n    {flex:1, alignItems:'center'},\r\n    windowType=='landscape'?{flexDirection:'row-reverse', minWidth:480}:{flexDirection:'column'}\r\n  ]}>\r\n    <VideoCallSection channel_id={channel_id} setDisable={(d)=>setVideoMode(!d)} disable={!videoMode}/>\r\n    <View style={[{flex:videoMode?undefined:1, flexShrink:1}, windowType=='landscape'?{minWidth:320, height:'100%'}:{width:'100%'}]}>\r\n      <FlatList\r\n        style={{flexDirection: 'column-reverse'}}\r\n        contentContainerStyle={{padding:10, flexGrow:1, flexDirection: 'column-reverse'}}\r\n        data={data?.pages}\r\n        renderItem={renderItem}\r\n        onScroll={(e)=>{\r\n          if (e.nativeEvent.contentOffset.y + e.nativeEvent.contentSize.height - height.current < 1)\r\n            fetchNextPage()\r\n        }}\r\n        onLayout={(p)=>{height.current = p.nativeEvent.layout.height}}\r\n      />\r\n      <View style={{position:'absolute'}}>\r\n        <TimerTags channel_id={channel_id}/>\r\n      </View>\r\n      <ThemedView style={{bottom:0, width:'100%', paddingTop:15, paddingBottom:10, paddingHorizontal:19}}>\r\n        <View style={{alignItems:'center', width:'100%',flexDirection:'row'}}>\r\n          <CommonButton title={''} style={{height:40, paddingTop:8, borderTopRightRadius:0, borderBottomRightRadius:0}} onPress={()=>setBottomTab(!bottomTab)}>\r\n            <View style={{top:-2}}>\r\n              <Entypo name={bottomTab?\"cross\":\"plus\"} size={24} color={Colors[theme].text}/>\r\n            </View>\r\n          </CommonButton>\r\n          {timer && <CommonButton style={{height:40, paddingTop:8, borderRadius:0}} title={`⌚${timerFormat(timer)}`} onPress={()=>{setModal(DateTimePickerModal, {datetime:timer, callback:(datetime:string)=>setTimer(datetime)});setBottomTab(false)}}/>}\r\n          <TextInput ref={inputRef} value={value} onChangeText={setValue} style={{\r\n            flex:1, borderWidth:1, height:40, borderColor:Colors.borderColor, backgroundColor:Colors[theme].background, color:Colors[theme].text\r\n          }} onSubmitEditing={postValue} blurOnSubmit={true} onFocus={()=>setBottomTab(false)}/>\r\n          <CommonButton style={{height:40, paddingTop:8, borderTopLeftRadius:0, borderBottomLeftRadius:0}} title={'💬'} onPress={postValue}/>\r\n        </View>\r\n\r\n        {bottomTab && <View style={{alignItems:'center', width:'100%', flexDirection:'row', paddingTop:15, paddingBottom:5}}>\r\n          <CommonButton style={{height:80, flex:1, justifyContent:'center', marginRight:15}} title={`📤\\n ${lang('File')}`} onPress={()=>uploadFile().then(f=>{contentMutation.create({channel:channel_id, user:auth.user?.id, content:'', file:f});setBottomTab(false)})}/>\r\n          <CommonButton style={{height:80, flex:1, justifyContent:'center', marginRight:15}} title={`⌚\\n ${lang('Timer')}`} onPress={()=>{setModal(DateTimePickerModal, {datetime:timer, callback:(datetime:string)=>setTimer(datetime)});setBottomTab(false)}}/>\r\n          <CommonButton style={{height:80, flex:1, justifyContent:'center'}} title={`📹\\n ${lang('Video Call')}`} onPress={()=>{setVideoMode(!videoMode);setBottomTab(false)}} disabled={videoMode}/>\r\n        </View>}\r\n      </ThemedView>\r\n    </View>\r\n  </View>\r\n}","import React from \"react\"\r\nimport CommonSection from \"../../../components/CommonSection\"\r\nimport Colors from \"../../../constants/Colors\"\r\nimport useColorScheme, { setColorScheme } from \"../../../hooks/useColorScheme\"\r\nimport { StyleSheet, Text, View} from 'react-native';\r\nimport useLangContext from \"../../../hooks/useLangContext\";\r\nimport { useColorScheme as useConfigColorScheme} from 'react-native-appearance';\r\nimport useAuthContext from \"../../../hooks/useAuthContext\";\r\nimport useFirebaseContext from \"../../../hooks/useFirebaseContext\";\r\nimport TextButton from \"../../../components/TextButton\";\r\n\r\n\r\nconst ConfigSection = ({title, children}:{title:string, children?: React.ReactNode})=>{\r\n  const theme = useColorScheme()\r\n  const color = Colors[theme].text\r\n  return <CommonSection bodyStyle={{alignItems:'flex-start', backgroundColor:theme=='light'?'transparent':\"black\"}}>\r\n    <Text style={{fontSize:20, color, fontWeight:'600'}}>{title}</Text>\r\n    {children}\r\n  </CommonSection>\r\n}\r\n\r\nexport default ()=>{\r\n  const { lang, locale, setLocale } = useLangContext()\r\n  const theme = useColorScheme()\r\n  const configTheme = useConfigColorScheme()\r\n  const { auth } = useAuthContext()\r\n  const {enable:noti, setEnable:setNoti} = useFirebaseContext(auth)\r\n  const color = Colors[theme].text\r\n  return <>\r\n    <ConfigSection title={lang('* Notification Settings')}>\r\n      <View style={{flexDirection:'row'}}>\r\n        {[[lang('On'), true], [lang('Off'), false]].map(([title, n])=><TextButton\r\n          key={title} title={title || ''} textStyle={{fontSize:16, color, textDecorationLine:noti==n?'underline':'none'}} style={{borderRadius:20}} onPress={()=>{setNoti(n)}}/>)}\r\n      </View>\r\n    </ConfigSection>\r\n    <ConfigSection title={lang('* Language Settings')}>\r\n    <View style={{flexDirection:'row'}}>\r\n        {[[lang('Auto'), 'auto'], ['한국어', 'ko'], ['English', 'en']].map(([title, l])=><TextButton \r\n          key={title} title={title || ''} textStyle={{fontSize:16, color, textDecorationLine:locale==l?'underline':'none'}} style={{borderRadius:20}} onPress={()=>setLocale(l)}/>)}\r\n      </View>\r\n    </ConfigSection>\r\n    <ConfigSection title={lang('* Skin Settings')}>\r\n      <View style={{flexDirection:'row'}}>\r\n        {[[lang('Auto'), 'no-preference'], [lang('Light'), 'light'], [lang('Dark'), 'dark']].map(([title, colorScheme])=><TextButton \r\n          key={title} title={title} textStyle={{fontSize:16, color, textDecorationLine:configTheme==colorScheme?'underline':'none'}} style={{borderRadius:20}} onPress={(\r\n            )=>setColorScheme(colorScheme)}/>)}\r\n      </View>\r\n    </ConfigSection>\r\n  </>\r\n}","import React, {useState, useEffect, useLayoutEffect, useMemo} from 'react';\r\nimport { StackScreenProps } from '@react-navigation/stack';\r\nimport { StyleSheet, View} from 'react-native';\r\nimport { Text as StyledText } from 'react-native-paper';\r\nimport { Text } from '../../../components/Themed'\r\nimport useResizeContext from '../../../hooks/useResizeContext';\r\nimport TabView from '../../../components/TabView';\r\nimport HeaderRight from '../../../components/HeaderRight';\r\nimport TextButton from '../../../components/TextButton';\r\nimport Colors from '../../../constants/Colors';\r\nimport useColorScheme  from '../../../hooks/useColorScheme';\r\nimport useModalsContext from '../../../hooks/useModalsContext';\r\nimport ChannelEditModal from '../../../modals/ChannelEditModal';\r\nimport useLangContext from '../../../hooks/useLangContext';\r\nimport ContractFooter from '../../../components/ContractFooter';\r\nimport { TabViewRecord } from '../../../types';\r\nimport useAuthContext from '../../../hooks/useAuthContext';\r\nimport useUserMembershipList from '../../../hooks/lists/useUserMembershipList';\r\nimport { FontAwesome, Ionicons, MaterialCommunityIcons, SimpleLineIcons } from '../../../lib/@expo/vector-icons';\r\nimport { useMessengerChannelSorted } from '../../../hooks/lists/useMessengerChannelList';\r\nimport { ScrollView } from 'react-native-gesture-handler';\r\nimport CommonItem from '../../../components/CommonItem';\r\nimport MemberItem from '../../../components/MemberItem';\r\nimport ProfileModal from '../../../modals/ProfileModal';\r\nimport { navigate } from '../../../navigation';\r\nimport CommonSection from '../../../components/CommonSection';\r\nimport ConfigSections from './ConfigSections';\r\nimport Avatar, { avatarFromChannel } from '../../../components/Avatar';\r\n\r\nconst MemberTabView = ()=>{\r\n  const {auth} = useAuthContext()\r\n  const theme = useColorScheme()\r\n  const { setModal } = useModalsContext()\r\n  const userList = useUserMembershipList(auth)\r\n  const memberItem = React.useMemo(\r\n      ()=>userList && userList.map((item, index)=><MemberItem key={index} member={item} onPress={()=>setModal(ProfileModal, {id:item.id})}/>), [userList])\r\n  return <ScrollView style={{flex:1, backgroundColor:Colors[theme].background}}>\r\n      {memberItem}\r\n  </ScrollView>\r\n}\r\n\r\nconst MessengerTabView = ()=>{\r\n  const {auth} = useAuthContext()\r\n  const channelList = useMessengerChannelSorted(auth)\r\n  const theme = useColorScheme()\r\n\r\n  const today = (new Date()).toISOString().slice(0, 10)\r\n  return <ScrollView style={{flex:1, backgroundColor:Colors[theme].background}}>\r\n      {channelList?.map((item, index)=>{\r\n          const {avatar, name} = avatarFromChannel(item, auth.user)\r\n          const date = item.last_message?.created.slice(0,10)\r\n          return <CommonItem key={index} bodyStyle={{flexDirection:'row', justifyContent:'space-between'}} onPress={()=>navigate(\"ChatScreen\", {id:item.id})}>\r\n              <View style={{flexDirection:'row', flexShrink:1}}>\r\n                  {avatar?\r\n                    <View style={{ marginRight:20}}>\r\n                      <Avatar name={avatar.name} size={44} userId={avatar.id}/>\r\n                    </View>:\r\n                    <FontAwesome size={40} color={Colors[theme].iconColor} style={{ marginBottom: -3, marginRight:20 }} name='users'/>}\r\n                  <View>\r\n                      <View style={{flexDirection:'row'}}>\r\n                          <Text style={{fontSize:18}}>{name}</Text>\r\n                          <Text style={{fontSize:18, opacity: 0.4, paddingLeft:5}}>{item.member_count}</Text>\r\n                      </View>\r\n                      <Text style={{fontSize:16, opacity: 0.4}}>{item.last_message?.content}</Text>\r\n                  </View>\r\n              </View>\r\n              <View>\r\n                  <Text style={{fontSize:14, opacity: 0.4, textAlign:'right'}}>{date==today?item.last_message?.created.slice(11,16):date}</Text>\r\n                  <Text style={{fontSize:14, textAlign:'right'}}>{item.unread_count?item.unread_count:' '}</Text>\r\n              </View>\r\n          </CommonItem>\r\n      })}\r\n  </ScrollView>\r\n}\r\n\r\n\r\nconst ConfigTabView = ()=>{\r\n  const theme = useColorScheme()\r\n  return <View style={{flex:1, backgroundColor:Colors[theme].background}}>\r\n    <ConfigSections/>\r\n  </View>\r\n}\r\n\r\nconst getBottomTabs = (theme:'light'|'dark')=>{\r\n  const color = Colors[theme].iconColor\r\n  return {\r\n    OneTab:{\r\n        title:'member',\r\n        component:MemberTabView,\r\n        icon:<MaterialCommunityIcons size={32} color={color} style={{ marginBottom: -3 }} name='account'/>,\r\n    },\r\n    TwoTab:{\r\n        title:'chat',\r\n        component:MessengerTabView,\r\n        icon:<Ionicons size={30} color={color} style={{ marginBottom: -3 }} name='chatbox'/>\r\n    },\r\n    // ThreeTab:{\r\n    //     title:'board',\r\n    //     component:()=><></>,\r\n    //     icon:<></>\r\n    // },\r\n    FourTab:{\r\n        title:'config',\r\n        component:ConfigTabView,\r\n        icon:<SimpleLineIcons size={30} color={color} style={{ marginBottom: -3 }} name='options'/>\r\n    }\r\n  } as TabViewRecord\r\n}\r\n\r\n\r\nexport default function HomeScreen({navigation, route}: StackScreenProps<any, 'Home'>) {\r\n  const { lang, locale } = useLangContext()\r\n  const windowType = useResizeContext();\r\n  const theme = useColorScheme()\r\n  const { setModal } = useModalsContext()\r\n  const [ home, setHome ] = useState(windowType == 'landscape')\r\n  const color = Colors[theme].text\r\n  const options = [\r\n    {title:lang('member'), headerRight:()=><HeaderRight/>},\r\n    {title:lang('chat'), headerRight:()=><HeaderRight extra={[{title:lang('create'), onPress:()=>setModal(ChannelEditModal, {type:'messenger'})}]}/>},\r\n    // {title:'board', headerRight:()=><HeaderRight extra={[{title:'create', onPress:()=>setModal(ChannelEditModal, props:{type:'board'}}) }]}/>},\r\n    {title:lang('config'), headerRight:()=><HeaderRight/>}\r\n  ]\r\n  \r\n  useLayoutEffect(() => {\r\n    const index = route?.params?.tab | 0\r\n    navigation.setOptions(windowType == 'portrait'?options[index]:{\r\n      title: lang('home'),\r\n      headerRight: ()=><HeaderRight/>\r\n    });\r\n  }, [navigation, route, windowType, locale]);\r\n  useEffect(()=>{\r\n    setHome(windowType == 'landscape')\r\n  }, [windowType])\r\n  return home?\r\n    <View style={{flex:1, justifyContent:'center', alignItems:'center'}}>\r\n      <View style={{width:'80%', flex:1, marginTop:72}}>\r\n        <StyledText style={{fontSize:32, color}}>Tokki Tok</StyledText>\r\n        <View style={{backgroundColor:Colors.borderColor, height:1, width:'100%'}}/>\r\n        {/* <Text style={{fontSize:20, color:'gray'}}>Welcome! This is a messenger for teams.</Text>*/}\r\n        <View style={{height:24}}/>\r\n        <CommonSection bodyStyle={{alignItems:'flex-start', backgroundColor:theme=='light'?'transparent':\"black\"}}>\r\n          <TextButton title={lang('+ New chat')} textStyle={{fontSize:20, color}} style={{paddingLeft:0, borderRadius:20}} onPress={()=>setModal(ChannelEditModal, {type:'messenger'})}/>\r\n        </CommonSection>\r\n        <ConfigSections/>\r\n      </View>\r\n      <ContractFooter theme={theme}/>\r\n    </View>:\r\n    <TabView tabs={getBottomTabs(theme)} tabBarPosition=\"bottom\" index={parseInt(route.params?.['tab'] || 0)} onTab={(index)=>{navigation.setParams({tab:index})}}/>\r\n}\r\n\r\n","import React, {useEffect, useLayoutEffect, useState} from 'react';\r\n\r\nimport { StackScreenProps } from '@react-navigation/stack';\r\nimport useAuthContext from '../../hooks/useAuthContext';\r\nimport useMessengerChannelList from '../../hooks/lists/useMessengerChannelList';\r\nimport { Text } from '../../components/Themed';\r\nimport { useMessengerMemberMutation } from '../../hooks/lists/useMessengerMemberList';\r\n\r\nexport default function InviteeScreen({navigation, route}: StackScreenProps<any, 'Invitee'>) {\r\n    const id = route?.params?.id\r\n    const {auth, dispatch} = useAuthContext()\r\n    const [enterGuest, setEnterGuest] = useState(false)\r\n    const channelList = useMessengerChannelList(auth)\r\n    const messengerMemberMutation = useMessengerMemberMutation()\r\n    useLayoutEffect(() => {\r\n        navigation.setOptions({headerRight: undefined});\r\n    }, []);\r\n    useEffect(()=>{\r\n        if(auth.user==null && enterGuest==false){\r\n            dispatch({type:\"LOGIN_GUEST\"})\r\n            setEnterGuest(true)\r\n        }\r\n        else if(auth.user && channelList!==undefined){\r\n            if(channelList.find(v=>v.id==id) === undefined){\r\n                console.log(`invite processing (channel:${id})`)\r\n                messengerMemberMutation.invite({\r\n                    channel_id:id,\r\n                    user_ids:[auth.user.id]\r\n                }).then(()=>navigation.replace(\"ChatScreen\", {id}))\r\n            }\r\n            else{\r\n                console.log('already invite')\r\n                navigation.replace(\"ChatScreen\", {id})\r\n            }\r\n        }\r\n    }, [auth, channelList, enterGuest])\r\n  return <Text>{'초대중'}</Text>\r\n};\r\n","import LoginScreen from \"./main/LoginScreen\";\r\nimport ChatScreen from \"./main/ChatScreen\";\r\nimport HomeScreen from \"./main/HomeScreen\";\r\nimport TabOneScreen from \"./main/TabOneScreen\";\r\nimport InviteeScreen from \"./main/InviteeScreen\";\r\n// import BoardScreen from \"../lib/blacktokki-board/BoardScreen\";\r\n// import BoardEditScreen from \"../lib/blacktokki-board/BoardEditScreen\";\r\nimport { Screens } from \"../types\";\r\n\r\nexport const main = {\r\n    HomeScreen:{\r\n        title:'home',\r\n        component:HomeScreen,\r\n        path:'home',\r\n    },\r\n    ChatScreen:{\r\n        title:'chat',\r\n        component:ChatScreen,\r\n        path:'chat'\r\n    },\r\n    // BoardScreen:{\r\n    //     title:'board',\r\n    //     component:BoardScreen,\r\n    //     path:'board'\r\n    // },\r\n    // TabOneScreen:{\r\n    //     title:'tab one',\r\n    //     component:TabOneScreen,\r\n    //     path:'one'\r\n    // },\r\n    InviteeScreen:{\r\n        title: '',        \r\n        component:InviteeScreen,\r\n        path:'invitee'\r\n    }\r\n} as Screens\r\n\r\nexport const login = {\r\n    LoginScreen:{\r\n        path: 'login',\r\n        title: 'Sign in',\r\n        component:LoginScreen\r\n    },\r\n    InviteeScreen:{\r\n        path:'invitee',\r\n        title: '',\r\n        component:InviteeScreen\r\n    }\r\n} as Screens\r\n\r\nexport const modal = {\r\n    // BoardEditScreen:{\r\n    //     title:'board',\r\n    //     component:BoardEditScreen,\r\n    //     path:'modal/board'\r\n    // },\r\n} as Screens","import { useMemo, useReducer } from \"react\"\r\n\r\ntype LocalSearchAction = {type:string, keyword?:string}\r\n\r\ntype LocalSearchState ={active:boolean, keyword:string}\r\n\r\n\r\n\r\nconst localSearchReducer =(initialState:LocalSearchState, action:LocalSearchAction)=>{\r\n    switch (action.type){\r\n        case 'SEARCH':\r\n          return {\r\n            ...initialState,\r\n            keyword: action.keyword\r\n          } as LocalSearchState\r\n        case 'ENABLE_SEARCH':\r\n          return {\r\n            ...initialState,\r\n            active:true,\r\n          }\r\n        case 'DISABLE_SEARCH':\r\n            return{\r\n                ...initialState,\r\n                active:false,\r\n                keyword: ''\r\n            }\r\n        default:\r\n            throw new Error( `Unhandled action type: ${action.type}`)\r\n    }\r\n  }\r\n\r\n\r\nexport default function useLocalSearch<T>(target:T[], compare:(value:T, keyword:string)=>boolean) {\r\n  const [searchState, dispatch] = useReducer(localSearchReducer, {active:false, keyword:''})\r\n  const data = useMemo(()=>searchState.active?target.filter(v=>compare(v, searchState.keyword)):target, [searchState, target])\r\n  return {searchState, dispatch, data}\r\n}","import React, {useRef,MutableRefObject, useMemo, useState, useEffect } from 'react';\r\nimport Clipboard from '@react-native-clipboard/clipboard/dist';\r\nimport { View, Text } from '../components/Themed';\r\nimport useAuthContext from '../hooks/useAuthContext';\r\nimport useUserMembershipList from '../hooks/lists/useUserMembershipList';\r\nimport { TabViewRecord, UserMembership } from '../types';\r\nimport CommonButton from '../components/CommonButton';\r\nimport useMessengerMemberList, { useMessengerMemberMutation } from '../hooks/lists/useMessengerMemberList';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport useExternalMembershipList from '../hooks/lists/useExternalMembershipList';\r\nimport TextField from '../components/TextField';\r\nimport useLocalSearch from '../hooks/useLocalSearch';\r\nimport TabView from '../components/TabView';\r\nimport { FlatList, TouchableOpacity } from 'react-native-gesture-handler';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport MemberItem from '../components/MemberItem';\r\nimport ModalSection from '../components/ModalSection';\r\n\r\nconst InviteItem = (props:{item:UserMembership, selectedRef:MutableRefObject<Set<number>>})=>{\r\n  const [selected, setSelected] = useState(props.selectedRef.current.has(props.item.id))\r\n  return <View style={selected?{borderWidth:1, borderColor:'blue'}:{}}>\r\n    <MemberItem member={props.item} onPress={()=>{\r\n      if (selected){\r\n        setSelected(false)\r\n        props.selectedRef.current.delete(props.item.id)\r\n      }\r\n      else{\r\n        setSelected(true)\r\n        props.selectedRef.current.add(props.item.id)\r\n      }\r\n    }}/>\r\n  </View>\r\n\r\n}\r\ntype InviteTabViewProps = {\r\n  id:number,\r\n  selectedRef:MutableRefObject<Set<number>>\r\n}\r\n\r\nconst GroupTabView = ({id, selectedRef}:InviteTabViewProps)=>{\r\n  const { lang } = useLangContext()\r\n  const {auth} = useAuthContext()\r\n  const { setModal } = useModalsContext()\r\n  const userList = useUserMembershipList(auth)\r\n  const memberList = useMessengerMemberList(id)\r\n  const messengerMemberMutation = useMessengerMemberMutation()\r\n  const rawData = useMemo(()=>{\r\n    const memberSet = new Set(memberList?.map(v=>v.user))\r\n    return userList?.filter(v=>!memberSet.has(v.id)) || []\r\n  }, [userList, memberList])\r\n  const {data, dispatch:dispatchKeyword, searchState} = useLocalSearch(rawData, (v, keyword)=>(v.username.includes(keyword) || v.name.includes(keyword)))\r\n  const search = (k:string)=>{\r\n    if (k?.length>0){\r\n      dispatchKeyword({type:'ENABLE_SEARCH'})\r\n      dispatchKeyword({type:'SEARCH', keyword:k})\r\n    }\r\n    else{\r\n      dispatchKeyword({type:'DISABLE_SEARCH'})\r\n    }\r\n  }\r\n  const back = ()=>{\r\n    setModal(InviteModal, null)\r\n  }\r\n  return <View style={{alignItems:'center', flex:1}}>\r\n    <View style={{'width': '100%', flex:1}}>\r\n      <TextField name={`${lang('Username')} & ${lang('Name')}`} value={searchState.keyword} setValue={search} width={'80%'}/>\r\n      {id && data && <FlatList contentContainerStyle={{flexGrow:1}} data={data} renderItem={({item})=><InviteItem item={item} selectedRef={selectedRef}/>}/>}\r\n    </View>\r\n    <View style={[{width:'100%', flexDirection:'row', padding:10,}, {justifyContent:'flex-end'}]}>\r\n      <CommonButton title={lang('invite')} onPress={()=>{\r\n        messengerMemberMutation.invite({\r\n          channel_id:id,\r\n          user_ids:[...selectedRef.current]\r\n        }).then(back)\r\n      }}/>\r\n      <CommonButton title={lang('cancel')} onPress={back}/>\r\n    </View>\r\n  </View>\r\n}\r\n\r\nconst DELAY = 500\r\n\r\nconst ExternalMembershipTabView = ({id, selectedRef}:InviteTabViewProps)=>{\r\n  const { lang } = useLangContext()\r\n  const [value, setValue] = useState('')\r\n  const [keyword, setKeyword] = useState('')\r\n  const [copied, setCopied] = useState(false)\r\n  const timeoutRef = useRef<NodeJS.Timeout>()\r\n  const { setModal } = useModalsContext()\r\n  const memberList = useMessengerMemberList(id)\r\n  const externalMemberList = useExternalMembershipList(keyword)\r\n  const data = useMemo(()=>{\r\n    const memberSet = new Set(memberList?.map(v=>v.user))\r\n    return externalMemberList?.filter(v=>!memberSet.has(v.id)) || []\r\n  }, [externalMemberList, memberList])\r\n  const messengerMemberMutation = useMessengerMemberMutation()\r\n  useEffect(()=>{\r\n    timeoutRef.current = setTimeout(()=>{\r\n      setKeyword(value)\r\n    }, DELAY)\r\n    return ()=>{timeoutRef.current && clearTimeout(timeoutRef.current)}\r\n  }, [value])\r\n  const back = ()=>{\r\n    setModal(InviteModal, null)\r\n  }\r\n  const inviteLink = location.href.replace('chat', 'invitee')\r\n  return <View style={{alignItems:'center', flex:1}}>\r\n  <TouchableOpacity style={{paddingVertical:10, flexDirection:\"row\"}} onPress={()=>{Clipboard.setString(inviteLink);setCopied(true)}}>\r\n    <Text style={{fontSize:14}}>{lang('invite link')}{\": \"}</Text>\r\n    <Text style={{fontSize:14, color:'#12b886'}}>{inviteLink}{\" \"}</Text>\r\n    {copied && <Text style={{fontSize:12, color:'red'}}>{lang(\"copied\")}</Text>}\r\n  </TouchableOpacity>\r\n  <View style={{'width': '100%', flex:1}}>\r\n    <TextField name={lang('Username')} value={value} setValue={setValue} width={'80%'}/>\r\n    {id && data && <FlatList contentContainerStyle={{flexGrow:1}} data={data} renderItem={({item})=><InviteItem item={item} selectedRef={selectedRef}/>}/>}\r\n  </View>\r\n  <View style={[{width:'100%', flexDirection:'row', padding:10,}, {justifyContent:'flex-end'}]}>\r\n    <CommonButton title={lang('invite')} onPress={()=>{\r\n      messengerMemberMutation.invite({\r\n        channel_id:id,\r\n        user_ids:[...selectedRef.current]\r\n      }).then(back)\r\n    }}/>\r\n    <CommonButton title={lang('cancel')} onPress={back}/>\r\n  </View>\r\n</View>\r\n}\r\n\r\nexport default function InviteModal({id}:{id:number}) {\r\n  const { lang } = useLangContext()\r\n  const selectedRef = useRef<Set<number>>(new Set())\r\n  const drawerTabs:TabViewRecord = {\r\n    group:{\r\n      title: 'Group',\r\n      component: ()=><GroupTabView id={id} selectedRef={selectedRef}/>,\r\n      icon: <></>\r\n    },\r\n    external:{\r\n      title: 'External members',\r\n      component: ()=><ExternalMembershipTabView id={id} selectedRef={selectedRef}/>,\r\n      icon: <></>\r\n    }\r\n  }\r\n  return <ModalSection>\r\n    <View style={{flex:1, width:'100%'}}>\r\n      <View style={{width:'100%'}}>\r\n        <Text style={{fontSize:20}}>{lang('invite')}</Text>\r\n        <View style={{marginBottom: 20, height: 1, width: '100%'}} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\r\n      </View>\r\n      <TabView tabs={drawerTabs} tabBarPosition={\"top\"}/>\r\n    </View>\r\n  </ModalSection>\r\n}\r\n\r\n","import { useQuery } from \"react-query\";\r\nimport { getExternalMembershipList } from \"../../apis\";\r\n\r\nexport default function useExternalMembershipList(keyword?:string){\r\n  const { data } = useQuery([\"UserMembershipList\", keyword] , async()=>keyword?(await getExternalMembershipList(keyword)):[])\r\n  return data\r\n}","import React, { useMemo } from 'react';\r\n\r\nimport { TextProps, StyleProp } from 'react-native';\r\nimport {View, Text } from './Themed'\r\nimport useResizeContext from '../hooks/useResizeContext';\r\n\r\ntype Props = {\r\n  name: string,\r\n  width?:number,\r\n  children: React.ReactNode\r\n  textStyle?: StyleProp<TextProps>\r\n}\r\n\r\nexport default function RowField(props:Props) {\r\n  const windowType = useResizeContext()\r\n  const rowStyle = useMemo(()=>windowType=='landscape'?\r\n    {flexDirection:'row', alignItems: 'center', justifyContent:'space-between'}:\r\n    {flexDirection:'column', alignItems:'flex-start'} as any\r\n  , [windowType])\r\n  return (\r\n    <View style={[{paddingVertical:5, width:'100%'}, rowStyle]}>\r\n        <Text style={[windowType=='landscape'?{flex:1}:{width:'100%'},{paddingHorizontal: 15, fontSize:16}, props.textStyle]}>{props.name}</Text>\r\n        <View style={[windowType=='landscape'?{flex:6}:{width:'100%'},{paddingHorizontal: 15}]}>\r\n          <View style={{width:props.width}}>\r\n            {props.children}\r\n          </View>\r\n        </View>\r\n    </View>\r\n  )\r\n}","import React from 'react';\r\nimport { StyleProp, TextStyle } from 'react-native';\r\nimport { CustomTextInputProps } from '../types';\r\nimport CommonTextInput from './CommonTextInput';\r\nimport RowField from './RowField';\r\n\r\nexport default function TextField(props:CustomTextInputProps & {name: string, width?:any, textStyle?:StyleProp<TextStyle>}) {\r\n  return (\r\n    <RowField name={props.name} width={props.width} textStyle={props.textStyle}>\r\n      <CommonTextInput {...props} />\r\n   </RowField>\r\n  )\r\n}","/**\r\n * Learn more about deep linking with React Navigation\r\n * https://reactnavigation.org/docs/deep-linking\r\n * https://reactnavigation.org/docs/configuring-links\r\n */\r\n\r\nimport { LinkingOptions } from '@react-navigation/native';\r\nimport * as Linking from 'expo-linking';\r\nimport {main, login, modal} from '../screens';\r\n\r\nconst ROOTPATH = 'tokki-tok'  // github repository name\r\n\r\nObject.values(modal).forEach(v=>v.path = ROOTPATH + '/' + v.path)\r\n\r\nexport default  {\r\n  prefixes: [Linking.makeUrl('/')],\r\n  config: {\r\n    screens: {\r\n      Main: {\r\n        screens:{\r\n          ...main,\r\n          ...login,\r\n          NotFound: '*',\r\n        },\r\n        path: ROOTPATH\r\n      },\r\n      ...modal\r\n    },\r\n  },\r\n} as LinkingOptions;\r\n","firebaseConfig = {\n    \"authDomain\": \"virtual-metrics-355712.firebaseapp.com\",\n    \"projectId\": \"virtual-metrics-355712\",\n    \"storageBucket\": \"virtual-metrics-355712.appspot.com\",\n    \"messagingSenderId\": \"76003576924\",\n    \"appId\": \"1:76003576924:web:c8c8a006d07918bbc02a99\",\n    \"measurementId\": \"G-SEL35L4N5R\"\n}\nif (typeof module !== 'undefined') {\n    module.exports = firebaseConfig\n}\n","import { StackScreenProps } from '@react-navigation/stack';\r\nimport * as React from 'react';\r\nimport { StyleSheet, Text, TouchableOpacity, View } from 'react-native';\r\nimport useLangContext from '../hooks/useLangContext';\r\n\r\nexport default function NotFoundScreen({\r\n  navigation,\r\n}: StackScreenProps<any, 'NotFound'>) {\r\n  const { lang } = useLangContext()\r\n  return (\r\n    <View style={styles.container}>\r\n      <Text style={styles.title}>{lang(\"This screen doesn't exist.\")}</Text>\r\n      <TouchableOpacity onPress={() => navigation.replace('HomeScreen')} style={styles.link}>\r\n        <Text style={styles.linkText}>{lang(\"Go to home screen!\")}</Text>\r\n      </TouchableOpacity>\r\n    </View>\r\n  );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    backgroundColor: '#fff',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    padding: 20,\r\n  },\r\n  title: {\r\n    fontSize: 20,\r\n    fontWeight: 'bold',\r\n  },\r\n  link: {\r\n    marginTop: 15,\r\n    paddingVertical: 15,\r\n  },\r\n  linkText: {\r\n    fontSize: 14,\r\n    color: '#2e78b7',\r\n  },\r\n});\r\n","import { useTheme } from '@react-navigation/native';\r\nimport React, { useState } from 'react';\r\nimport { View, StyleSheet } from 'react-native';\r\nimport Profile from '../components/Profile';\r\nimport TextButton from '../components/TextButton';\r\nimport Colors from '../constants/Colors';\r\nimport useResizeContext from '../hooks/useResizeContext';\r\nimport TabView from '../components/TabView';\r\nimport { MessengerChannel, TabViewRecord, User, UserMembership } from '../types';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport ChannelEditModal from '../modals/ChannelEditModal';\r\nimport CommonItem from '../components/CommonItem';\r\nimport { Text } from '../components/Themed';\r\nimport useAuthContext, { Auth } from '../hooks/useAuthContext';\r\nimport { useMessengerChannelSorted } from '../hooks/lists/useMessengerChannelList';\r\nimport { navigate } from '.'\r\nimport { avatarFromChannel } from '../components/Avatar';\r\n\r\nconst DrawerTabView = (props:{auth:Auth, data:(MessengerChannel & {onPress?:()=>void})[]})=><View style={{flex:1}}>\r\n    {props.data.map((item, index)=>{\r\n      const {name} = avatarFromChannel(item, props.auth.user)\r\n      return <CommonItem key={index} containerStyle={{marginHorizontal:0}} bodyStyle={{alignItems:'flex-start'}} onPress={item.onPress}>\r\n        <Text style={{marginLeft:20}}>{name}</Text>\r\n      </CommonItem>\r\n    })}\r\n</View>\r\n\r\nconst MessengerTabView = ()=>{\r\n  const {auth} = useAuthContext()\r\n  const channelList = useMessengerChannelSorted(auth);\r\n  return <DrawerTabView auth={auth} data={(channelList || []).map(item=>({...item, onPress:()=>navigate(\"ChatScreen\", {id:item.id})}))}/>\r\n}\r\n\r\nconst drawerTabs:TabViewRecord = {\r\n  MessengerTab:{\r\n      title:'messenger',\r\n      component:MessengerTabView,\r\n      icon:<></>\r\n  },\r\n}\r\n\r\nexport default ({user}:{user:UserMembership})=> {\r\n  const { colors } = useTheme();\r\n  const windowType = useResizeContext();\r\n  const [index, setIndex] = useState(0);\r\n  const { setModal } = useModalsContext()\r\n  const onAddList = [\r\n    ()=>setModal(ChannelEditModal, {type:'messenger'}),\r\n    ()=>setModal(ChannelEditModal, {type:'board'})\r\n  ]\r\n  return <View style={windowType=='landscape'?[\r\n      styles.tabBar,\r\n      {\r\n        backgroundColor: colors.card,\r\n        borderTopColor: colors.border,\r\n      },\r\n      // tabBarStyle,\r\n    ]:{width:0}}\r\n    pointerEvents={false ? 'none' : 'auto'}\r\n  >\r\n    <Profile userId={user.id} username={user.username} name={user.name}/>\r\n    {windowType=='landscape' && <>\r\n      <View style={{flexDirection:'row-reverse'}}>\r\n          <TextButton title='+' textStyle={{fontSize:20}} style={{borderRadius:20}} onPress={onAddList[index]}/>\r\n      </View>\r\n      <View accessibilityRole=\"tablist\" style={styles.content}>\r\n        {Object.keys(drawerTabs).length>1 ? \r\n          <TabView tabs={drawerTabs} tabBarPosition={\"top\"} onTab={setIndex}/>: \r\n          <View style={{borderTopWidth:1, flex:1, borderColor:colors.border}}>            \r\n            {Object.values(drawerTabs).map(drawerTab=>{const Tab = drawerTab.component; return <Tab key={drawerTab.title}/>})}\r\n          </View>\r\n        }\r\n      </View>\r\n    </>}\r\n  </View>\r\n}\r\n\r\n{/*<Text style={[styles.label, { color: d.isFocused ? colors.primary : '#222' }]}></Text> */}\r\n\r\nconst styles = StyleSheet.create({\r\n    tabBar: {\r\n      width:240,\r\n      elevation: 8,\r\n      borderRightWidth:1,\r\n      borderColor:Colors.borderColor\r\n    },\r\n    content: {\r\n      flex: 1,\r\n      flexDirection: 'row',\r\n    },\r\n    tab: {\r\n        flex: 1,\r\n        alignItems: 'center',\r\n    },\r\n    label: {\r\n        textAlign: 'center',\r\n        backgroundColor: 'transparent',\r\n      },\r\n  });","import InviteModal from \"./InviteModal\";\r\nimport ProfileModal from \"./ProfileModal\";\r\nimport ChannelEditModal from \"./ChannelEditModal\"\r\nimport GuestLogoutModal from \"./GuestLogoutModal\";\r\nimport DateTimePickerModal from \"./DateTimePickerModal\"\r\nimport MessageModal from \"./MessageModal\";\r\n\r\nexport default [\r\n    InviteModal,\r\n    ProfileModal,\r\n    ChannelEditModal,\r\n    GuestLogoutModal,\r\n    DateTimePickerModal,\r\n    MessageModal\r\n]","import { CardStyleInterpolators, createStackNavigator } from '@react-navigation/stack';\r\nimport React, {useMemo} from 'react';\r\nimport { View } from 'react-native';\r\nimport { Ionicons } from '../lib/@expo/vector-icons';\r\nimport useResizeContext from '../hooks/useResizeContext';\r\nimport NotFoundScreen from '../screens/NotFoundScreen';\r\nimport {main, login, modal} from '../screens';\r\nimport DrawerNavigator from './DrawerNavigator';\r\nimport useAuthContext from '../hooks/useAuthContext';\r\nimport { WebSocketProvider } from '../hooks/useWebsocketContext';\r\nimport HeaderRight from '../components/HeaderRight'\r\nimport Colors from '../constants/Colors';\r\nimport { TouchableOpacity } from 'react-native-gesture-handler';\r\nimport useFirebaseContext from '../hooks/useFirebaseContext';\r\nimport useIsMobile from '../hooks/useIsMobile';\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport { ModalsProvider } from '../hooks/useModalsContext';\r\nimport modals from '../modals';\r\nimport useLangContext from '../hooks/useLangContext';\r\n\r\nconst Root = createStackNavigator();\r\n\r\nexport default function RootNavigator() {\r\n    const windowType = useResizeContext();\r\n    return <Root.Navigator\r\n        mode= 'modal'\r\n        headerMode= 'screen'\r\n        screenOptions={{\r\n            cardStyle:{backgroundColor:\"white\"},\r\n            animationEnabled: true,\r\n            cardStyleInterpolator: CardStyleInterpolators.forVerticalIOS,\r\n        }}\r\n    >\r\n        <Root.Screen name=\"Main\" component={MainNavigator} options={{headerShown:false}}/>\r\n        {Object.entries(modal).map(([key, screen])=><Root.Screen key={key} name={key} component={screen.component} options={{\r\n            title: screen.title,\r\n            gestureDirection: windowType == 'landscape'?'vertical-inverted':'vertical'\r\n        }} />)}\r\n    </Root.Navigator>\r\n}\r\n\r\nconst Main = createStackNavigator();\r\n\r\nfunction headerLeft(navigation:any, route:any, windowType:string, isMobile:boolean){\r\n    const canGOBackScreen = ['HomeScreen', 'LoginScreen'].findIndex(v=>v == route.name) == -1\r\n    const goBack = ()=>{\r\n        if (navigation.canGoBack())\r\n            navigation.goBack()\r\n        else if (canGOBackScreen)\r\n            navigation.replace('HomeScreen')\r\n    }\r\n    if (windowType=='portrait' && canGOBackScreen)\r\n        return <TouchableOpacity onPress={goBack}><Ionicons size={isMobile?20:24} style={{marginHorizontal:isMobile?16:20 }} name=\"arrow-back\"/></TouchableOpacity>\r\n    return null\r\n}\r\n\r\nconst MainNavigator = ()=>{\r\n    const windowType = useResizeContext();\r\n    const isMobile = useIsMobile()\r\n    const {auth} = useAuthContext()\r\n    const theme = useColorScheme()\r\n    const {lang, locale} = useLangContext()\r\n    const entries = useMemo(()=>{\r\n        if (auth.user === undefined)\r\n            return []\r\n        console.log('current user: ', auth.user)\r\n        return Object.entries(auth.user === null?login:main)\r\n    }, [auth, locale])\r\n    const modalValues = useMemo(()=>{\r\n        if (auth.user === undefined)\r\n            return []\r\n        return auth.user === null?[]:modals\r\n    }, [auth])\r\n\r\n    const {enable:noti} = useFirebaseContext(auth)\r\n    const headerLeftColor = 'white'\r\n    return (auth.user!==undefined && noti!=null?<View style={{flexDirection:'row', flex:1}}>\r\n        <ModalsProvider modals={modalValues}>\r\n            {auth.user?<DrawerNavigator user={auth.user}/>:undefined}\r\n            <View style={{flex:1}}>\r\n                <WebSocketProvider disable={auth.user === null || auth.user === undefined}>\r\n                        <Main.Navigator\r\n                            screenOptions={({navigation, route})=>({\r\n                                headerStyle:{backgroundColor:Colors[theme].header, height:isMobile?50:undefined},\r\n                                headerTitleStyle:{color:'white'},\r\n                                headerLeft:()=>headerLeft(navigation, route, windowType, isMobile),\r\n                                headerRight:()=><HeaderRight/>,\r\n                                headerLeftContainerStyle:{backgroundColor:headerLeftColor, borderBottomWidth:1, borderColor:headerLeftColor},\r\n                                cardStyle:[{flexShrink:1}, theme=='light'?{}:{backgroundColor:'#212121'}],\r\n                                animationEnabled:windowType=='portrait',\r\n                                cardStyleInterpolator: CardStyleInterpolators.forHorizontalIOS\r\n                            })}\r\n                        >\r\n                            {entries.map(([key, screen])=><Main.Screen key={key} name={key} component={screen.component} options={{ title: lang(screen.title) }} />)}\r\n                            <Main.Screen name=\"NotFound\" component={NotFoundScreen} options={{ title: 'Oops!' }} />\r\n                        </Main.Navigator>\r\n                </WebSocketProvider>\r\n            </View>\r\n        </ModalsProvider>\r\n    </View>:<></>);\r\n}"],"sourceRoot":""}